(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(t,e,a){t.exports=a(55)},33:function(t,e,a){},53:function(t,e){},54:function(t,e,a){},55:function(t,e,a){"use strict";a.r(e);var i=a(0),r=a.n(i),s=a(18),n=a.n(s),o=(a(33),a(19)),l=a(27),h=a(6),c=a.n(h),u=a(12),d=a(2),p=a(4),v=a(9),m=a(10),b=a(17),y=a(15),f=a(16),g=a(3),w=a(21),x=a.n(w),k=a(13),S=a.n(k),E=a(5),O=a.n(E),C=a(1),M=a.n(C),j=a(8),P=a.n(j);a(54);x.a.setAppElement("#root");var A=37,D=39,B=38,F=40,I=65,z=68,L=87,T=83,X=32;function q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},a=new P.a(t.x,t.y),i=new P.a(e.x,e.y);return a.distance(i)}function R(t,e){if(t&&e)return{x:(t.x-e.x)/q(t,e),y:(t.y-e.y)/q(t,e)}}function G(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=parseInt(t.substring(1,3),16),s=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16);return r=parseInt(r*(100+e)/100),s=(s=parseInt(s*(100+a)/100))<255?s:255,n=(n=parseInt(n*(100+i)/100))<255?n:255,"#"+(1===(r=r<255?r:255).toString(16).length?"0"+r.toString(16):r.toString(16))+(1===s.toString(16).length?"0"+s.toString(16):s.toString(16))+(1===n.toString(16).length?"0"+n.toString(16):n.toString(16))}var W=function(t){function e(t){var a;return Object(v.a)(this,e),(a=Object(b.a)(this,Object(y.a)(e).call(this,t))).state={screen:{width:a.props.width,height:a.props.height,ratio:window.devicePixelRatio||1},starList:[{name:"Lalande",num:5},{name:"Tau Ceti",num:4},{name:"Groombridge",num:2},{name:"Alpha Centauri",num:4},{name:"Epsilon Eriadni",num:7},{name:"Procyon A",num:0},{name:"Procyon B",num:1},{name:"Ross 154",num:3},{name:"Barnard's Star",num:8}],world:{stage:"Sol",bodies:[],pendingBodies:[],bDatabase:{Sol:[{data:at,parent:0,index:0,active:!0,status:{}},{data:Q,parent:0,index:1,active:!0,status:{shield:Math.floor(70*O()("m1".toString()).quick()+30),uplink:Math.floor(70*O()("m2".toString()).quick()+30)}},{data:tt,parent:0,index:2,active:!0,status:{shield:Math.floor(70*O()("v1".toString()).quick()+30),uplink:Math.floor(70*O()("v2".toString()).quick()+30)}},{data:_,parent:1,index:3,active:!0,status:{}},{data:et,parent:0,index:4,active:!0,status:{shield:Math.floor(70*O()("e1".toString()).quick()+30),uplink:Math.floor(70*O()("e2".toString()).quick()+30)}},{data:it,parent:0,index:5,active:!1,status:{shield:Math.floor(70*O()("s1".toString()).quick()+30),uplink:Math.floor(70*O()("s2".toString()).quick()+30)}}]},structures:[],pendingStructures:[],sDatabase:{Sol:[{data:nt,openings:1,index:0,active:!0,status:{}},{data:ot,openings:4,index:1,active:!0,status:{}},{data:lt,openings:0,index:2,active:!0,status:{}},{data:ht,openings:8,index:3,active:!1,status:{}}]}},params:{gravFalloff:.9,bounceDampening:.9},ball:{x:190,y:210,vx:.5,vy:.5,size:6,mass:3,speed:0,thrustAcc:.1,thrustLevel:0,heading:0,power:0,coll:!1,ct:0,color:"#E0EDFF",glow:1},resources:{matter:0,energy:1500,psi:0,hm:0},keys:{left:0,right:0,up:0,down:0,space:0},proton:{},mousedown:!1,mouseTick:0,mouseReleased:!1,mouseObj:{x:350,y:350,init:!1},selectedObj:null,tick:0,ts:0,randomHash:0,currentScore:0,inGame:!0,showModal:!1},a.sharedEB=[],a.animationID=null,a.timerID=null,a.handlePowerChange=a.handlePowerChange.bind(Object(g.a)(Object(g.a)(a))),a.handleChargePsi=a.handleChargePsi.bind(Object(g.a)(Object(g.a)(a))),a.handleChargeShield=a.handleChargeShield.bind(Object(g.a)(Object(g.a)(a))),a.handleSystemChange=a.handleSystemChange.bind(Object(g.a)(Object(g.a)(a))),a.handlePlanetToggle=a.handlePlanetToggle.bind(Object(g.a)(Object(g.a)(a))),a.handleStructureToggle=a.handleStructureToggle.bind(Object(g.a)(Object(g.a)(a))),a.handlePauseStart=a.handlePauseStart.bind(Object(g.a)(Object(g.a)(a))),a.handleKeys=a.handleKeys.bind(Object(g.a)(Object(g.a)(a))),a.mouseupHandler=a.mouseupHandler.bind(Object(g.a)(Object(g.a)(a))),a.mousedownHandler=a.mousedownHandler.bind(Object(g.a)(Object(g.a)(a))),a.mousemoveHandler=a.mousemoveHandler.bind(Object(g.a)(Object(g.a)(a))),a.handleOpenModal=a.handleOpenModal.bind(Object(g.a)(Object(g.a)(a))),a.handleCloseModal=a.handleCloseModal.bind(Object(g.a)(Object(g.a)(a))),a}return Object(f.a)(e,t),Object(m.a)(e,[{key:"makeMapInterface",value:function(t){var e=this,a=Object(p.a)(this.state.starList);return a.push({name:"Sol",num:6}),a.map(function(a){return r.a.createElement(K,{onClick:e.handleSystemChange,star:a.name,ui:t,key:a.name})})}},{key:"makeControlButtons",value:function(){return[this.state.inGame?r.a.createElement(Z,{onClick:this.handlePauseStart,style:{backgroundColor:"red"},text:"Pause",key:"Pause"}):r.a.createElement(Z,{onClick:this.handlePauseStart,text:"Continue",key:"Pause"}),r.a.createElement(Z,{onClick:this.handleChargePsi,style:{backgroundColor:"#4666FF"},text:"Psi blasts: ".concat(this.state.resources.psi),key:"Psi"}),r.a.createElement(Z,{onClick:this.handlePowerChange,style:{backgroundColor:"#E0115F"},text:"Energy: ".concat(this.state.resources.energy," (click to charge)"),key:"Energy"})]}},{key:"selectOnCanvas",value:function(t){var e=this,a=Object(p.a)(this.state.world.bodies),i=!0,r=!1,s=void 0;try{for(var n,o=function(){var a=n.value;if(q(t,a)<1.25*a.size)return{v:e.setState(function(t){return{selectedObj:a}})}},l=a[Symbol.iterator]();!(i=(n=l.next()).done);i=!0){var h=o();if("object"===typeof h)return h.v}}catch(c){r=!0,s=c}finally{try{i||null==l.return||l.return()}finally{if(r)throw s}}}},{key:"handlePowerChange",value:function(){this.setState(function(t){return{currentScore:0,resources:Object(d.a)({},t.resources,{energy:t.resources.energy+10*t.currentScore})}})}},{key:"handleChargePsi",value:function(){this.setState(function(t){return{resources:Object(d.a)({},t.resources,{psi:t.resources.psi+1})}})}},{key:"handleChargeShield",value:function(t){var e=t.target.id;this.state.world.bodies.find(function(t){return t.name===e}).status.shield++}},{key:"handleKeys",value:function(t,e){var a=Object(d.a)({},this.state.keys);e.keyCode!==A&&e.keyCode!==I||(a.left=t?a.left+1:0),e.keyCode!==F&&e.keyCode!==T||(a.down=t?a.down+1:0),e.keyCode!==D&&e.keyCode!==z||(a.right=t?a.right+1:0),e.keyCode!==B&&e.keyCode!==L||(a.up=t?a.up+1:0),e.keyCode===X&&(a.space=t?a.space+1:0),this.setState(function(t){return{keys:a}})}},{key:"mousedownHandler",value:function(t){var e=t.nativeEvent.layerX,a=t.nativeEvent.layerY;this.setState(function(t){return{mousedown:!0,mouseObj:{x:e,y:a}}}),this.selectOnCanvas({x:e,y:a})}},{key:"mouseupHandler",value:function(t){this.setState(function(t){return{mousedown:!1}})}},{key:"mousemoveHandler",value:function(t){if(this.state.mousedown){var e=t.nativeEvent.layerX,a=t.nativeEvent.layerY;return this.setState(function(t){return{mouseObj:{x:e,y:a}}})}}},{key:"handleOpenModal",value:function(){this.setState({showModal:!0})}},{key:"handleCloseModal",value:function(){this.setState({showModal:!1})}},{key:"handleSystemChange",value:function(t){var e=t.target.id;return this.systemChange(e)}},{key:"handlePlanetToggle",value:function(t){var e=t.target.id;this.planetToggle(e)}},{key:"handleStructureToggle",value:function(t){var e=t.target.id;this.structureToggle(e)}},{key:"genSysPlanets",value:function(){var t=Object(u.a)(c.a.mark(function t(){var e,a,i,r,s,n,o,l,h,u=arguments;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=u.length>0&&void 0!==u[0]?u[0]:"Alpha Centauri",a=u.length>1&&void 0!==u[1]?u[1]:3,Object(d.a)({},this.state.world.bDatabase)[e]){t.next=12;break}for(i=[],r=rt(e,"star"),s={data:Object(d.a)({},r),index:0,parent:0,active:!1,status:{}},i.push(s),n=1;n<a+1;n++)o=Math.floor(O()(n.toString()).quick()*(n/a)*4),l=rt(e+" "+n.toString(),"planet",1/(o/2+1)),h={data:Object(d.a)({},l),index:n,parent:o,active:!1,status:{shield:Math.floor(70*O()("s"+n.toString()).quick()+30),uplink:Math.floor(70*O()("u"+n.toString()).quick()+30)}},i.push(h);return t.abrupt("return",i);case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"genSysStructures",value:function(){var t=Object(u.a)(c.a.mark(function t(){var e,a,i,r,s,n,o=arguments;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:"Alpha Centauri",a=o.length>1&&void 0!==o[1]?o[1]:4,Object(d.a)({},this.state.world.sDatabase)[e]){t.next=9;break}for(i=[],r=0;r<a;r++)s=ct(e+" "+r.toString()),n={data:Object(d.a)({},s),index:r,openings:1,active:!1},i.push(n);return t.abrupt("return",i);case 9:return t.abrupt("return",null);case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"createGalaxy",value:function(){var t=Object(u.a)(c.a.mark(function t(){var e,a,i,r,s,n,o,l,h,u,p,v=arguments;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=v.length>0&&void 0!==v[0]?v[0]:[{name:"Wolf 359",num:6},{name:"Tau Ceti",num:4},{name:"Groombridge",num:1}],a=Object(d.a)({},this.state.world.bDatabase),i=Object(d.a)({},this.state.world.sDatabase),r=!0,s=!1,n=void 0,t.prev=6,o=e[Symbol.iterator]();case 8:if(r=(l=o.next()).done){t.next=21;break}return h=l.value,t.next=12,this.genSysPlanets(h.name,h.num);case 12:return u=t.sent,t.next=15,this.genSysStructures(h.name,3);case 15:p=t.sent,a[h.name]=u,i[h.name]=p;case 18:r=!0,t.next=8;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(6),s=!0,n=t.t0;case 27:t.prev=27,t.prev=28,r||null==o.return||o.return();case 30:if(t.prev=30,!s){t.next=33;break}throw n;case 33:return t.finish(30);case 34:return t.finish(27);case 35:return t.abrupt("return",this.setState(function(t){return{world:Object(d.a)({},t.world,{bDatabase:a,sDatabase:i})}}));case 36:case"end":return t.stop()}},t,this,[[6,23,27,35],[28,,30,34]])}));return function(){return t.apply(this,arguments)}}()},{key:"loadStagePlanets",value:function(t){var e=[],a=Object(d.a)({},this.state.world.bDatabase)[t],i=a.slice(1);if(i){var r=!0,s=!1,n=void 0;try{for(var o,l=i[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=o.value;h.active&&a[h.parent].active&&e.push(h)}}catch(c){s=!0,n=c}finally{try{r||null==l.return||l.return()}finally{if(s)throw n}}}this.setState(function(a){return{world:Object(d.a)({},a.world,{pendingBodies:e,stage:t})}})}},{key:"loadStageStructures",value:function(t){var e=[],a=Object(d.a)({},this.state.world.sDatabase)[t];if(a){var i=!0,r=!1,s=void 0;try{for(var n,o=a[Symbol.iterator]();!(i=(n=o.next()).done);i=!0){var l=n.value;l.active&&e.push(l)}}catch(h){r=!0,s=h}finally{try{i||null==o.return||o.return()}finally{if(r)throw s}}}this.setState(function(t){return{world:Object(d.a)({},t.world,{structures:[],pendingStructures:e})}})}},{key:"loadStage",value:function(){var t=Object(u.a)(c.a.mark(function t(){var e,a=arguments;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:"Sol",t.next=3,this.createPrimary(this.state.world.bDatabase[e][0].data);case 3:return this.loadStagePlanets(e),this.loadStageStructures(e),this.addCoreEmitter(),t.abrupt("return",this.continueGame());case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"systemChange",value:function(t){var e=this.state.world.stage,a=Object(d.a)({},this.state.world.bDatabase),i=Object(d.a)({},this.state.world.sDatabase),r=a[e],s=i[e],n=a[t],o=i[t],l=!0,h=!1,c=void 0;try{for(var u,p=r[Symbol.iterator]();!(l=(u=p.next()).done);l=!0){u.value.active=!1}}catch(P){h=!0,c=P}finally{try{l||null==p.return||p.return()}finally{if(h)throw c}}if(s){var v=!0,m=!1,b=void 0;try{for(var y,f=s[Symbol.iterator]();!(v=(y=f.next()).done);v=!0){y.value.active=!1}}catch(P){m=!0,b=P}finally{try{v||null==f.return||f.return()}finally{if(m)throw b}}}var g=!0,w=!1,x=void 0;try{for(var k,S=n[Symbol.iterator]();!(g=(k=S.next()).done);g=!0){k.value.active=!0}}catch(P){w=!0,x=P}finally{try{g||null==S.return||S.return()}finally{if(w)throw x}}if(o){var E=!0,O=!1,C=void 0;try{for(var M,j=o[Symbol.iterator]();!(E=(M=j.next()).done);E=!0){M.value.active=!0}}catch(P){O=!0,C=P}finally{try{E||null==j.return||j.return()}finally{if(O)throw C}}}this.setState(function(t){return{world:Object(d.a)({},t.world,{bDatabase:a,sDatabase:i}),ball:Object(d.a)({},t.ball,{x:t.screen.width/4,y:t.screen.height/3})}}),this.loadStage(t)}},{key:"createPrimary",value:function(){var t=Object(u.a)(c.a.mark(function t(e){var a,i;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new st(e)).index=0,(i=[]).push(a),t.abrupt("return",this.setState(function(t){return{world:Object(d.a)({},t.world,{bodies:i,stage:e.name})}}));case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createPlanet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.world.bodies.length,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=Object(p.a)(this.state.world.bodies);s[a]=new st(t,s[e]),s[a].index=a,s[a].emitter=this.createNewEmitter(i),s[a].status=r||{shield:5,uplink:100},this.setState(function(t){return{world:Object(d.a)({},t.world,{bodies:s})}})}},{key:"updatePlanets",value:function(){for(var t=Object(p.a)(this.state.world.pendingBodies),e=0;e<t.length;e++){var a=t.splice(0,1)[0];a.em||(a.em={target:a.index,e:600,color1:G(a.data.hue,80),rate1:6,rate2:1.5,velocity:1.5,damp:.007,life:7,mass:5}),this.createPlanet(a.data,a.parent,a.index,a.em||null,a.status||null)}this.setState(function(e){return{world:Object(d.a)({},e.world,{pendingBodies:t})}})}},{key:"planetToggle",value:function(t){var e=Object(p.a)(this.state.world.bodies),a=e.slice(1),i=this.state.world.stage,r=Object(d.a)({},this.state.world.bDatabase),s=r[i],n=s.find(function(e){return e.data.name===t});if(!n.active&&e[n.parent]){s[n.index].active=!0;var o=Object(p.a)(this.state.world.pendingBodies);o.push(n),this.setState(function(t){return{world:Object(d.a)({},t.world,{pendingBodies:o,bDatabase:r})}})}else if(n.active){var l=!0,h=!1,c=void 0;try{for(var u,v=a[Symbol.iterator]();!(l=(u=v.next()).done);l=!0){var m=u.value;if(m&&m.parent===e[n.index]){var b=m.index;s[b].active=!1,e[b]=null}}}catch(y){h=!0,c=y}finally{try{l||null==v.return||v.return()}finally{if(h)throw c}}s[n.index].active=!1,e[n.index]=null,this.setState(function(t){return{world:Object(d.a)({},t.world,{bodies:e,bDatabase:r})}})}}},{key:"createStructure",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.world.structures.length,i=Object(p.a)(this.state.world.structures);i[a]=new ut(t),i[a].addSegments(e),i[a].index=a,this.setState(function(t){return{world:Object(d.a)({},t.world,{structures:i})}})}},{key:"updateStructures",value:function(){for(var t=Object(p.a)(this.state.world.pendingStructures),e=Object(p.a)(this.state.world.structures),a=0;a<t.length;a++){var i=t.splice(0,1)[0];e[i.index]=new ut(i.data),e[i.index].addSegments(i.openings),e[i.index].index=i.index}this.setState(function(a){return{world:Object(d.a)({},a.world,{structures:e,pendingStructures:t})}})}},{key:"structureToggle",value:function(t){var e=Object(p.a)(this.state.world.structures),a=this.state.world.stage,i=Object(d.a)({},this.state.world.sDatabase),r=i[a],s=r.find(function(e){return e.data.name===t});if(s.active)s.active&&(r[s.index].active=!1,e[s.index]=null,this.setState(function(t){return{world:Object(d.a)({},t.world,{structures:e,sDatabase:i})}}));else{r[s.index].active=!0;var n=Object(p.a)(this.state.world.pendingStructures);n.push(s),this.setState(function(t){return{world:Object(d.a)({},t.world,{pendingStructures:n,sDatabase:i})}})}}},{key:"defineEB",value:function(){this.sharedEB.borderZoneBehaviour=new M.a.CrossZone(new M.a.RectZone(0,0,this.state.screen.width,this.state.screen.height),"bound"),this.sharedEB.randomBehaviour=new M.a.RandomDrift(5,5,.05);var t=this.state.world.bodies[0]?{x:this.state.world.bodies[0].x,y:this.state.world.bodies[0].y}:{x:350,y:350};return this.sharedEB.centerBehaviour=new M.a.Repulsion(t,30,this.state.world.bodies[0]?2*this.state.world.bodies[0].size:30),this.sharedEB}},{key:"createNewEmitter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,a=void 0===e?null:e,i=t.color1,r=void 0===i?null:i,s=t.color2,n=void 0===s?null:s,o=t.mass,l=void 0===o?5:o,h=t.radius,c=void 0===h?1:h,u=t.velocity,d=void 0===u?2.5:u,p=t.rate1,v=void 0===p?20:p,m=t.rate2,b=void 0===m?.5:m,y=t.damp,f=void 0===y?.005:y,g=t.e,w=void 0===g?"once":g,x=t.life,k=void 0===x?5:x,S=t.planetAttraction,E=void 0===S||S,O=t.x,C=void 0===O?350:O,j=t.y,P=void 0===j?350:j,A=t.a,D=void 0===A?0:A,B=t.b,F=void 0===B?360:B,I=arguments.length>1&&void 0!==arguments[1]&&arguments[1],z=new M.a.Emitter;z.e=w,z.damping=f,z.rate=new M.a.Rate(new M.a.Span(v,1.5*v),b),z.addInitialize(z.rate),z.addInitialize(new M.a.Mass(l)),z.addInitialize(new M.a.Radius(c)),k&&z.addInitialize(new M.a.Life(k)),z.currVelocity=new M.a.Velocity(new M.a.Span(d,1.5*d),new M.a.Span(D,F),"polar"),z.addInitialize(z.currVelocity);var L=r?new M.a.Color(r,n||r):new M.a.Color("random");return z.addBehaviour(L),this.sharedEB.borderZoneBehaviour&&z.addBehaviour(this.sharedEB.borderZoneBehaviour),this.sharedEB.randomBehaviour&&z.addBehaviour(this.sharedEB.randomBehaviour),this.sharedEB.centerBehaviour&&z.addBehaviour(this.sharedEB.centerBehaviour),"core"===I?(z.coreAttraction=new M.a.Attraction(this.state.world.bodies[0],10,500),z.addBehaviour(z.coreAttraction)):"psi"===I?(z.planetAttraction=new M.a.Attraction(this.state.world.bDatabase[this.state.world.stage][a].data,10,500),z.addBehaviour(z.planetAttraction)):E&&null!==a&&(z.planetAttraction=new M.a.Attraction(this.state.world.bDatabase[this.state.world.stage][a].data,10,500),z.addBehaviour(z.planetAttraction)),z.target=a||0,a&&(z.mouseAttract=new M.a.Attraction(this.state.mouseObj,5,200),z.addBehaviour(z.mouseAttract),z.p.x=C,z.p.y=P),a||(z.mouseAttract=new M.a.Attraction(this.state.mouseObj,5,200),z.addBehaviour(z.mouseAttract),z.p.x=C,z.p.y=P),z}},{key:"makePsiEmitter",value:function(){var t=this;this.setState(function(e){return{proton:Object(d.a)({},e.proton,{psiEmitter:t.createNewEmitter({e:"once",color1:"#6699FF",color2:"#FFDDFF",rate1:50,rate2:.01,velocity:1,mass:8,radius:1,damp:.009,life:5,special:"psi"})})}})}},{key:"addCoreEmitter",value:function(){var t=this;this.setState(function(e){return{proton:Object(d.a)({},e.proton,{coreEmitter:t.createNewEmitter({target:0,special:"core",e:2,color1:G(t.state.world.bodies[0].hue,40,-10,-10),rate1:6,rate2:.6,velocity:1.8,damp:.014,life:20,mass:15,radius:4,planetAttraction:!0,a:S.a.random(-330,-30)+30,b:S.a.random(30,330)-30})})}})}},{key:"emitterParticleCheck",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.proton.psiEmitter,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.world.bodies[0],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=t.particles.length,r=new M.a.Repulsion(this.state.world.bodies[0],60,15*this.state.world.bodies[0].size);if(i>a)for(var s=0;s<i/a-1;s++){var n=t.particles[i-(s*a+1)];!n.dead&&q(n.p,e)<5*e.size&&(n.addBehaviour(new M.a.Color("#59FF98","#49FF88")),n.mass*=2,n.energy*=2,n.addBehaviour(r),this.setState(function(t){return{resources:Object(d.a)({},t.resources,{matter:t.resources.matter+1})}}))}}},{key:"thrustInput",value:function(){var t=0,e=0;return this.state.keys.up&&(e-=this.state.ball.thrustAcc*Math.pow(this.state.keys.up,.3)*1.5),this.state.keys.down&&(e+=this.state.ball.thrustAcc*Math.pow(this.state.keys.down,.3)*1.5),this.state.keys.left&&(t-=this.state.ball.thrustAcc*Math.pow(this.state.keys.left,.3)*1.5),this.state.keys.right&&(t+=this.state.ball.thrustAcc*Math.pow(this.state.keys.right,.3)*1.5),[t,e]}},{key:"borderCollision",value:function(t){this.state.params.bounceDampening;var e=this.state.screen.width,a=this.state.screen.height;return t.x+t.vx>e-t.size||t.x+t.vx<t.size?[-1,1]:t.y+t.vy>a-t.size||t.y+t.vy<t.size?[1,-1]:[1,1]}},{key:"ballGravPull",value:function(t,e){var a=0,i=0,r=!0,s=!1,n=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=o.value;if(h){var c=q(t,h);a+=h.mass*R(t,h).x/Math.pow(c*this.state.params.gravFalloff,2),i+=h.mass*R(t,h).y/Math.pow(c*this.state.params.gravFalloff,2)}}}catch(u){s=!0,n=u}finally{try{r||null==l.return||l.return()}finally{if(s)throw n}}return[-a,-i]}},{key:"structCollisionCheck",value:function(){var t=this.state.ball,e=(P()(t.x-this.props.width/2,t.y-this.props.height/2).horizontalAngle()+2*Math.PI)%(2*Math.PI),a=(Object(p.a)(this.state.world.structures),!0),i=!1,r=void 0;try{for(var s,n=this.state.world.structures[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;if(o&&q(t,o.origin)>o.radius-o.width/2-t.size&&q(t,o.origin)<o.radius+o.width/2+t.size){var l=o.arcLength,h=!0,c=!1,u=void 0;try{for(var d,v=o.segments[Symbol.iterator]();!(h=(d=v.next()).done);h=!0){var m=d.value,b=o.speed>0?(e-m.ac+3*Math.PI)%(2*Math.PI)-Math.PI:(-(e+m.bc)+3*Math.PI)%(2*Math.PI)-Math.PI;if(m.health>0&&(b>0&&b<l||b<0&&b>Math.PI-l))return m.health--,0===m.health&&(m.health=-6,console.log("segment disabled!")),this.structCollState(o.index)}}catch(y){c=!0,u=y}finally{try{h||null==v.return||v.return()}finally{if(c)throw u}}}}}catch(y){i=!0,r=y}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return this.structCollState(!1)}},{key:"structCollState",value:function(t){var e=.8*this.state.params.bounceDampening;return!1!==t?!1!==this.state.ball.coll?this.state.tick%3===0?(this.setState(function(t){return{ball:Object(d.a)({},t.ball,{ct:t.ball.ct+1})}}),[1*(1+this.state.ball.ct/10)*e,1*(1+this.state.ball.ct/10)*e]):[1,1]:(this.setState(function(e){return{ball:Object(d.a)({},e.ball,{coll:t,ct:1})}}),[-1*e,-1*e]):(!1!==this.state.ball.coll&&this.setState(function(t){return{ball:Object(d.a)({},t.ball,{coll:!1,ct:0})}}),[1,1])}},{key:"planetMotion",value:function(){var t=this,e=Object(p.a)(this.state.world.bodies);if(this.state.mousedown&&this.state.resources.energy>0&&this.state.mouseTick%2===0){var a=!0,i=!1,r=void 0;try{for(var s,n=e[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;o&&o.getsPulled(9,this.state.mouseObj,this.state.mouseTick)}}catch(b){i=!0,r=b}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}this.setState(function(t){return{resources:Object(d.a)({},t.resources,{energy:t.resources.energy-1})}})}var l=!0,h=!1,c=void 0;try{for(var u,v=function(){var a=u.value;if(a){0!==a.speed&&"star"!==a.type&&a.movePlanet();var i=e.filter(function(t){return t!==a}),r=!0,s=!1,n=void 0;try{for(var o,l=i[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=o.value;h&&.95*q(a,h)<h.size+a.size&&t.planetCollision(a,h,2)}}catch(b){s=!0,n=b}finally{try{r||null==l.return||l.return()}finally{if(s)throw n}}}},m=e[Symbol.iterator]();!(l=(u=m.next()).done);l=!0)v()}catch(b){h=!0,c=b}finally{try{l||null==m.return||m.return()}finally{if(h)throw c}}}},{key:"planetCollision",value:function(t,e,a){if(1===a){var i=.9*this.state.params.bounceDampening;return.95*q(t,e)<e.size+t.size?(this.setState(function(t){return{currentScore:t.currentScore+1}}),[-1*i,-1*i]):[1,1]}if(2===a&&.96*q(t,e)<e.size+t.size)return this.setState(function(a){var i=Object(p.a)(a.world.bodies),r=i[i.indexOf(e)],s=i[i.indexOf(t)];return s.speed&&(s.dx+=R(t,e).x*(s.coll*s.size/8)*(r.mass/s.mass),s.dy+=R(t,e).y*(s.coll*s.size/8)*(r.mass/s.mass),s.coll+=2),{resources:Object(d.a)({},a.resources,{matter:a.resources.matter+1}),bodies:i}})}},{key:"ballCheckPlanets",value:function(){var t=this.state.world.bodies,e=this.state.ball,a=0,i=0,r=!0,s=!1,n=void 0;try{for(var o,h=t[Symbol.iterator]();!(r=(o=h.next()).done);r=!0){var c=o.value;if(c){var u=this.planetCollision(e,c,1),d=Object(l.a)(u,2),p=d[0],v=d[1];1===p&&1===v||(a+=p,i+=v)}}}catch(m){s=!0,n=m}finally{try{r||null==h.return||h.return()}finally{if(s)throw n}}return a||i?[a,i]:[1,1]}},{key:"moveBall",value:function(){var t=this.state.ball,e=this.state.world.bodies,a=this.state.params.bounceDampening,i=this.ballGravPull(t,e),r=this.thrustInput(),s=r[0]||r[1]?Math.sqrt(Math.pow(Math.abs(r[0]),2)+Math.pow(Math.abs(r[1]),2)):0,n=this.state.ball.vx+i[0]+r[0],o=this.state.ball.vy+i[1]+r[1],l=this.borderCollision(t);if(1!==l[0]||1!==l[1]){var h=q(t,{x:n*=-1*a*.5,y:o*=-1*a*.5});return this.setState(function(t){return{ball:Object(d.a)({},t.ball,{x:S.a.clamp(t.ball.x,0,t.screen.width)+n,y:S.a.clamp(t.ball.y,0,t.screen.height)+o,vx:n,vy:o,speed:h,thrustLevel:s||(t.ball.thrustLevel?Math.floor(100*t.ball.thrustLevel)/101:0)})}})}var c=this.structCollisionCheck(),u=1===c[0]?0:c[0],p=1===c[1]?0:c[1],v=this.ballCheckPlanets(),m=1===v[0]?0:v[0],b=1===v[1]?0:v[1];u&&m?(n*=-c[0]*v[0],o*=-c[1]*v[1]):(n*=c[0]*v[0],o*=c[1]*v[1]);var y=q(t,{x:n,y:o});return this.setState(function(t){return{ball:Object(d.a)({},t.ball,{x:t.ball.x+n+t.ball.vx/4*u+t.ball.vx/4*m,y:t.ball.y+o+t.ball.vy/4*p+t.ball.vy/4*b,vx:n,vy:o,speed:y,thrustLevel:s||(t.ball.thrustLevel?Math.floor(100*t.ball.thrustLevel)/101:0)})}})}},{key:"handlePauseStart",value:function(){!1===this.state.inGame?(this.continueGame(),console.log("continue")):!0===this.state.inGame&&(this.stopGame(),console.log("pause"))}},{key:"continueGame",value:function(){var t=this;requestAnimationFrame(function(e){t.update(e)}),this.setState(function(){return{inGame:!0}})}},{key:"stopGame",value:function(){clearInterval(this.timerID),cancelAnimationFrame(this.animationID),this.setState(function(){return{inGame:!1}})}},{key:"componentDidMount",value:function(){window.addEventListener("keyup",this.handleKeys.bind(this,!1)),window.addEventListener("keydown",this.handleKeys.bind(this,!0)),this.setState(function(){return{inGame:"loading"}}),this.defineEB(),this.createGalaxy(this.state.starList),this.loadStage("Sol"),this.makePsiEmitter()}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.animationID)}},{key:"update",value:function(){var t=Object(u.a)(c.a.mark(function t(e){var a,i,r,s,n,o,l,h=this;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!((a=e-this.state.ts)>1e3/60)){t.next=29;break}for(this.setState(function(t){return{ts:e-a%(1e3/60),tick:t.tick+1,mouseTick:t.mousedown?t.mouseTick+1:0,mouseReleased:!t.mousedown&&t.mouseTick>0}}),this.state.world.pendingBodies.length>0&&this.updatePlanets(),this.state.world.pendingStructures.length>0&&this.updateStructures(),this.planetMotion(),i=!0,r=!1,s=void 0,t.prev=11,n=this.state.world.structures[Symbol.iterator]();!(i=(o=n.next()).done);i=!0)(l=o.value)&&l.moveSegments();t.next=19;break;case 15:t.prev=15,t.t0=t.catch(11),r=!0,s=t.t0;case 19:t.prev=19,t.prev=20,i||null==n.return||n.return();case 22:if(t.prev=22,!r){t.next=25;break}throw s;case 25:return t.finish(22);case 26:return t.finish(19);case 27:this.moveBall(),this.state.proton.psiEmitter.particles.length>8&&this.state.tick%50===0&&this.emitterParticleCheck(this.state.proton.psiEmitter,this.state.world.bodies[0],4);case 29:if("loading"===this.state.inGame&&console.log("loading"),!0!==this.state.inGame){t.next=32;break}return t.abrupt("return",this.animationID=requestAnimationFrame(function(t){h.update(t)}));case 32:case"end":return t.stop()}},t,this,[[11,15,19,27],[20,,22,26]])}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e={tick:this.state.tick,ts:this.state.ts,inGame:this.state.inGame,currentScore:this.state.currentScore,stage:this.state.world.stage,ball:this.state.ball,resources:this.state.resources,mousedown:this.mousedown},a=this.state.world.stage,i=this.makeMapInterface(e),s=Object(d.a)({},this.state.world.bDatabase),n=s[a]&&s[a].length>0?s[a].slice(1).map(function(e){return r.a.createElement(J,{onClick:t.handlePlanetToggle,body:e,key:e.data.name})}):null,o=Object(d.a)({},this.state.world.sDatabase),l=o[a]?o[a].map(function(e){return r.a.createElement($,{onClick:t.handleStructureToggle,struct:e,key:e.data.name})}):null,h=this.state.selectedObj?r.a.createElement(N,{style:{color:"#05051A",backgroundColor:"#DACFDA",textAlign:"left",listStyle:"none",padding:"0.4em 0.6em",margin:"0.5em auto",minWidth:"30%",minHeight:"6em"},obj:this.state.selectedObj,fShield:this.handleChargeShield}):r.a.createElement("span",{style:{minWidth:"30%",minHeight:"6em",margin:"0.5em auto"}},"Click on an in-system body for an info box"),c=this.makeControlButtons(),u=this.state.world.bodies[0]?r.a.createElement(dt,Object.assign({onMouseDown:this.mousedownHandler,onMouseUp:this.mouseupHandler,onMouseMove:this.mousemoveHandler,style:{background:"#36454F"}},this.state)):null;return r.a.createElement("div",{className:"showcase"},u,r.a.createElement(Y,{ui:e},r.a.createElement(x.a,{isOpen:this.state.showModal,contentLabel:"onRequestClose Example",onRequestClose:this.handleCloseModal,shouldCloseOnOverlayClick:!0,style:{content:{backgroundColor:"#30405E",maxWidth:"30%"}},ui:e},r.a.createElement("h2",{style:{fontColor:"#C0C0EE",margin:"0.5em",textAlign:"center"}},"Galaxy map"),r.a.createElement(V,{ui:e},i),r.a.createElement("button",{style:{backgroundColor:"#30405E",padding:"0.2em",margin:"2em 0.5em 0.5em"},onClick:this.handleCloseModal},"Close")),r.a.createElement(H,{ui:e}),r.a.createElement("p",null,"WASD to accelerate"),r.a.createElement(U,{ui:e},r.a.createElement(V,{ui:e},c),r.a.createElement(V,{ui:e},l),r.a.createElement(V,{ui:e},n)),r.a.createElement("button",{onClick:this.handleOpenModal,style:{fontSize:"1.3em",alignSelf:"center",backgroundColor:"#30405E",padding:"0.5em",margin:"0.6em auto",borderRadius:"1px"}},"GALAXY MAP"),h))}}]),e}(i.Component),Y=function(t){t.ui;var e=t.children;return r.a.createElement("div",{className:"game-interface"},e)},H=function(t){var e=t.ui;return r.a.createElement("div",{className:"interface-element",style:{fontSize:"1.1em",margin:"0.2em auto",width:"100%",padding:"0.1em",transitionDuration:"0"}},r.a.createElement("p",{style:{textAlign:"left"}},"Stage: ".concat(e.stage," || Energy: ").concat(e.resources.energy," || Matter: ").concat(e.resources.matter," || Psi: ").concat(e.resources.psi," || Score: ").concat(e.currentScore)))},N=function(t){var e=t.style,a=t.obj,i=t.fShield;t.fUplink;return r.a.createElement("section",{style:e},r.a.createElement("li",{style:{minWidth:"15em"}},r.a.createElement("ul",null,"Name: ".concat(a.name)),r.a.createElement("ul",null,"Mass: ".concat(a.mass)),r.a.createElement("ul",null,"Coordinates: X ".concat(a.x.toFixed(0),"|| Y ").concat(a.y.toFixed(0))),r.a.createElement("ul",null,"Type: ".concat(a.type)),r.a.createElement("ul",null,"Shield power: ".concat(a&&a.status&&a.status.shield?a.status.shield:0)),r.a.createElement("ul",null,"Psychic uplink: ".concat(a&&a.status&&a.status.uplink?a.status.uplink:0))),r.a.createElement("button",Object(o.a)({style:{fontSize:"0.8em",padding:"0.1em",margin:"0.2em"},id:"shieldCharge",text:"",onClick:i},"id",a.name),"CHARGE SHIELD"))},U=function(t){var e=t.children;return r.a.createElement("div",{className:"game-controls",style:{padding:"0.1em",margin:"0.1em"}},e)},V=function(t){t.ui;var e=t.children;return r.a.createElement("div",{className:"interface-element"},e)},Z=function(t){var e=t.onClick,a=t.text,i=t.style,s=t.id;return r.a.createElement("button",{onClick:e,type:"button",style:i,id:s},a)},K=function(t){var e=t.onClick,a=t.star,i=t.ui;return r.a.createElement("button",{onClick:e,type:"button",style:i.stage===a?{backgroundColor:"#DD1133"}:{backgroundColor:"#4422EE"},id:a},"Load system: ",a)},J=function(t){var e=t.onClick,a=t.body;return r.a.createElement("button",{onClick:e,style:{backgroundColor:"".concat(G(a.data.hue,-20))},id:a.data.name},"Toggle planet: ",a.data.name)},$=function(t){var e=t.onClick,a=t.struct;return r.a.createElement("button",{onClick:e,style:{backgroundColor:"".concat(G(a.data.hue,-40))},id:a.data.name},"Toggle structure: ",a.data.name)},Q={size:9,orbitX:200,orbitY:160,rot:200,speed:-1.5,mass:100,hue:"#ff4336",glow:.8,angle:0,name:"Mars"},_={size:6,orbitX:35,orbitY:32,rot:100,speed:1.5,mass:50,hue:"#EE1111",glow:.6,angle:40,name:"Phobos"},tt={size:12,orbitX:105,orbitY:90,rot:205,speed:1,mass:165,hue:"#00A86B",glow:.8,angle:10,name:"Venus"},et={size:11,orbitX:155,orbitY:140,rot:20,speed:1,mass:150,hue:"#007FFF",glow:1.2,angle:20,name:"Earth"},at={size:19,orbitX:0,speed:0,mass:220,hue:"#FFCC33",glow:2.5,angle:0,name:"Sol"},it={size:14,orbitX:310,speed:.5,mass:190,hue:"#d9b47d",glow:1,angle:210,name:"Saturn"};function rt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"planet",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=O()(t,{state:i});if("star"===e)return{orbitX:0,speed:0,size:Math.floor((17*r.quick()+10)*a),mass:Math.floor((200*r.quick()+60)*a),hue:"#"+r.int32().toString(16).slice(-6),glow:1.5,name:t+" Primary",rngstate:i?r.state:null};var s=Math.floor(300*r.quick()*Math.pow(a,.5));return{orbitX:s,orbitY:s-Math.floor(3+15*r.quick()*Math.pow(a,2.5)),rot:Math.floor(330*r.quick()),angle:Math.floor(330*r.quick()),speed:+((1.5*r.quick()+.3)/a).toFixed(1),size:Math.floor((12*r.quick()+4)*Math.pow(a,1.25)),mass:Math.floor((150*r.quick()+40)*a),hue:G("#"+r.int32().toString(16).slice(-6),20),glow:Math.floor(20*r.quick())/20,name:t,rngstate:i?r.state:null}}var st=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(v.a)(this,t),this.data=e,this.parent=a,this.xPar=this.parent?this.parent.x:e.xPar||350,this.yPar=this.parent?this.parent.y:e.yPar||350,this.size=e.size||15,this.orbitX=e.orbitX||0,this.orbitY=e.orbitY||this.orbitX,this.type=e.orbitX>0?"planet":"star",this.rot=e.rot||0,this.orbitX!==this.orbitY&&(this.e=Math.sqrt(1-Math.pow(this.orbitY,2)/Math.pow(this.orbitX,2)),this.pfdist=new P.a(this.orbitX*this.e,0),this.pfdist.rotateDeg(this.rot),this.pf={x:this.xPar+this.pfdist.x,y:this.yPar+this.pfdist.y},this.per=this.orbitX-this.orbitX*this.e,this.aph=this.orbitX+this.orbitX*this.e),this.speed=e.speed||0,this.speedWarp=0,this.mass=e.mass||0,this.hue=e.hue||"#FFFF00",this.glow=e.glow||0,this.name=e.name||"Unknown",this.angle=e.angle||0,this.dir=this.speed>0?1:-1,this.x=this.xPar+this.orbitX,this.y=this.yPar+this.orbitY,this.dx=0,this.dy=0,this.coll=0,console.log("creating body: "+this.name),this.rngstate=e.rngstate||0}return Object(m.a)(t,[{key:"getsPulled",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=q(this,e),r=1+.05*a;this.speedWarp=200*t/this.mass/(Math.pow(.5*i,1.1)*r),i>2*this.size*r&&(this.dx-=t*R(this,e).x/(Math.pow(.04*i,1.1)*r),this.dy-=t*R(this,e).y/(Math.pow(.04*i,1.1)*r))}},{key:"movePlanet",value:function(){if(this.angle+=this.orbitX===this.orbitY?Math.acos(1-Math.pow(this.speed/(1+this.speedWarp)/this.orbitX,2)/2)%Math.PI*2*this.dir:Math.acos(1-Math.pow(this.speed*(1+this.e*Math.cos(this.angle))/(1+this.speedWarp)/this.orbitX,2)/2)%Math.PI*2*this.dir,this.parent&&(this.xPar=this.parent.x,this.yPar=this.parent.y,this.orbitX!==this.orbitY&&(this.xPar-=this.pfdist.x,this.yPar-=this.pfdist.y)),this.orbitX===this.orbitY)this.x=this.xPar+this.orbitX*Math.cos(this.angle)+this.dx,this.y=this.yPar+this.orbitY*Math.sin(this.angle)+this.dy;else{var t=new P.a(this.orbitX*Math.cos(this.angle),this.orbitY*Math.sin(this.angle));t.rotateDeg(this.rot),this.x=this.xPar+t.x+this.dx,this.y=this.yPar+t.y+this.dy}this.dx&&(this.dx=Math.abs(this.dx)>1?.99*this.dx:0),this.dy&&(this.dy=Math.abs(this.dy)>1?.99*this.dy:0),this.speedWarp&&(this.speedWarp=this.speedWarp>.1?.8*this.speedWarp:0),this.coll&&this.coll--}}]),t}(),nt={numSeg:5,gap:.35,radius:190,speed:-1.4,origin:{x:350,y:350},width:16,hue:"#DF70FF",name:"S1"},ot={numSeg:12,gap:.4,radius:320,speed:.7,origin:{x:350,y:350},width:12,hue:"#FFD5D0",name:"S2"},lt={numSeg:2,gap:.2,radius:50,speed:.5,origin:{x:350,y:350},width:10,hue:"#86CFEF",name:"S3"},ht={numSeg:18,gap:.1,radius:250,speed:.4,origin:{x:350,y:350},width:12,hue:"#FF6655",name:"S4"};function ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=O()(t,{state:a});return{numSeg:1*Math.floor(1+12*i.quick()),arg:0,gap:Math.floor(50*i.quick())/100,speed:(1.5*i.quick()/e).toFixed(1)-1,width:Math.floor(1*(15*i.quick()+4)),radius:Math.floor(280*i.quick()+30),hue:G("#"+i.int32().toString(16).slice(-6),30),glow:Math.floor(20*i.quick())/15,name:t,rngstate:a?i.state:null,origin:{x:350,y:350}}}var ut=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.numSeg,i=void 0===a?5:a,r=e.gap,s=void 0===r?.4:r,n=e.radius,o=void 0===n?240:n,l=e.speed,h=void 0===l?5:l,c=e.origin,u=void 0===c?{x:350,y:350}:c,d=e.width,p=void 0===d?10:d,m=e.hue,b=void 0===m?"#E0E0E0":m,y=(e.glow,e.name),f=void 0===y?"(Unknown)":y,g=e.arg,w=void 0===g?0:g;Object(v.a)(this,t),this.numSeg=i,this.arg=w,this.gap=s,this.radius=o,this.speed=h,this.dir=h<0?-1:1,this.origin=u,this.width=p,this.hue=b,this.glow=.5,this.regen=4,this.segments=[],this.name=f,this.arcLength=2*Math.PI*(1-s)/i}return Object(m.a)(t,[{key:"addSegments",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=1===this.dir?this.arg:this.arg-2*Math.PI,a=(this.gap,this.numSeg),i=this.radius,r=this.origin,s=this.width,n=this.hue,o=this.glow,l=this.dir,h=this.arcLength,c=0;c<a;c++){var u={a:e,b:e+h,arcLength:h,randArc:S.a.random(.4*h,!0),r:i,ac:e%(2*Math.PI),bc:(e+h)%(2*Math.PI),dir:l,origin:r,width:s,hue:0===c?"#4DEEE4":n,glow:0===c?5*o:o,health:3,phase:0};this.segments.push(u),e+=2*Math.PI/a}for(var d=0;d<t;d++)this.destroyRandom()}},{key:"destroySegment",value:function(t){var e=this.segments.filter(function(e){return e!==t});this.segments=e}},{key:"destroyRandom",value:function(){var t=this.segments[S.a.random(this.segments.length)-1];this.destroySegment(t)}},{key:"moveSegments",value:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=this.segments[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;this.speed>0?(s.a+=2*Math.PI*.001*this.speed,s.ac=(Math.abs(s.a)+2*Math.PI)%(2*Math.PI),s.b+=2*Math.PI*.001*this.speed,s.bc=(Math.abs(s.b)+2*Math.PI)%(2*Math.PI)):this.speed<0&&(s.a+=2*Math.PI*.001*this.speed,s.b+=2*Math.PI*.001*this.speed,s.ac=Math.abs(s.a-2*Math.PI)%(2*Math.PI),s.bc=Math.abs(s.b-2*Math.PI)%(2*Math.PI));var n=Math.floor(Math.abs(1e4*Math.sin((s.a+2*Math.PI)%(2*Math.PI)))),o=n%150;s.glow=this.glow+n/300*this.glow,s.health<3&&o<this.regen&&(s.health<0?s.health+=.5:s.health++)}}catch(l){e=!0,a=l}finally{try{t||null==r.return||r.return()}finally{if(e)throw a}}}}]),t}(),dt=function(t){function e(t){var a;return Object(v.a)(this,e),(a=Object(b.a)(this,Object(y.a)(e).call(this,t))).state={zones:[]},a.saveContext=a.saveContext.bind(Object(g.a)(Object(g.a)(a))),a.tick=1,a.psiLevel=0,a.emitterList=[],a}return Object(f.a)(e,t),Object(m.a)(e,[{key:"saveContext",value:function(t){this.protonCanvas=t,this.ctx=t.getContext("2d"),this.width=this.ctx.canvas.width,this.height=this.ctx.canvas.height}},{key:"componentDidMount",value:function(){this.createProton()}},{key:"createProton",value:function(){var t=this;this.proton=new M.a,this.clickEmitter=this.createClickEmitter("#F8F8FF","#F8F8FF",this.props.ball),this.renderer=new M.a.CanvasRenderer(this.protonCanvas),this.renderer.onParticleUpdate=function(e){t.ctx.globalAlpha=.9,t.ctx.beginPath(),t.ctx.strokeStyle=e.color,t.ctx.lineWidth=2*e.energy+e.radius/4,t.ctx.moveTo(e.old.p.x-20*e.old.a.x,e.old.p.y-20*e.old.a.y),t.ctx.lineTo(e.p.x,e.p.y),t.ctx.closePath(),t.ctx.stroke(),t.ctx.globalAlpha=1},this.proton.addRenderer(this.renderer)}},{key:"createClickEmitter",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new M.a.Emitter,r={x:this.props.world.bodies[0].x||this.width/2,y:this.props.world.bodies[0].y||this.height/2},s=new M.a.Repulsion(r,10,2*this.props.world.bodies[0].size||30),n=new M.a.CrossZone(new M.a.RectZone(0,0,this.protonCanvas.width,this.protonCanvas.height),"bound"),o=new M.a.RandomDrift(5,5,.05);return i.addBehaviour(o),i.addBehaviour(n),i.addBehaviour(s),i.target=a,i.damping=.012,i.addInitialize(new M.a.Rate(40,.025)),i.addInitialize(new M.a.Mass(8)),i.addInitialize(new M.a.Life(new M.a.Span(3,5))),i.addInitialize(new M.a.Radius(1)),i.currVelocity=new M.a.Velocity(2,new M.a.Span(0,360),"polar"),i.addInitialize(i.currVelocity),i.addBehaviour(new M.a.Color(t,e)),i.pointAttraction=new M.a.Attraction(a,20,600),i.addBehaviour(i.pointAttraction),i.p.x=this.props.mouseObj.x,i.p.y=this.props.mouseObj.y,this.proton.addEmitter(i),i}},{key:"componentDidUpdate",value:function(){var t=this.props.world.bodies;if(this.props.tick>this.tick){this.props.tick%10===0&&(this.updateWorld(),this.props.tick%500===0&&this.coreEmitter.emit(this.coreEmitter.e)),this.proton.update(),this.psiLevel<this.props.resources.psi&&this.psiEmitter&&(this.psiLevel++,this.psiEmitter.rate=this.psiLevel<9?new M.a.Rate(new M.a.Span(20+5*this.psiLevel,25+8*this.psiLevel),.25*this.psiLevel):new M.a.Rate(new M.a.Span(150,180),4),this.psiEmission()),this.drawStructures();var e=!0,a=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value;n&&(n.status&&n.status.uplink&&this.drawConnect(n,this.props.ball),this.drawPlanet(n))}}catch(o){a=!0,i=o}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}this.drawBall(),this.drawScore(),this.mouseInput(),this.tick=this.props.tick}}},{key:"mouseInput",value:function(){if(!0===this.props.mousedown){if(this.props.mouseTick%10===0){var t=!0,e=!1,a=void 0;try{for(var i,r=this.emitterList[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;s&&s.mouseAttract&&s.mouseAttract.reset(this.props.mouseObj,25,600)}}catch(d){e=!0,a=d}finally{try{t||null==r.return||r.return()}finally{if(e)throw a}}}this.clickEmission()}else if(!0===this.mouseReleased){var n=!0,o=!1,l=void 0;try{for(var h,c=this.emitterList[Symbol.iterator]();!(n=(h=c.next()).done);n=!0){var u=h.value;u&&u.mouseAttract&&u.mouseAttract.reset(this.props.mouseObj,5,200)}}catch(d){o=!0,l=d}finally{try{n||null==c.return||c.return()}finally{if(o)throw l}}}}},{key:"clickEmission",value:function(){this.clickEmitter.p.x=this.props.mouseObj.x,this.clickEmitter.p.y=this.props.mouseObj.y,this.clickEmitter.pointAttraction.reset(this.props.ball,20,600),this.clickEmitter.emit("once")}},{key:"psiEmission",value:function(){this.psiEmitter.p.x=this.props.ball.x,this.psiEmitter.p.y=this.props.ball.y;var t=P()(this.props.ball.x-this.protonCanvas.width/2,this.props.ball.y-this.protonCanvas.height/2).verticalAngleDeg();this.psiEmitter.currVelocity.reset(new M.a.Span(2,3),new M.a.Span((t+180)%360-15,(t+180)%360+15),"polar"),this.psiEmitter.emit("once")}},{key:"updateWorld",value:function(){this.updateEmitters()}},{key:"updateEmitters",value:function(t){var e=this.props.world.bodies,a=!0,i=!1,r=void 0;try{for(var s,n=e[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;o&&!this.emitterList[o.index]&&o.emitter&&(this.emitterList[o.index]=o.emitter,this.proton.addEmitter(this.emitterList[o.index]),this.emitterList[o.index].emit(this.emitterList[o.index].e))}}catch(v){i=!0,r=v}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}var l=!0,h=!1,c=void 0;try{for(var u,d=this.emitterList[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var p=u.value;p&&p.target&&!e[p.target]?(this.proton.removeEmitter(p),this.emitterList[p.target]=null):p&&p.target&&e[p.target]&&(p.p.x=e[p.target].x,p.p.y=e[p.target].y,e[p.target].coll%6===2&&p.emit(p.e),p.planetAttraction&&p.planetAttraction.reset(e[p.target],p.planetAttraction.force/100,p.planetAttraction.radius))}}catch(v){h=!0,c=v}finally{try{l||null==d.return||d.return()}finally{if(h)throw c}}!this.psiEmitter&&this.props.proton.psiEmitter&&(this.psiEmitter=this.props.proton.psiEmitter,this.proton.addEmitter(this.psiEmitter)),!this.coreEmitter&&this.props.proton.coreEmitter&&(this.coreEmitter=this.props.proton.coreEmitter,this.proton.addEmitter(this.coreEmitter))}},{key:"drawConnect",value:function(t,e){this.ctx.beginPath(),this.ctx.globalAlpha=t.status.uplink?t.status.uplink/100:0,this.ctx.strokeStyle="#4397DC",this.ctx.lineWidth=1,this.ctx.setLineDash([40,15]),this.ctx.lineDashOffset=20,this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.shadowBlur=0,this.ctx.shadowColor=0,this.ctx.setLineDash([]),this.ctx.globalAlpha=1}},{key:"drawScore",value:function(){var t=this.props.currentScore;this.ctx.fillStyle="#F5F5F5",this.ctx.font="22px Arial",this.ctx.fillText("x"+t,10,25)}},{key:"drawBall",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5,e=this.props.ball,a=e.x,i=e.y,r=e.vx,s=e.vy,n=e.size,o=e.color,l=e.glow,h=Math.floor(10*e.thrustLevel),c=h?G(o,6*h,-10*h,-15*h):o;l&&(this.ctx.shadowBlur=h?10*l+Math.pow(90*h,.3):8*l,this.ctx.shadowColor=c),t&&(this.ctx.beginPath(),this.ctx.globalAlpha=.25,this.ctx.arc(a-r*t,i-s*t,n,0,2*Math.PI),this.ctx.fillStyle=c,this.ctx.fill(),this.ctx.closePath(),this.ctx.globalAlpha=1),this.ctx.beginPath(),this.ctx.arc(a,i,n,0,2*Math.PI),this.ctx.fillStyle=o,this.ctx.fill(),this.ctx.closePath(),this.ctx.shadowBlur=0,this.ctx.shadowColor=0}},{key:"drawPlanet",value:function(t){if(this.ctx.beginPath(),t.orbitX!==t.orbitY?this.ctx.ellipse(t.xPar,t.yPar,t.orbitX,t.orbitY,t.rot/360*(2*Math.PI),0,2*Math.PI,!0):this.ctx.arc(t.xPar,t.yPar,t.orbitX,0,2*Math.PI,!1),this.ctx.lineWidth=2,this.ctx.globalAlpha=.4,this.ctx.strokeStyle="#E0E0E0",this.ctx.closePath(),this.ctx.stroke(),this.ctx.beginPath(),t.glow&&(this.ctx.shadowBlur=10*t.glow,this.ctx.shadowColor=G(t.hue,20)),this.ctx.globalAlpha=1,this.ctx.arc(t.x,t.y,t.size,0,2*Math.PI),this.ctx.fillStyle=t.hue,this.ctx.fill(),this.ctx.closePath(),t.status&&t.status.shield){this.ctx.shadowBlur=t.status.shield/50,this.ctx.shadowColor="#77AAFF",this.ctx.globalAlpha=.1+t.status.shield/200;var e=this.ctx.createLinearGradient(t.x-t.size,t.y-t.size,t.x+t.size,t.y+t.size);e.addColorStop(0,"#FFFFFF"),e.addColorStop(t.status.shield/100,t.hue),e.addColorStop(1,t.hue),this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,2*Math.PI),this.ctx.fillStyle=e,this.ctx.fill(),this.ctx.closePath()}this.ctx.shadowBlur=0,this.ctx.shadowColor=0}},{key:"drawStructures",value:function(){var t=this.props.world.structures,e=this.props.world.bodies,a=!0,i=!1,r=void 0;try{for(var s,n=t[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;if(o){var l=!0,h=!1,c=void 0;try{for(var u,d=o.segments[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var p=u.value;if(p.health>0&&(this.drawSegment(p),p.health<3)){var v=!0,m=!1,b=void 0;try{for(var y,f=e.slice(1)[Symbol.iterator]();!(v=(y=f.next()).done);v=!0){var g=y.value;this.drawBeam(p,g)}}catch(w){m=!0,b=w}finally{try{v||null==f.return||f.return()}finally{if(m)throw b}}}}}catch(w){h=!0,c=w}finally{try{l||null==d.return||d.return()}finally{if(h)throw c}}}}}catch(w){i=!0,r=w}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}}},{key:"drawSegment",value:function(t){this.ctx.beginPath(),t.glow&&(this.ctx.shadowBlur=1*t.glow,this.ctx.shadowColor=G(t.hue,20)),this.ctx.globalAlpha=.33*t.health,this.ctx.arc(t.origin.x,t.origin.y,t.r,t.a,t.b,!1),this.ctx.lineWidth=t.width,this.ctx.strokeStyle=t.hue,this.ctx.stroke(),this.ctx.closePath(),this.ctx.globalAlpha=1,this.ctx.shadowBlur=0,this.ctx.shadowColor=0}},{key:"drawBeam",value:function(t,e){this.props.tick;this.ctx.lineCap="round",this.ctx.globalAlpha=.3+.4/t.health,this.ctx.strokeStyle="#84CFFA",this.ctx.lineWidth=5,this.ctx.setLineDash([15,20]),this.ctx.lineDashOffset=10+Math.floor(this.props.tick%50/2);P()(e.x,e.y);var a=P()(t.r,0);t.dir>0?a.rotate(t.a+t.arcLength/2):a.rotate(t.b-t.arcLength/2),this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.origin.x+.97*a.x,t.origin.y+.97*a.y),this.ctx.closePath(),this.ctx.stroke(),a.rotateBy(t.randArc*t.dir*2),this.ctx.moveTo(e.x,e.y),this.ctx.beginPath(),this.ctx.lineTo(t.origin.x+.97*a.x,t.origin.y+.97*a.y),this.ctx.closePath(),this.ctx.stroke(),a.rotateBy(-t.randArc*t.dir*2),this.ctx.moveTo(e.x,e.y),this.ctx.beginPath(),this.ctx.lineTo(t.origin.x+.97*a.x,t.origin.y+.97*a.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.lineCap="butt",this.ctx.shadowBlur=0,this.ctx.shadowColor=0,this.ctx.setLineDash([]),this.ctx.globalAlpha=1}},{key:"render",value:function(){return r.a.createElement(pt,{width:this.props.screen.width,height:this.props.screen.height,contextRef:this.saveContext,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,style:this.props.style})}}]),e}(r.a.Component),pt=function(t){function e(){return Object(v.a)(this,e),Object(b.a)(this,Object(y.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(m.a)(e,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var t=this;return r.a.createElement("canvas",{id:"myCanvas",width:this.props.width,height:this.props.height,ref:function(e){return e?t.props.contextRef(e):null},onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,style:this.props.style})}}]),e}(r.a.Component),vt=function(t){function e(t){var a;return Object(v.a)(this,e),(a=Object(b.a)(this,Object(y.a)(e).call(this,t))).state={hasError:!1},a}return Object(f.a)(e,t),Object(m.a)(e,[{key:"componentDidCatch",value:function(t,e){console.log(t,e),this.setState({error:t,info:e})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement("div",null,r.a.createElement("h1",null,"Something went wrong."),r.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),r.a.createElement("br",null),this.state.info.componentStack)):this.props.children}}],[{key:"getDerivedStateFromError",value:function(t){return{hasError:!0}}}]),e}(i.Component),mt=function(t){function e(){return Object(v.a)(this,e),Object(b.a)(this,Object(y.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(m.a)(e,[{key:"render",value:function(){return r.a.createElement(vt,null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"header"},r.a.createElement("h1",{className:"header-name"},"Orbit game title")),r.a.createElement(W,{width:"700",height:"700"})))}}]),e}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(r.a.createElement(mt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[28,1,2]]]);
//# sourceMappingURL=main.326e8b5f.chunk.js.map