{"version":3,"sources":["App.js","serviceWorker.js","index.tsx"],"names":["Modal","setAppElement","KEY","objectDistance","b1","arguments","length","undefined","x","y","b2","v1","Victor","v2","distance","towardsBody","origin","target","shadeColor","color","rShade","gShade","bShade","R","parseInt","substring","G","B","toString","OrbitGame","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","screen","width","height","ratio","window","devicePixelRatio","starList","name","num","world","stage","bodies","pendingBodies","bDatabase","Sol","data","solData","parent","index","active","marsData","venusData","phobosData","earthData","saturnData","structures","pendingStructures","sDatabase","rs1","openings","rs2","rs3","rs4","params","gravFalloff","bounceDampening","ball","vx","vy","size","mass","speed","thrustAcc","heading","power","coll","ct","glow","resources","matter","energy","psi","hm","keys","left","right","up","down","space","proton","mousedown","mouseTick","mouseReleased","mouseObj","init","selectedObj","tick","ts","randomHash","currentScore","inGame","showModal","sharedEB","animationID","timerID","handlePowerChange","bind","assertThisInitialized","handleChargePsi","handleSystemChange","handleCanvasClick","handlePlanetToggle","handleStructureToggle","handlePauseStart","handleKeys","mouseupHandler","mousedownHandler","mousemoveHandler","handleOpenModal","handleCloseModal","ui","_this2","toConsumableArray","push","map","star","react_default","a","createElement","App_StarButton","onClick","_this3","mouse","objectSpread","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_loop","body","value","console","log","v","setState","prevState","_iterator","Symbol","iterator","next","done","_ret","err","return","e","keyCode","_x","nativeEvent","layerX","_y","layerY","selectOnCanvas","id","systemChange","p","planetToggle","s","structureToggle","system","rngData","rngBody","i","Math","floor","seedrandom","quick","planet","sysStruct","rngStruct","struct","starlist","n","generateSystem","genSysStructures","pending","db","dbplanets","slice","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","createPrimary","loadStagePlanets","loadStageStructures","addCoreEmitter","continueGame","currStage","bdb","sdb","bdb2","sdb2","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","loadStage","Body","em","emitter","createNewEmitter","splice","color1","hue","rate1","rate2","velocity","damp","life","createPlanet","planets","find","b","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","ringStructure","addSegments","ps","borderZoneBehaviour","Proton","CrossZone","RectZone","randomBehaviour","RandomDrift","centerZone","centerBehaviour","Repulsion","_ref","_ref$target","_ref$color","_ref$color2","color2","_ref$mass","_ref$radius","radius","_ref$velocity","_ref$rate","_ref$rate2","_ref$damp","_ref$e","_ref$life","_ref$planetAttraction","planetAttraction","_ref$x","_ref$y","_ref$a","_ref$b","special","Emitter","damping","rate","Rate","Span","addInitialize","Mass","Radius","Life","currVelocity","Velocity","c","Color","addBehaviour","coreAttraction","Attraction","mouseAttract","_this4","psiEmitter","_this5","coreEmitter","_","random","sample","particles","particle","dead","tx","ty","pow","object","bounce","sqrt","targets","gx","gy","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","dist","angle","horizontalAngle","PI","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_step11","_iterator11","arcLength","segments","bc","ac","dir","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_step12","_iterator12","seg","angleDiff","health","structCollState","_this6","_iteratorNormalCompletion13","_didIteratorError13","_iteratorError13","_step13","_iterator13","getsPulled","_iteratorNormalCompletion14","_didIteratorError14","_iteratorError14","_step14","_loop2","type","movePlanet","otherBodies","filter","item","_iteratorNormalCompletion15","_didIteratorError15","_iteratorError15","_step15","_iterator15","planetCollision","_iterator14","_ret2","indexOf","o","dx","dy","pcx","pcy","_iteratorNormalCompletion16","_didIteratorError16","_iteratorError16","_step16","_iterator16","_this$planetCollision","_this$planetCollision2","slicedToArray","cx","cy","g","ballGravPull","t","thrustInput","borderCollision","sc","structCollisionCheck","pc","ballCheckPlanets","stopGame","_this7","requestAnimationFrame","update","clearInterval","cancelAnimationFrame","addEventListener","defineEB","createGalaxy","makePsiEmitter","delta","updatePlanets","updateStructures","planetMotion","_iterator17","_iteratorNormalCompletion17","_step17","layer","moveSegments","moveBall","emitterParticleCheck","_this8","_this9","starTravelList","makeMapInterface","planetList","App_PlanetButton","structList","App_StructureButton","selectionInfo","App_InfoBox","style","backgroundColor","textAlign","listStyle","padding","margin","minWidth","obj","pauseButton","App_Button","text","sparkleButton","concat","chargeButton","canvasCheck","App_GameCanvas","assign","onMouseDown","onMouseUp","onMouseMove","background","className","App_GUIWrap","lib_default","isOpen","contentLabel","onRequestClose","shouldCloseOnOverlayClick","content","maxWidth","fontColor","App_ButtonBlock","App_StatsDisplay","App_Controls","fontSize","alignSelf","borderRadius","Component","GUIWrap","_ref2","children","StatsDisplay","_ref3","transitionDuration","InfoBox","_ref4","toFixed","Controls","_ref5","ButtonBlock","_ref6","Button","_ref7","StarButton","_ref8","PlanetButton","_ref9","StructureButton","_ref10","orbitX","orbitY","rot","seed","scale","rstate","rng","int32","rngstate","ox","xPar","yPar","pfdist","rotateDeg","pf","per","aph","speedWarp","force","fade","acos","cos","sin","el","abs","numSeg","gap","rand","arg","_ref11","_ref11$numSeg","_ref11$gap","_ref11$radius","_ref11$speed","_ref11$origin","_ref11$width","_ref11$hue","_ref11$name","_ref11$arg","r","segment","phase","destroyRandom","destroy","destroySegment","_iteratorNormalCompletion18","_didIteratorError18","_iteratorError18","_step18","_iterator18","int","GameCanvas","_this10","zones","saveContext","psiLevel","emitterList","canvas","protonCanvas","ctx","getContext","createProton","_this11","clickEmitter","createClickEmitter","renderer","CanvasRenderer","onParticleUpdate","globalAlpha","beginPath","strokeStyle","lineWidth","moveTo","old","lineTo","closePath","stroke","addRenderer","pointAttraction","addEmitter","updateWorld","emit","psiEmission","drawStructures","_iteratorNormalCompletion19","_didIteratorError19","_iteratorError19","_step19","_iterator19","drawConnect","drawPlanet","drawBall","drawScore","mouseInput","_iteratorNormalCompletion20","_didIteratorError20","_iteratorError20","_step20","_iterator20","reset","clickEmission","_iteratorNormalCompletion21","_didIteratorError21","_iteratorError21","_step21","_iterator21","emitDirection","verticalAngleDeg","updateEmitters","_iteratorNormalCompletion22","_didIteratorError22","_iteratorError22","_step22","_iterator22","_iteratorNormalCompletion23","_didIteratorError23","_iteratorError23","_step23","_iterator23","removeEmitter","setLineDash","lineDashOffset","shadowBlur","shadowColor","score","fillStyle","font","fillText","blur","arc","fill","ellipse","_iteratorNormalCompletion24","_didIteratorError24","_iteratorError24","_step24","_iterator24","_iteratorNormalCompletion25","_didIteratorError25","_iteratorError25","_step25","_iterator25","drawSegment","App_PureCanvas","contextRef","React","PureCanvas","_this12","ref","node","ErrorBoundary","_this13","hasError","error","info","whiteSpace","componentStack","App","App_ErrorBoundary","App_OrbitGame","Boolean","location","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.7603298b.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport styled from 'styled-components';\nimport Modal from 'react-modal';\n// import TweenMax from \"gsap/TweenMax\";\nimport _ from 'lodash';\nimport seedrandom from 'seedrandom';\nimport Proton from 'proton-js';\nimport Victor from 'victor';\nimport './App.css';\n\n//global constants\nModal.setAppElement('#root')\nconst fps = 60;\nconst animInterval = 1000/fps;\nconst KEY = {\n  LEFT:  37,\n  RIGHT: 39,\n  UP: 38,\n  DOWN: 40,\n  A: 65,\n  D: 68,\n  W: 87,\n  S: 83,\n  SPACE: 32\n};\n\n//various utility\nfunction objectDistance(b1={x:0,y:0}, b2={x:0,y:0}) {\n  let v1 = new Victor(b1.x,b1.y);\n  let v2 = new Victor(b2.x,b2.y);\n  return v1.distance(v2);\n  // if (b1&&b2) {\n  //   return Math.sqrt(Math.pow(b1.x-b2.x, 2) + Math.pow(b1.y-b2.y, 2));\n  // }\n}\n\nfunction towardsBody(origin, target) {\n  //makes a vector to follow\n  if (origin&&target) {\n    let tx = (origin.x - target.x) / objectDistance(origin, target);\n    let ty = (origin.y - target.y) / objectDistance(origin, target);\n    return { x: tx, y: ty };\n  }\n}\n\n// function getBearing(originX, originY, targetX, targetY) {\n//   return -Math.atan2(targetY-originY, targetX-originX) *360/(Math.PI*2);\n// }\n\nfunction shadeColor(color, rShade, gShade=rShade, bShade=rShade) {\n  var R = parseInt(color.substring(1,3),16);\n  var G = parseInt(color.substring(3,5),16);\n  var B = parseInt(color.substring(5,7),16);\n  R = parseInt(R * (100 + rShade) / 100);\n  G = parseInt(G * (100 + gShade) / 100);\n  B = parseInt(B * (100 + bShade) / 100);\n  R = (R<255)?R:255;\n  G = (G<255)?G:255;\n  B = (B<255)?B:255;\n  var RR = ((R.toString(16).length===1)?\"0\"+R.toString(16):R.toString(16));\n  var GG = ((G.toString(16).length===1)?\"0\"+G.toString(16):G.toString(16));\n  var BB = ((B.toString(16).length===1)?\"0\"+B.toString(16):B.toString(16));\n  return \"#\"+RR+GG+BB;\n}\n\nclass OrbitGame extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      screen: {\n        width: this.props.width,\n        height: this.props.height,\n        // dynWidth: window.innerWidth/2,\n        // dynHeight: window.innerHeight/2,\n        ratio: window.devicePixelRatio || 1,\n      },\n      starList: [\n        {name:\"Lalande\",num:5},{name:\"Tau Ceti\",num:4},{name:\"Groombridge\",num:2},{name:\"Alpha Centauri\",num:4},{name:\"Epsilon Eriadni\",num:7},{name:\"Procyon A\",num:0},{name:\"Procyon B\",num:1},{name:\"Ross 154\",num:3},{name:\"Barnard's Star\",num:8}\n      ],\n      world: {\n        stage: \"Sol\",\n        bodies: [],\n        pendingBodies: [],\n        //will externalize db stuff\n        bDatabase: {\n          Sol: [\n            {data: solData, parent: 0, index: 0, active: true},\n            {data: marsData, parent: 0, index: 1, active: true},\n            {data: venusData, parent: 0, index: 2, active: true},\n            {data: phobosData, parent: 1, index: 3, active: true},\n            {data: earthData, parent: 0, index: 4, active: true},\n            {data: saturnData, parent: 0, index: 5, active: false},\n          ],\n          // AlphaCentauri: [],\n          // Wolf359: [],\n          // EpsilonEridani: [],\n        },\n        structures: [],\n        pendingStructures: [\n\n        ],\n        sDatabase: {\n          Sol: [\n            {data: rs1, openings: 1, index: 0, active: true},\n            {data: rs2, openings: 4, index: 1, active: true},\n            {data: rs3, openings: 0, index: 2, active: true},\n            {data: rs4, openings: 8, index: 3, active: false},\n          ]\n        }\n      },\n      params: {\n        gravFalloff: 0.9,\n        bounceDampening: 0.9,\n      },\n      ball: {\n        x: 190,\n        y: 210,\n        vx: 0.5,\n        vy: 0.5,\n        size: 6,\n        mass: 3,\n        speed: 0,\n        thrustAcc: 0.1,\n        heading: 0,\n        power: 0,\n        coll: false,\n        ct: 0,\n        color: \"#E0EDFF\",\n        glow: 1,\n      },\n      resources: {\n        matter: 0,\n        energy: 1500,\n        psi: 0,\n        hm: 0,\n      },\n      keys: {\n        left  : 0,\n        right : 0,\n        up    : 0,\n        down  : 0,\n        space : 0,\n      },\n      proton: {\n\n      },\n      mousedown: false,\n      mouseTick: 0,\n      mouseReleased: false,\n      mouseObj: {\n        x: 350,\n        y: 350,\n        init: false,\n      },\n      selectedObj: null,\n      tick: 0,\n      ts: 0,\n      randomHash: 0,\n      currentScore: 0,\n      inGame: true,\n      showModal: false,\n    };\n    this.sharedEB = [];\n    this.animationID = null;\n    this.timerID = null;\n    this.handlePowerChange = this.handlePowerChange.bind(this);\n    this.handleChargePsi = this.handleChargePsi.bind(this);\n    this.handleSystemChange = this.handleSystemChange.bind(this);\n    this.handleCanvasClick = this.handleCanvasClick.bind(this);\n    this.handlePlanetToggle = this.handlePlanetToggle.bind(this);\n    this.handleStructureToggle = this.handleStructureToggle.bind(this);\n    this.handlePauseStart=this.handlePauseStart.bind(this);\n    this.handleKeys=this.handleKeys.bind(this);\n    this.mouseupHandler = this.mouseupHandler.bind(this);\n    this.mousedownHandler = this.mousedownHandler.bind(this);\n    this.mousemoveHandler = this.mousemoveHandler.bind(this);\n    this.handleOpenModal = this.handleOpenModal.bind(this);\n    this.handleCloseModal = this.handleCloseModal.bind(this);\n  }\n\n  //user interface\n  makeMapInterface(ui) {\n    const starList = [...this.state.starList];\n    starList.push({name:'Sol',num:6})\n    return starList.map(\n      (star) =>\n      <StarButton onClick={this.handleSystemChange} star={star.name} ui={ui} />\n    )\n  }\n\n  selectOnCanvas() {\n    // let _x = this.state.mouseObj.x;\n    // let _y = this.state.mouseObj.y;\n    let mouse = {...this.state.mouseObj}\n    const bodies = [...this.state.world.bodies];\n    for (let body of bodies) {\n      if (objectDistance(mouse, body) < body.size+6) {\n        console.log(body.name)\n        return this.setState((prevState) => {\n          return {\n            selectedObj: body,\n          }\n        });\n      }\n    }\n  }\n\n  //handlers\n  handlePowerChange() {\n    this.setState((prevState) => {\n      return {\n        currentScore: 0,\n        resources: {\n          ...prevState.resources,\n          energy: prevState.resources.energy + prevState.currentScore*10,\n        },\n      }\n    });\n  }\n\n  handleCanvasClick(e) {\n\n  }\n\n  handleChargePsi() {\n    this.setState((prevState) => {\n      return {\n        resources: {\n          ...prevState.resources,\n          psi: prevState.resources.psi+1,\n        },\n      }\n    });\n    // this.emitterParticleCheck(this.state.proton.psiEmitter,this.state.world.bodies[0],8);\n  }\n\n  handleKeys(value, e) {\n    let keys = {...this.state.keys};\n    if(e.keyCode === KEY.LEFT   || e.keyCode === KEY.A) { keys.left  = value?keys.left+1:0 }\n    if(e.keyCode === KEY.DOWN   || e.keyCode === KEY.S) { keys.down  = value?keys.down+1:0 }\n    if(e.keyCode === KEY.RIGHT  || e.keyCode === KEY.D) { keys.right = value?keys.right+1:0 }\n    if(e.keyCode === KEY.UP     || e.keyCode === KEY.W) { keys.up    = value?keys.up+1:0 }\n    if(e.keyCode === KEY.SPACE) keys.space = value?keys.space+0:0;\n    this.setState((prevState) => {\n      return { keys: keys }\n    });\n  }\n\n  mousedownHandler(e) {\n    // this.setState((prevState) => {\n    //   return {\n    //     mousedown: true,\n    //   }\n    // });\n    // this.mousemoveHandler(e);\n    let _x = e.nativeEvent.layerX;\n    let _y = e.nativeEvent.layerY;\n    // console.log(_x, _y)\n   this.setState((prevState) => {\n      return {\n        mousedown: true,\n        mouseObj: {\n          x: _x,\n          y: _y,\n        },\n      }\n    });\n    this.selectOnCanvas();\n  }\n\n  mouseupHandler(e) {\n    this.setState((prevState) => {\n      return { mousedown: false }\n    });\n  }\n\n  mousemoveHandler(e) {\n    if (this.state.mousedown) {\n      let _x = e.nativeEvent.layerX;\n      let _y = e.nativeEvent.layerY;\n      return this.setState((prevState) => {\n        return {\n          mouseObj: {\n            x: _x,\n            y: _y,\n          },\n        }\n      });\n    }\n  }\n\n  handleOpenModal () {\n    this.setState({ showModal: true });\n  }\n  handleCloseModal () {\n    this.setState({ showModal: false });\n  }\n  handleSystemChange(e) {\n    let target = e.target.id;\n    return this.systemChange(target);\n  }\n  handlePlanetToggle(e) {\n    let p = e.target.id;\n    this.planetToggle(p);\n  }\n  handleStructureToggle(e) {\n    let s = e.target.id;\n    this.structureToggle(s);\n  }\n\n\n  //generating stuff\n  async generateSystem(name=\"Alpha Centauri\", num=3) {\n    const bDatabase = {...this.state.world.bDatabase};\n    if (!bDatabase[name]) {\n      let system = [];\n      let rngData = rngBody(name, \"star\");\n      let star = {data: {...rngData}, index: 0, parent: 0, active: false}\n      system.push(star);\n      for (let i=1;i<num+1;i++) {\n        let parent = Math.floor(seedrandom(i.toString()).quick()*(i/num)*4);\n        let rngData = rngBody(name+\" \"+i.toString(), \"planet\", 1/(parent/2+1));\n        //smaller scale for outlying moons\n        // console.log(rngData);\n        let planet = {data: {...rngData}, index: i, parent: parent, active: false};\n        system.push(planet);\n      }\n      // console.log(system);\n      return system;\n    }\n    else { return null }\n  }\n\n  async genSysStructures(name=\"Alpha Centauri\", num=4) {\n    const sDatabase = {...this.state.world.sDatabase};\n    if (!sDatabase[name]) {\n      let sysStruct = [];\n\n      for (let i=0;i<num;i++) {\n        // let parent = Math.floor(seedrandom(i.toString()).quick()*(i/num)*4);\n        let rngData = rngStruct(name+\" \"+i.toString());\n        //smaller scale for outlying moons\n        // console.log(rngData);\n        let struct = {data: {...rngData}, index: i, openings: 1, active: false};\n        // console.log(struct);\n        sysStruct.push(struct);\n      }\n      // console.log(system);\n      return sysStruct;\n    }\n    else { return null }\n  }\n\n  async createGalaxy(starlist=[{name:\"Wolf 359\",num:6},{name:\"Tau Ceti\",num:4},{name:\"Groombridge\",num:1}]) {\n    console.log(starlist)\n    const bDatabase = {...this.state.world.bDatabase};\n    const sDatabase = {...this.state.world.sDatabase};\n    for (let n of starlist) {\n      let system = await this.generateSystem(n.name,n.num);\n      let sysStruct = await this.genSysStructures(n.name,3);\n      bDatabase[n.name] = system;\n      sDatabase[n.name] = sysStruct;\n    }\n    console.log(bDatabase);\n    console.log(sDatabase);\n\n    return this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          bDatabase: bDatabase,\n          sDatabase: sDatabase,\n        }\n      }\n    });\n  }\n\n  loadStagePlanets(stage) {\n    const pending = [];\n    const bDatabase = {...this.state.world.bDatabase};\n    const db = bDatabase[stage];\n    // const [dbstar, ...dbplanets] = db;\n    const dbplanets = db.slice(1);\n    //the active check doesn't fit the rest of the logic, gotta change something\n    if (dbplanets) {\n      for (let planet of dbplanets) {\n        if (planet.active&&db[planet.parent].active) {\n          pending.push(planet);\n        }\n      };\n    }\n    this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          pendingBodies: pending,\n          stage: stage,\n        }\n      }\n    });\n  }\n\n  loadStageStructures(stage) {\n    const pending = [];\n    const sDatabase = {...this.state.world.sDatabase};\n    const db = sDatabase[stage];\n    if (db) {\n      for (let struct of db) {\n        // console.log(struct)\n        if (struct.active) {\n          pending.push(struct);\n        }\n      };\n    }\n    this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          structures: [],\n          pendingStructures: pending,\n        }\n      }\n    });\n  }\n\n  async loadStage(stage=\"Sol\") {\n    await this.createPrimary(this.state.world.bDatabase[stage][0].data);\n    this.loadStagePlanets(stage);\n    this.loadStageStructures(stage);\n    this.addCoreEmitter();\n    return this.continueGame();\n  }\n\n  //moving around the galaxy\n  systemChange(target) {\n    const currStage = this.state.world.stage;\n    const bDatabase = {...this.state.world.bDatabase};\n    const sDatabase = {...this.state.world.sDatabase};\n    const bdb = bDatabase[currStage];\n    const sdb = sDatabase[currStage];\n    const bdb2 = bDatabase[target];\n    const sdb2 = sDatabase[target];\n    for (let b of bdb) {\n      b.active = false;\n    }\n    if (sdb) {\n      for (let s of sdb) {\n        s.active = false;\n      }\n    }\n    for (let b of bdb2) {\n      b.active = true;\n    }\n    if (sdb2) {\n      for (let s of sdb2) {\n        s.active = true;\n      }\n    }\n    this.setState((prevState) => {\n      return {\n        // inGame: 'loading',\n        world: {\n          ...prevState.world,\n          bDatabase: bDatabase,\n          sDatabase: sDatabase,\n        },\n        ball: {\n          ...prevState.ball,\n          x: prevState.screen.width/4,\n          y: prevState.screen.height/3\n        }\n      }\n    });\n    this.loadStage(target);\n    // console.log(target);\n    // console.log(this.state.inGame);\n  }\n\n  async createPrimary(data) {\n    const star = new Body(data);\n    star.index = 0;\n    const bodies = [];\n    bodies.push(star);\n    return this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          bodies: bodies,\n          stage: data.name,\n        }\n      }\n    });\n  }\n\n  //planet and star make/toggle\n  createPlanet(data=null,parent=0,index=this.state.world.bodies.length,em=null) {\n    const bodies = [...this.state.world.bodies];\n    // console.log(data);\n    bodies[index] = new Body(data,bodies[parent]);\n    bodies[index].index = index;\n    bodies[index].emitter = this.createNewEmitter(em);\n    this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          bodies: bodies,\n        }\n      }\n    });\n  }\n\n  updatePlanets() {\n    const pending = [...this.state.world.pendingBodies];\n    for (let i=0;i<pending.length;i++) {\n      let p = pending.splice(0,1)[0];\n      if (!p.em) {\n        p.em = { target: p.index, e: 600, color1: shadeColor(p.data.hue,80), rate1: 6, rate2: 1.5, velocity: 1.5, damp: 0.007, life: 7, mass: 5 };\n      }\n      this.createPlanet(p.data,p.parent,p.index,p.em||null);\n    }\n    this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          pendingBodies: pending,\n        }\n      }\n    });\n  }\n\n  planetToggle(p) {\n    // let p = e.target.id;\n    const bodies = [...this.state.world.bodies];\n    // const [star, ...planets] = bodies;\n    const planets = bodies.slice(1);\n    const stage = this.state.world.stage;\n    const bDatabase = {...this.state.world.bDatabase};\n    const db = bDatabase[stage];\n    const target = db.find( b => b.data.name === p );\n    if (!target.active&&bodies[target.parent]) {\n      db[target.index].active = true;\n      const pending = [...this.state.world.pendingBodies];\n      pending.push(target);\n      this.setState((prevState) => {\n        return {\n          world: {\n            ...prevState.world,\n            pendingBodies: pending,\n            bDatabase: bDatabase\n          }\n        }\n      });\n    }\n    else if (target.active) {\n      //disables any active children. but the star is exempt even if it's its own parent by default\n      for (let body of planets) {\n        if (body&&body.parent===bodies[target.index]) {\n          let i = body.index;\n          db[i].active = false;\n          bodies[i] = null;\n        }\n      }\n      db[target.index].active = false;\n      bodies[target.index] = null;\n      this.setState((prevState) => {\n        return {\n          world: {\n            ...prevState.world,\n            bodies: bodies,\n            bDatabase: bDatabase,\n          }\n        }\n      });\n    }\n  }\n\n  //structure make/toggle\n  createStructure(data=null,openings=0,index=this.state.world.structures.length) {\n    const structures = [...this.state.world.structures];\n    structures[index] = new ringStructure(data);\n    structures[index].addSegments(openings);\n    structures[index].index = index;\n    // console.log(structures[index])\n    this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          structures: structures,\n        }\n      }\n    });\n  }\n\n  updateStructures() {\n    const ps = [...this.state.world.pendingStructures];\n    const structures = [...this.state.world.structures];\n    for (let i=0;i<ps.length;i++) {\n      let p = ps.splice(0,1)[0];\n      // console.log(p.data)\n      // this.createStructure(p.data,p.openings,p.index);\n      structures[p.index] = new ringStructure(p.data);\n      structures[p.index].addSegments(p.openings);\n      structures[p.index].index = p.index;\n    }\n    // console.log(structures)\n    this.setState((prevState) => {\n      return {\n        world: {\n          ...prevState.world,\n          structures: structures,\n          pendingStructures: ps,\n        }\n      }\n    });\n  }\n\n  structureToggle(s) {\n    const structures = [...this.state.world.structures];\n    const stage = this.state.world.stage;\n    const sDatabase = {...this.state.world.sDatabase};\n    const db = sDatabase[stage];\n    const target = db.find( struct => struct.data.name === s );\n    // console.log(structures)\n    if (!target.active) {\n      db[target.index].active = true;\n      const pending = [...this.state.world.pendingStructures];\n      pending.push(target);\n      this.setState((prevState) => {\n        return {\n          world: {\n            ...prevState.world,\n            pendingStructures: pending,\n            sDatabase: sDatabase,\n          }\n        }\n      });\n    } else if (target.active) {\n      db[target.index].active = false;\n      structures[target.index] = null;\n      this.setState((prevState) => {\n        return {\n          world: {\n            ...prevState.world,\n            structures: structures,\n            sDatabase: sDatabase,\n          }\n        }\n      });\n    }\n  }\n\n  //proton stuff\n  defineEB() {\n    // let mouseAttract = new Proton.Attraction(this.state.mouseObj, 5, 200);\n    this.sharedEB.borderZoneBehaviour = new Proton.CrossZone(new Proton.RectZone(0, 0, this.state.screen.width, this.state.screen.height), 'bound');\n    this.sharedEB.randomBehaviour = new Proton.RandomDrift(5, 5, .05);\n    const centerZone = this.state.world.bodies[0]?{\n      x: this.state.world.bodies[0].x,\n      y: this.state.world.bodies[0].y,\n    }:{\n      x: 350,\n      y: 350,\n    }\n    // console.log(centerZone);\n    this.sharedEB.centerBehaviour = new Proton.Repulsion(centerZone, 30, this.state.world.bodies[0]?this.state.world.bodies[0].size*2:30)\n    // return this.sharedEB.push(borderZoneBehaviour,randomBehaviour,centerBehaviour)\n    return this.sharedEB\n  }\n\n  createNewEmitter({target=null, color1=null, color2=null, mass=5, radius=1, velocity=2.5, rate1=20, rate2=0.5, damp=0.005, e='once', life=5, planetAttraction=true, x=350, y=350, a=0, b=360}={}, special=false) {\n    let emitter = new Proton.Emitter();\n\n\n    emitter.e = e;\n    emitter.damping = damp;\n    emitter.rate = new Proton.Rate(new Proton.Span(rate1, rate1*1.5), rate2);\n    emitter.addInitialize(emitter.rate);\n    emitter.addInitialize(new Proton.Mass(mass));\n    emitter.addInitialize(new Proton.Radius(radius));\n    if (life) { emitter.addInitialize(new Proton.Life(life)) }\n    emitter.currVelocity = new Proton.Velocity(new Proton.Span(velocity, velocity*1.5), new Proton.Span(a, b), 'polar');\n    emitter.addInitialize(emitter.currVelocity);\n    let c = color1?(new Proton.Color(color1, color2||color1)):(new Proton.Color('random'));\n    emitter.addBehaviour(c);\n    // let borderZoneBehaviour = new Proton.CrossZone(new Proton.RectZone(0, 0, this.state.screen.width, this.state.screen.height), 'bound');\n    if (this.sharedEB.borderZoneBehaviour) { emitter.addBehaviour(this.sharedEB.borderZoneBehaviour) }\n    // let randomBehaviour = new Proton.RandomDrift(5, 5, .05);\n    // emitter.addBehaviour(randomBehaviour);\n    if (this.sharedEB.randomBehaviour) { emitter.addBehaviour(this.sharedEB.randomBehaviour) }\n    // let rect = new Proton.RectZone(this.state.screen.width/2,this.state.screen.height/2,this.state.world.bodies[0].size);\n    // let centerZone = {\n    //   x: this.state.world.bodies[0].x||350,\n    //   y: this.state.world.bodies[0].y||350,\n    // }\n    // let centerBehaviour = new Proton.Repulsion(centerZone, 30, this.state.world.bodies[0].size*2)\n    // emitter.addBehaviour(centerBehaviour);\n    if (this.sharedEB.centerBehaviour) { emitter.addBehaviour(this.sharedEB.centerBehaviour) }\n    if (special==='core') {\n      emitter.coreAttraction = new Proton.Attraction(this.state.world.bodies[0], 10, 500);\n      emitter.addBehaviour(emitter.coreAttraction);\n    } else if (special==='psi') {\n      emitter.planetAttraction = new Proton.Attraction(this.state.world.bDatabase[this.state.world.stage][target].data, 10, 500);\n      emitter.addBehaviour(emitter.planetAttraction);\n    } else if (planetAttraction&&target!==null) {\n      emitter.planetAttraction = new Proton.Attraction(this.state.world.bDatabase[this.state.world.stage][target].data, 10, 500);\n      emitter.addBehaviour(emitter.planetAttraction);\n    }\n    emitter.target = target||0;\n    if (target) {\n      //proper initialization TBD\n      emitter.mouseAttract = new Proton.Attraction(this.state.mouseObj, 5, 200);\n      emitter.addBehaviour(emitter.mouseAttract);\n      // emitter.p.x = this.state.screen.width/2;\n      // emitter.p.y = this.state.screen.width/2;\n      emitter.p.x = x;\n      emitter.p.y = y;\n    };\n    if (!target) {\n      emitter.mouseAttract = new Proton.Attraction(this.state.mouseObj, 5, 200);\n      emitter.addBehaviour(emitter.mouseAttract);\n      emitter.p.x = x;\n      emitter.p.y = y;\n    };\n    // console.log(emitter.behaviours);\n    return emitter;\n  }\n\n  makePsiEmitter() {\n    this.setState((prevState) => {\n      return {\n        proton: {\n          ...prevState.proton,\n          psiEmitter: this.createNewEmitter({ e: 'once', color1: '#6699FF', color2: '#FFDDFF', rate1: 50, rate2: 0.01, velocity: 1, mass: 8, radius: 1, damp: 0.009, life: (1,5), special:'psi'}),\n        }\n      }\n    });\n  }\n\n  addCoreEmitter() {\n    this.setState((prevState) => {\n      return {\n        proton: {\n          ...prevState.proton,\n          coreEmitter: this.createNewEmitter({target:0, special:'core', e: 2, color1: shadeColor(this.state.world.bodies[0].hue,40,-10,-10), rate1: 6, rate2: 0.6, velocity: 1.8, damp: 0.014, life: 20, mass: 15, radius: 4, planetAttraction: true, a:_.random(-330,-30)+30, b:_.random(30,330)-30 }),\n        }\n      }\n    });\n  }\n\n  emitterParticleCheck(emitter=this.state.proton.psiEmitter,target=this.state.world.bodies[0],sample=16) {\n    let length = emitter.particles.length;\n    let centerBehaviour = new Proton.Repulsion(this.state.world.bodies[0], 50, this.state.world.bodies[0].size*15)\n    if (length>sample) {\n      for (let i=0;i<(length/sample)-1;i++) {\n        let particle = emitter.particles[length-(i*sample+1)];\n        // console.log(particle);\n        if (!particle.dead&&(objectDistance(particle.p,target)<target.size*5)) {\n\n          // let repulsion = particle.behaviours.find( b => b.name === \"Repulsion\" );\n          // repulsion.reset(this.state.world.bodies[0], 100, 100)\n          // let color = particle.behaviours.find( b => b.name === \"Color\" );\n          // let solar = particle.behaviours.find( b => b.name === \"Attraction\" && (b.targetPosition instanceof Body) );\n          // particle.removeBehaviour(solar);\n          // particle.removeBehaviour(color)\n          // particle.removeAllBehaviours();\n          particle.addBehaviour(new Proton.Color('#39F654', '#49FF88'))\n          particle.mass*=2;\n          particle.energy*=3;\n\n          particle.addBehaviour(centerBehaviour)\n          this.setState((prevState) => {\n            return {\n              resources: {\n                ...prevState.resources,\n                matter: prevState.resources.matter+1,\n              }\n            }\n          });\n        }\n      }\n    }\n  }\n\n  //motion stuff\n  thrustInput() {\n    let tx = 0;\n    let ty = 0;\n    if (this.state.keys.up) {\n      ty -= this.state.ball.thrustAcc*Math.pow(this.state.keys.up, 0.5);\n    }\n    if (this.state.keys.down) {\n      ty += this.state.ball.thrustAcc*Math.pow(this.state.keys.down, 0.25);\n    }\n    if (this.state.keys.left) {\n      tx -= this.state.ball.thrustAcc*Math.pow(this.state.keys.left, 0.25);\n    }\n    if (this.state.keys.right) {\n      tx += this.state.ball.thrustAcc*Math.pow(this.state.keys.right, 0.25);\n    }\n    if (tx||ty) {\n      // this.setState((prevState) => {\n      //   return {\n      //     ball: {\n      //       ...prevState.ball,\n      //       vx: prevState.ball.vx + tx,\n      //       vy: prevState.ball.vy + ty,\n      //     }\n      //   }\n      // })\n    }\n    return [tx, ty]\n  }\n\n  borderCollision(object) {\n    const bounce = this.state.params.bounceDampening*0.7;\n    const width = this.state.screen.width\n    const height = this.state.screen.height\n    if (object.x+object.vx > width - object.size || object.x+object.vx < object.size) {\n      if (object.x+object.vx<width/-10||object.x+object.vx>width*1.1) {\n        //return from OOB\n        console.log('OOB X')\n        this.setState((prevState) => {\n          return {\n            ball: {\n              ...prevState.ball,\n              x: (object.x+object.vx)>0?width*Math.sqrt(bounce):width/5*(1+bounce/5),\n              y: (object.y+object.vy)>0?height*Math.sqrt(bounce):height/5*(1+bounce/5),\n              vx: prevState.vx*0.05,\n              vy: prevState.vy*0.05,\n            }\n          }\n        });\n      }\n      // else {\n        //normal bounce\n        // this.setState((prevState) => {\n        //   return {\n        //     ball: {\n        //       ...prevState.ball,\n        //       x: prevState.ball.x -prevState.ball.vx*bounce*2,\n        //       y: prevState.ball.y -prevState.ball.vy*bounce*2,\n        //     }\n        //   }\n        // });\n      // }\n      return [-1, 1]\n    }\n    if (object.y+object.vy > height - object.size || object.y+object.vy < object.size) {\n      if (object.y+object.vy<height/-10||object.y+object.vy>height*1.1) {\n        //return from OOB\n        console.log('OOB Y')\n        this.setState((prevState) => {\n          return {\n            ball: {\n              ...prevState.ball,\n              x: (object.x+object.vx)>0?width*Math.sqrt(bounce):width/5*(1+bounce/5),\n              y: (object.y+object.vy)>0?height*Math.sqrt(bounce):height/5*(1+bounce/5),\n              vx: prevState.vx*0.05,\n              vy: prevState.vy*0.05,\n            }\n          }\n        });\n      }\n      // else {\n        //normal bounce\n        // this.setState((prevState) => {\n        //   return {\n        //     ball: {\n        //       ...prevState.ball,\n        //       x: prevState.ball.x -prevState.ball.vx*bounce*2,\n        //       y: prevState.ball.y -prevState.ball.vy*bounce*2,\n        //     }\n        //   }\n        // });\n      // }\n      return [1, -1]\n    }\n    return [1, 1]\n  }\n\n  ballGravPull(object, targets) {\n    let gx = 0;\n    let gy = 0;\n    for (let body of targets) {\n      if (body) {\n        let dist = objectDistance(object, body);\n        gx += body.mass*towardsBody(object, body).x/Math.pow(dist * this.state.params.gravFalloff, 2);\n        gy += body.mass*towardsBody(object, body).y/Math.pow(dist * this.state.params.gravFalloff, 2);\n      }\n    }\n    // this.setState((prevState) => {\n    //   return {\n    //     ball: {\n    //       ...prevState.ball,\n    //       vx: prevState.ball.vx - gx,\n    //       vy: prevState.ball.vy - gy,\n    //     }\n    //   }\n    // })\n    return [-gx, -gy]\n  }\n\n  structCollisionCheck() {\n    let ball = this.state.ball;\n    let angle = (Victor(ball.x-this.props.width/2, ball.y-this.props.height/2).horizontalAngle()+Math.PI*2)%(Math.PI*2);\n    // let coll = false;\n    let structures = [...this.state.world.structures]\n    for (let struct of this.state.world.structures) {\n      if (struct && objectDistance(ball,struct.origin) > struct.radius-struct.width/2-ball.size && objectDistance(ball,struct.origin) < struct.radius+struct.width/2+ball.size) {\n        let arcLength = (((struct.segments[0].bc-struct.segments[0].ac)*struct.dir+Math.PI*3)%(Math.PI*2)-Math.PI);\n        for (let seg of struct.segments) {\n          let angleDiff = struct.speed>0?\n          ((angle-seg.ac)+Math.PI*3)%(Math.PI*2)-Math.PI:\n          (-(angle+seg.bc)+Math.PI*3)%(Math.PI*2)-Math.PI;\n          if (seg.health>0&&((angleDiff>0&&angleDiff<arcLength)||(angleDiff<0&&angleDiff>Math.PI-arcLength))) {\n            // console.log(struct);\n            // console.log('hit');\n            seg.health--;\n            if (seg.health===0) {\n              seg.health = -6;\n              console.log('segment disabled!')\n            }\n            return this.structCollState(struct.index);\n          }\n        }\n      }\n    }\n    //still run it to reset state if needed\n    return this.structCollState(false);\n  }\n\n  structCollState(coll) {\n    const bounce = this.state.params.bounceDampening*0.8;\n    if (coll!==false) {\n      //collision continues, increment tick:\n      if (this.state.ball.coll!==false) {\n        if (this.state.tick%3===0) {\n        this.setState((prevState) => {\n          return {\n            ball: {\n              ...prevState.ball,\n              ct: prevState.ball.ct+1,\n            }\n          }\n        })\n        return  [1*(1+this.state.ball.ct/10)*bounce,1*(1+this.state.ball.ct/10)*bounce]\n        }\n        return [1, 1]\n      } else {\n        //collision begins:\n        this.setState((prevState) => {\n          return {\n            ball: {\n              ...prevState.ball,\n              coll: coll,\n              ct: 1,\n            }\n          }\n        })\n        return [-1*bounce,-1*bounce]\n      }\n    }\n    //\"NO COLLISION! Fake News!\" - Donald J. Trump\n    else {\n      if (this.state.ball.coll!==false) {\n        this.setState((prevState) => {\n          return {\n            ball: {\n              ...prevState.ball,\n              coll: false,\n              ct: 0,\n            }\n          }\n        })\n      }\n      return [1, 1]\n    }\n  }\n\n  planetMotion() {\n    const bodies = [...this.state.world.bodies];\n    //apply a pulling force, costs energy\n    if (this.state.mousedown && this.state.resources.energy > 0 && this.state.mouseTick%2===0) {\n      for (let planet of bodies) {\n        if (planet) {\n          planet.getsPulled(9, this.state.mouseObj, this.state.mouseTick)\n        }\n      }\n      this.setState((prevState) => {\n        return {\n          resources: {\n            ...prevState.resources,\n            energy: prevState.resources.energy-1,\n          }\n        }\n      })\n    };\n    //normal motion\n    for (let planet of bodies) {\n      if (planet) {\n        //normal motion first\n        if (planet.speed!==0&&planet.type!=='star') {\n          planet.movePlanet();\n        }\n        let otherBodies = bodies.filter(item => item !== planet);\n        for (let body of otherBodies) {\n          if (body) {\n            //have to think about handling it better\n            if (objectDistance(planet, body)*0.95 < body.size + planet.size) {\n              return this.planetCollision(planet, body, 2);\n            }\n          }\n        }\n      }\n    };\n  }\n\n  planetCollision(origin, body, type) {\n    if (type === 1) {\n      const bounce = this.state.params.bounceDampening*0.9;\n      if (objectDistance(origin, body)*0.95 < body.size + origin.size) {\n        this.setState((prevState) => {\n          return {\n            currentScore: prevState.currentScore + 1,\n            // ball: {\n            //   ...prevState.ball,\n              // x: prevState.ball.x-(prevState.ball.vx * bounce*0.5),\n              // y: prevState.ball.y-(prevState.ball.vy * bounce*0.5),\n              // vx: -prevState.ball.vx * this.state.params.bounceDampening,\n              // vy: -prevState.ball.vy * this.state.params.bounceDampening,\n            }\n\n        })\n        return [-1*bounce, -1*bounce]\n      }\n      return [1, 1]\n    } else if (type === 2 && objectDistance(origin, body)*0.96 < body.size + origin.size) {\n      return this.setState((prevState) => {\n        let bodies = [...prevState.world.bodies];\n        let b = bodies[bodies.indexOf(body)];\n        let o = bodies[bodies.indexOf(origin)];\n        if (o.speed) {\n          o.dx += towardsBody(origin, body).x*(o.coll*o.size/8)*(b.mass/o.mass);\n          o.dy += towardsBody(origin, body).y*(o.coll*o.size/8)*(b.mass/o.mass);\n          o.coll += 2;\n        }\n        // if (b.speed) {\n        // TBD\n        // }\n        return {\n          resources: {\n            ...prevState.resources,\n            matter: prevState.resources.matter+1,\n          },\n          bodies: bodies,\n        }\n      });\n    }\n  }\n\n  ballCheckPlanets() {\n    const bodies = this.state.world.bodies;\n    const ball = this.state.ball;\n    let pcx = 0;\n    let pcy = 0;\n    for (let body of bodies) {\n      if (body) {\n        let [cx,cy] = this.planetCollision(ball, body, 1)\n        if (cx!==1||cy!==1) {\n          pcx += cx\n          pcy += cy\n        }\n      }\n    }\n    if (pcx||pcy) {\n      return [pcx,pcy]\n    }\n    return [1,1]\n  }\n\n  moveBall() {\n    const ball = this.state.ball;\n    const bodies = this.state.world.bodies;\n    const bounce = this.state.params.bounceDampening;\n\n    let g = this.ballGravPull(ball, bodies);\n    let t = this.thrustInput();\n\n    let vx = this.state.ball.vx+g[0]+t[0];\n    let vy = this.state.ball.vy+g[1]+t[1];\n\n    let bc = this.borderCollision(ball);\n    if (bc[0]!==1||bc[1]!==1) {\n      //bounce off borders first\n      vx *= -1*bounce*0.5;\n      vy *= -1*bounce*0.5;\n      return this.setState((prevState) => {\n        return {\n          ball: {\n            ...prevState.ball,\n            x: prevState.ball.x + vx*0.5,\n            y: prevState.ball.y + vy*0.5,\n            vx: vx,\n            vy: vy,\n          }\n        }\n      })\n    }\n    else {\n    let sc = this.structCollisionCheck();\n    let pc = this.ballCheckPlanets();\n    // have to fix multiple bounce types, this is so messy\n    if (sc[0]<0&&pc[0]<0) {\n      vx *= -sc[0]*pc[0];\n      vy *= -sc[1]*pc[1];\n    } else {\n    vx *= sc[0]*pc[0];\n    vy *= sc[1]*pc[1];\n    }\n    const speed = objectDistance(ball, {x: vx, y:vy});\n    return this.setState((prevState) => {\n      return {\n        // ...prevState,\n        ball: {\n          ...prevState.ball,\n          // will rewrite this completely\n          x: prevState.ball.x + vx + (prevState.ball.vx/4)*(sc[0]-1)+(prevState.ball.vx/4)*(pc[0]-1),\n          y: prevState.ball.y + vy + (prevState.ball.vy/4)*(sc[1]-1)+(prevState.ball.vy/4)*(pc[0]-1),\n          vx: vx,\n          vy: vy,\n          speed: speed,\n        }\n      }\n    })\n    }\n  }\n\n  handlePauseStart() {\n    if (this.state.inGame === false) {\n      this.continueGame();\n      console.log(\"continue\");\n    } else if (this.state.inGame === true) {\n      this.stopGame();\n      console.log(\"pause\");\n    }\n  }\n\n  //primary logic loop\n  continueGame() {\n    requestAnimationFrame((t) => {this.update(t)});\n    this.setState(() => {\n      return { inGame: true, }\n    });\n  }\n\n  stopGame() {\n    clearInterval(this.timerID);\n    cancelAnimationFrame(this.animationID);\n    this.setState(() => {\n      return { inGame: false, }\n    });\n  }\n\n  //React own methods\n  componentDidMount() {\n    window.addEventListener('keyup',   this.handleKeys.bind(this, false));\n    window.addEventListener('keydown', this.handleKeys.bind(this, true));\n    // window.addEventListener('resize',  this.handleResize.bind(this, false));\n    this.setState(() => {\n      return { inGame: \"loading\", }\n    });\n    this.defineEB();\n    // console.log(this.sharedEB)\n    this.createGalaxy(this.state.starList);\n    this.loadStage(\"Sol\");\n    this.makePsiEmitter();\n  }\n\n  componentWillUnmount() {\n    cancelAnimationFrame(this.animationID);\n  }\n\n  //just testing\n  // async nextFrame(t) {\n  //   return new Promise(resolve => {\n  //     requestAnimationFrame((t) => {this.update(t)})\n  //   })\n  // }\n\n  async update(t) {\n    //animInterval is the framerate setting, only do stuff if it's exceeded\n    let delta = t - this.state.ts;\n    if (delta > animInterval) {\n      this.setState((prevState) => {\n        return {\n          ts: t - (delta % animInterval),\n          tick: prevState.tick + 1,\n          mouseTick: prevState.mousedown ? prevState.mouseTick+1 : 0,\n          mouseReleased: !prevState.mousedown&&prevState.mouseTick>0 ? true : false,\n        }\n      });\n      if (this.state.world.pendingBodies.length>0) {\n        this.updatePlanets();\n      };\n      if (this.state.world.pendingStructures.length>0) {\n        this.updateStructures();\n      };\n      this.planetMotion();\n      for (let layer of this.state.world.structures) {\n        if (layer) {\n          layer.moveSegments();\n        }\n      }\n      this.moveBall();\n      if (this.state.proton.psiEmitter.particles.length>8&&this.state.tick%50===0) {\n        this.emitterParticleCheck(this.state.proton.psiEmitter,this.state.world.bodies[0],4);\n      }\n    }\n    // if (this.state.inGame === \"loading\") {\n    //   console.log(\"loading\")\n    // }\n    if (this.state.inGame === true) {\n      return this.animationID = requestAnimationFrame((t) => {this.update(t)});\n      // return this.animationID = await this.nextFrame(t);\n    }\n  }\n\n  render() {\n    //UI elements\n    const ui = {\n      tick: this.state.tick,\n      ts: this.state.ts,\n      inGame: this.state.inGame,\n      currentScore: this.state.currentScore,\n      stage: this.state.world.stage,\n      ball: this.state.ball,\n      resources: this.state.resources,\n      mousedown: this.mousedown,\n    };\n\n    const stage = this.state.world.stage;\n\n    // const starList = [...this.state.starList];\n    // starList.push({name:'Sol',num:6})\n    // const starTravelList = starList.map(\n    //   (star) =>\n    //   <StarButton onClick={this.handleSystemChange} star={star.name} ui={ui} />\n    // )\n    const starTravelList = this.makeMapInterface(ui);\n\n    const bDatabase = {...this.state.world.bDatabase}\n    const planetList = bDatabase[stage]&&bDatabase[stage].length>0?bDatabase[stage].slice(1).map(\n      (planet) =>\n      <PlanetButton onClick={this.handlePlanetToggle} body={planet}/>\n    ):\n    null;\n    // {planetList}\n    const sDatabase = {...this.state.world.sDatabase}\n    const structList = sDatabase[stage]?sDatabase[stage].map(\n      (struct) =>\n      <StructureButton onClick={this.handleStructureToggle} struct={struct} />\n    ):\n    null;\n    const selectionInfo = this.state.selectedObj?\n    <InfoBox style={{ color: '#05051A', backgroundColor: '#DACFDA', textAlign:'left', listStyle:'none', padding:'0.3em 0.6em',margin:'0.5em auto 0.5em 3em',minWidth:'30%'}} obj={this.state.selectedObj} />:\n    <span style={{minWidth:'30%',margin:'0.5em auto 0.5em 3em'}}>{`Click on an in-system body for an info box`}</span>;\n    const pauseButton = this.state.inGame ?\n    <Button onClick={this.handlePauseStart} style={{ backgroundColor: 'red' }} text=\"Pause\" /> :\n    <Button onClick={this.handlePauseStart} text=\"Continue\" />;\n    const sparkleButton = <Button onClick={this.handleChargePsi} style={{ backgroundColor: '#4666FF' }} text={`Psi blasts: ${this.state.resources.psi}`} />;\n    const chargeButton = <Button onClick={this.handlePowerChange} style={{ backgroundColor: '#E0115F' }} text={`Energy: ${this.state.resources.energy} (click to charge)`} />;\n    const canvasCheck = this.state.world.bodies[0]?\n    <GameCanvas onMouseDown={this.mousedownHandler} onMouseUp={this.mouseupHandler} onMouseMove={this.mousemoveHandler} style={{ background: \"#36454F\" }} {...this.state} />\n    :null;\n\n    return (\n      <div className=\"showcase\">\n      {canvasCheck}\n      <GUIWrap ui={ui}>\n\n      <Modal\n      isOpen={this.state.showModal}\n      contentLabel=\"onRequestClose Example\"\n      onRequestClose={this.handleCloseModal}\n      shouldCloseOnOverlayClick={true}\n      style={{ content: {\n          backgroundColor: '#30405E',\n          maxWidth: '30%'\n        } }}\n      ui={ui}>\n      <h2 style={{fontColor: '#C0C0EE', margin:'0.5em', textAlign:'center'}}>Galaxy map</h2>\n\n      <ButtonBlock ui={ui}>\n        {starTravelList}\n      </ButtonBlock>\n      <button style={{backgroundColor: '#30405E', padding:'0.2em', margin:'2em 0.5em 0.5em'}} onClick={this.handleCloseModal}>Close</button>\n      </Modal>\n      <StatsDisplay ui={ui} />\n      <p>WASD to accelerate</p>\n      <Controls ui={ui}>\n      <ButtonBlock ui={ui}>\n      {pauseButton}{sparkleButton}{chargeButton}\n      </ButtonBlock>\n      <ButtonBlock ui={ui}>\n      {structList}\n      </ButtonBlock>\n      <ButtonBlock ui={ui}>\n        {planetList}\n      </ButtonBlock>\n      </Controls>\n      <Button onClick={this.handleOpenModal} style={{fontSize:'1.3em',alignSelf:'center',backgroundColor: '#30405E', padding:'0.5em',margin:'0.6em auto',borderRadius:'1px'}} text=\"GALAXY MAP\"/>\n      {selectionInfo}\n      </GUIWrap>\n      </div>\n    );\n  };\n};\n\n//interface\nconst GUIWrap = ({ ui, children }) => (\n  <div className=\"game-interface\">\n  {children}\n  </div>\n);\nconst StatsDisplay = ({ ui }) => (\n  <div className=\"interface-element\" style={{fontSize:\"1.1em\",margin:'0.2em auto',width:\"100%\",padding:\"0.1em\",transitionDuration:'0'}}>\n  <p style={{textAlign:'left'}}>{`Stage: ${ui.stage} || Energy: ${ui.resources.energy} || Matter: ${ui.resources.matter} || Psi: ${ui.resources.psi} || Score: ${ui.currentScore}`}</p>\n  </div>\n);\n\nconst InfoBox = ({ style, obj }) => (\n  <section style={style}>\n  <li>\n  <ul>{`Name: ${obj.name}`}</ul>\n  <ul>{`Mass: ${obj.mass}`}</ul>\n  <ul>{`Coordinates: X ${obj.x.toFixed(1)}|| Y ${obj.y.toFixed(1)}`}</ul>\n  <ul>{`Type: ${obj.type}`}</ul>\n  </li>\n  </section>\n);\n\nconst Controls = ({ children }) => (\n  <div className=\"game-controls\" style={{padding:'0.1em',margin:'0.1em'}}>\n  {children}\n  </div>\n);\nconst ButtonBlock = ({ ui, children }) => (\n  <div className=\"interface-element\">\n  {children}\n  </div>\n);\nconst Button = ({ onClick, text, style, id }) => (\n  <button onClick={onClick} type=\"button\" style={style} id={id}>\n  {text}\n  </button>\n);\nconst StarButton = ({ onClick, star, ui }) => (\n  <button onClick={onClick} type=\"button\" style={ui.stage===star?{backgroundColor: '#DD1133'}:{backgroundColor: '#4422EE'}} id={star}>\n  Load system: {star}\n  </button>\n);\nconst PlanetButton = ({onClick, body}) => (\n  <button onClick={onClick} style={{backgroundColor: `${shadeColor(body.data.hue,-20)}`}} id={body.data.name}>Toggle planet: {body.data.name}</button>\n);\nconst StructureButton = ({onClick, struct}) => (\n  <button onClick={onClick} style={{backgroundColor: `${shadeColor(struct.data.hue,-40)}`}} id={struct.data.name}>Toggle structure: {struct.data.name}</button>\n);\n\n//planet data\nconst marsData = {\n  size: 9,\n  orbitX: 200,\n  orbitY: 160,\n  rot: 200,\n  speed: -1.5,\n  mass: 100,\n  hue: \"#ff4336\",\n  glow: 0.8,\n  angle: 0,\n  name: \"Mars\",\n}\n\nconst phobosData = {\n  size: 6,\n  orbitX: 35,\n  orbitY: 32,\n  rot: 100,\n  speed: 1.5,\n  mass: 50,\n  hue: \"#EE1111\",\n  glow: 0.6,\n  angle: 40,\n  name: \"Phobos\",\n}\n\nconst venusData = {\n  size: 12,\n  orbitX: 105,\n  orbitY: 90,\n  rot: 205,\n  speed: 1,\n  mass: 165,\n  hue: \"#00A86B\",\n  glow: 0.8,\n  angle: 10,\n  name: \"Venus\",\n}\n\nconst earthData = {\n  size: 11,\n  orbitX: 155,\n  orbitY: 140,\n  rot: 20,\n  speed: 1,\n  mass: 150,\n  hue: \"#007FFF\",\n  glow: 1.2,\n  angle: 20,\n  name: \"Earth\",\n}\n\nconst solData = {\n  size: 19,\n  orbitX: 0,\n  speed: 0,\n  mass: 220,\n  hue: \"#FFCC33\",\n  glow: 2.5,\n  angle: 0,\n  name: \"Sol\",\n}\n\nconst saturnData = {\n  size: 14,\n  orbitX: 310,\n  speed: 0.5,\n  mass: 190,\n  hue: \"#d9b47d\",\n  glow: 1,\n  angle: 210,\n  name: \"Saturn\",\n}\n\nfunction rngBody(seed, type=\"planet\", scale=1, rstate=false) {\n  let rng = seedrandom(seed, {state: rstate})\n  if (type===\"star\") {\n    return {\n      orbitX: 0,\n      speed: 0,\n      size: Math.floor((rng.quick()*17+10)*scale),\n      mass: Math.floor((rng.quick()*200+60)*scale),\n      hue: \"#\"+((rng.int32().toString(16)).slice(-6)),\n      glow: 1.5,\n      name: seed+\" Primary\",\n      rngstate: rstate?rng.state:null,\n    }\n  }\n  let ox = Math.floor(rng.quick()*300*Math.pow(scale, 0.5));\n  return {\n    orbitX: ox,\n    orbitY: ox-Math.floor(3+rng.quick()*15*Math.pow(scale, 2.5)),\n    rot: Math.floor(330*rng.quick()),\n    angle: Math.floor(330*rng.quick()),\n    speed: +((rng.quick()*1.5+0.3)/scale).toFixed(1),\n    size: Math.floor((rng.quick()*12+4)*Math.pow(scale, 1.25)),\n    mass: Math.floor((rng.quick()*150+40)*scale),\n    hue: shadeColor(\"#\"+((rng.int32().toString(16)).slice(-6)),20),\n    glow: Math.floor(20*rng.quick())/20,\n    name: seed,\n    rngstate: rstate?rng.state:null,\n  }\n}\n\nclass Body {\n  constructor(data, parent=null) {\n    this.data = data;\n    this.parent = parent;\n    this.xPar = this.parent ? this.parent.x : data.xPar||350;\n    this.yPar = this.parent ? this.parent.y : data.yPar||350;\n    this.size = data.size||15;\n    this.orbitX = data.orbitX||0;\n    this.orbitY = data.orbitY||this.orbitX;\n    this.type = data.orbitX>0 ? \"planet\" : \"star\";\n    this.rot = data.rot||0;\n    if (this.orbitX!==this.orbitY) {\n      this.e = Math.sqrt(1 - (Math.pow(this.orbitY, 2)/Math.pow(this.orbitX, 2)));\n      this.pfdist = new Victor(this.orbitX*this.e, 0)\n      this.pfdist.rotateDeg(this.rot);\n      this.pf = {\n        x: this.xPar + this.pfdist.x,\n        y: this.yPar + this.pfdist.y,\n      }\n      this.per = this.orbitX-this.orbitX*this.e;\n      this.aph = this.orbitX+this.orbitX*this.e;\n    }\n    this.speed = data.speed||0;\n    this.speedWarp = 0;\n    this.mass = data.mass||0;\n    this.hue = data.hue||\"#FFFF00\";\n    this.glow = data.glow||0;\n    this.name = data.name||\"Unknown\";\n    this.angle = data.angle||0;\n    this.dir = this.speed>0?1:-1;\n    this.x = this.xPar + this.orbitX;\n    this.y = this.yPar + this.orbitY;\n    this.dx = 0;\n    this.dy = 0;\n    this.coll = 0;\n    console.log(\"creating body: \"+this.name);\n\n    this.rngstate = data.rngstate||0;\n  }\n\n  getsPulled(force, target, tick=0) {\n    let dist = objectDistance(this, target);\n    let fade = 1+(tick*0.05)\n    this.speedWarp = (force*200/this.mass)/(Math.pow(dist * 0.5, 1.1)*fade);\n    if (dist > this.size*2*fade)  {\n      this.dx -= force*towardsBody(this, target).x/(Math.pow(dist * 0.04, 1.1)*fade);\n      this.dy -= force*towardsBody(this, target).y/(Math.pow(dist * 0.04, 1.1)*fade);\n    }\n  }\n\n  movePlanet() {\n    this.angle += this.orbitX===this.orbitY ?\n    (Math.acos(1 - Math.pow((this.speed/(1+this.speedWarp))/this.orbitX, 2)/2)%Math.PI*2)*this.dir :\n    (Math.acos(1 - Math.pow((this.speed*(1+this.e*Math.cos(this.angle))/(1+this.speedWarp))/this.orbitX, 2)/2)%Math.PI*2)*this.dir;\n\n    if (this.parent) {\n      this.xPar = this.parent.x;\n      this.yPar = this.parent.y;\n      if (this.orbitX!==this.orbitY) {\n        this.xPar -= this.pfdist.x;\n        this.yPar -= this.pfdist.y;\n      }\n    }\n    if (this.orbitX===this.orbitY) {\n      this.x = this.xPar + this.orbitX * Math.cos(this.angle) + this.dx;\n      this.y = this.yPar + this.orbitY * Math.sin(this.angle) + this.dy;\n    }\n    else {\n      let el = new Victor(this.orbitX * Math.cos(this.angle), this.orbitY * Math.sin(this.angle))\n      el.rotateDeg(this.rot)\n      this.x = this.xPar + el.x + this.dx;\n      this.y = this.yPar + el.y + this.dy;\n    }\n    if (this.dx) {\n      this.dx = Math.abs(this.dx)>1 ? this.dx*0.99 : 0;\n    }\n    if (this.dy) {\n      this.dy = Math.abs(this.dy)>1 ? this.dy*0.99 : 0;\n    }\n    if (this.speedWarp) {\n      this.speedWarp = this.speedWarp>0.1 ? this.speedWarp*0.8 : 0;\n    }\n    if (this.coll) {\n      this.coll--;\n    }\n  };\n}\n\n//structure data\nconst rs1 = { numSeg: 5, gap: 0.35, radius: 190, speed: -1.4, origin: {x: 350, y: 350}, width: 16, hue: \"#DF70FF\", name: \"S1\"};\nconst rs2 = { numSeg: 12, gap: 0.4, radius: 320, speed: 0.7, origin: {x: 350, y: 350}, width: 12, hue: \"#FFD5D0\", name: \"S2\"};\nconst rs3 = { numSeg: 2, gap: 0.2, radius: 50, speed: 0.5, origin: {x: 350, y: 350}, width: 10, hue: \"#86CFEF\", name: \"S3\"};\nconst rs4 = { numSeg: 18, gap: 0.1, radius: 250, speed: 0.4, origin: {x: 350, y: 350}, width: 12, hue: \"#FF6655\", name: \"S4\"};\n\nfunction rngStruct(seed, scale=1, rstate=false) {\n  let rand = seedrandom(seed, {state: rstate})\n  // let ox = Math.floor(rng.quick()*350*Math.pow(scale, 0.5));\n  return {\n    numSeg: Math.floor(1+12*rand.quick())*1,\n    arg: 0,\n    gap: Math.floor(50*rand.quick())/100,\n    speed: ((rand.quick()*1.5)/scale).toFixed(1)-1,\n    width: Math.floor((rand.quick()*15+4)*1),\n    radius: Math.floor((rand.quick()*280)+30*1),\n    hue: shadeColor(\"#\"+((rand.int32().toString(16)).slice(-6)),30),\n    glow: Math.floor(20*rand.quick())/15,\n    name: seed,\n    rngstate: rstate?rand.state:null,\n    origin: {x: 350, y: 350},\n  }\n}\n\nclass ringStructure {\n  constructor({numSeg=5, gap=0.4, radius=240, speed=5, origin={x: 350, y: 350}, width=10, hue=\"#E0E0E0\", glow=1,name=\"(Unknown)\",arg=0}={}) {\n    this.numSeg = numSeg;\n    this.arg = arg;\n    this.gap = gap;\n    this.radius = radius;\n    this.speed = speed;\n    this.dir = speed<0?-1:1;\n    this.origin = origin;\n    this.width = width;\n    this.hue = hue;\n    this.glow = 0.5;\n    this.segments = [];\n    this.name = name;\n  }\n\n  addSegments(openings=0) {\n    let arg = this.dir===1?this.arg:this.arg-Math.PI*2;\n    let gap = this.gap;\n    let numSeg = this.numSeg;\n    let r = this.radius;\n    let origin = this.origin;\n    let width = this.width;\n    let hue = this.hue;\n    let glow = this.glow;\n    let dir = this.dir;\n    for (let i=0;i<numSeg;i++) {\n      let segment = {\n        a: arg,\n        b: arg + (Math.PI*2*(1-gap))/numSeg,\n        r: r,\n        ac: arg%(Math.PI*2),\n        bc: (arg + (Math.PI*2*(1-gap))/numSeg)%(Math.PI*2),\n        origin: origin,\n        width: width,\n        hue: i===0?\"#FD5E53\":hue,\n        glow: i===0?glow*3:glow,\n        health: 3,\n        phase: 0,\n      };\n      this.segments.push(segment);\n      arg += (Math.PI*2)/numSeg;\n    }\n    for (let i=0;i<openings;i++) {\n      this.destroyRandom();\n    }\n  }\n\n  destroySegment(seg) {\n    const destroy = this.segments.filter(item => item !== seg);\n    this.segments = destroy;\n  }\n\n  destroyRandom() {\n    let rand = this.segments[_.random(this.segments.length)-1]\n    this.destroySegment(rand);\n  }\n\n  moveSegments() {\n    for (let seg of this.segments) {\n\n      if (this.speed>0) {\n        seg.a += Math.PI*2*0.001*this.speed;\n        seg.ac = (Math.abs(seg.a)+Math.PI*2)%(Math.PI*2);\n        seg.b += Math.PI*2*0.001*this.speed;\n        seg.bc = (Math.abs(seg.b)+Math.PI*2)%(Math.PI*2);\n      } else if (this.speed<0) {\n        seg.a += Math.PI*2*0.001*this.speed;\n\n        seg.b += Math.PI*2*0.001*this.speed;\n        seg.ac = Math.abs(seg.a-Math.PI*2)%(Math.PI*2);\n        seg.bc = Math.abs(seg.b-Math.PI*2)%(Math.PI*2);\n      }\n      let phase = Math.sin((seg.ac+Math.PI*2)%(Math.PI*2));\n      let int = Math.floor(Math.abs(phase)*10000)%150;\n      seg.glow = this.glow+(Math.floor(Math.abs(phase)*250)*this.glow*0.025)\n      // if (int===0) {\n      //\n      // }\n      if (seg.health<3 && int<7/(seg.health+6)) {\n        seg.health<0?seg.health+=0.5:seg.health++;\n      }\n    }\n  }\n}\n\n//the canvas render is split into a dynamic wrapper and a nested non-updating actual canvas, idea by Phil Nash https://philna.sh/, elements from Reacteroids\nclass GameCanvas extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      zones: [],\n    }\n    this.saveContext = this.saveContext.bind(this);\n    //proton\n    this.tick = 1;\n    this.psiLevel = 0;\n    this.emitterList = [];\n  }\n\n  saveContext(canvas) {\n    this.protonCanvas = canvas;\n    this.ctx = canvas.getContext('2d');\n    this.width = this.ctx.canvas.width;\n    this.height = this.ctx.canvas.height;\n  }\n\n  componentDidMount() {\n    this.createProton();\n  }\n\n  createProton() {\n    this.proton = new Proton();\n    // const imageWidth = 342;\n    // const drawScopeWidth = 710;\n    // const rect = new Proton.Rectangle((this.protonCanvas.width - imageWidth) / 2, (this.protonCanvas.height - imageWidth) / 2, imageWidth, imageWidth);\n    // const rect2 = new Proton.Rectangle((this.protonCanvas.width - drawScopeWidth) / 2, 0, drawScopeWidth, this.protonCanvas.height);\n    // const rectZone = new Proton.RectZone(rect2.x, rect2.y, rect2.width, rect2.height);\n    // const zones = this.state.zones;\n    // this.emitterList[0].addBehaviour(this.customToZoneBehaviour(zones[0], zones[1], zones[2]));\n\n    // this.borderZoneBehaviour = new Proton.CrossZone(new Proton.RectZone(0, 0, this.protonCanvas.width, this.protonCanvas.height), 'bound');\n    // this.centerZone = new Proton.RectZone(this.width/2, this.height/2, this.props.world.bodies[0].size);\n    // this.centerBehaviour = new Proton.Repulsion(this.centerZone, 10, 30)\n    // this.randomBehaviour = new Proton.RandomDrift(5, 5, .05);\n    this.clickEmitter = this.createClickEmitter('#F8F8FF', '#F8F8FF', this.props.ball);\n    this.renderer = new Proton.CanvasRenderer(this.protonCanvas);\n    // this.renderer.onProtonUpdate = function() {\n    // TBD\n    // };\n    this.renderer.onParticleUpdate = (particle) => {\n      this.ctx.globalAlpha = 0.9;\n      // if (particle.radius>1) {\n      //   this.renderer.drawCircle(particle);\n      // }\n      this.ctx.beginPath();\n      this.ctx.strokeStyle = particle.color;\n      this.ctx.lineWidth = particle.energy*2+particle.radius/4;\n      this.ctx.moveTo(particle.old.p.x-particle.old.a.x*20, particle.old.p.y-particle.old.a.y*20);\n      this.ctx.lineTo(particle.p.x, particle.p.y);\n      this.ctx.closePath();\n      this.ctx.stroke();\n      this.ctx.globalAlpha = 1\n    };\n    this.proton.addRenderer(this.renderer);\n  }\n\n  createClickEmitter(color1, color2, target=null) {\n    var clickEmitter = new Proton.Emitter();\n    // let emitDirection  = Victor(target.x-this.protonCanvas.width/2, target.y-this.protonCanvas.height/2).verticalAngleDeg();\n    let centerZone = {\n      x: this.props.world.bodies[0].x||this.width/2,\n      y: this.props.world.bodies[0].y||this.height/2,\n    }\n    let centerBehaviour = new Proton.Repulsion(centerZone, 10, this.props.world.bodies[0].size*2||30)\n    let borderZoneBehaviour = new Proton.CrossZone(new Proton.RectZone(0, 0, this.protonCanvas.width, this.protonCanvas.height), 'bound');\n    let randomBehaviour = new Proton.RandomDrift(5, 5, .05);\n    clickEmitter.addBehaviour(randomBehaviour);\n    clickEmitter.addBehaviour(borderZoneBehaviour);\n    clickEmitter.addBehaviour(centerBehaviour);\n\n    clickEmitter.target = target;\n    clickEmitter.damping = 0.012;\n    clickEmitter.addInitialize(new Proton.Rate(40,0.025));\n    clickEmitter.addInitialize(new Proton.Mass(8));\n    clickEmitter.addInitialize(new Proton.Life(new Proton.Span(3,5)))\n    clickEmitter.addInitialize(new Proton.Radius(1));\n    clickEmitter.currVelocity = new Proton.Velocity(2, new Proton.Span(0,360), 'polar');\n    clickEmitter.addInitialize(clickEmitter.currVelocity);\n    // if (target.vx && target.vy) {\n    //   clickEmitter.addInitialize(new Proton.Force(target.vx*120, target.vy*120))\n    // }\n    clickEmitter.addBehaviour(new Proton.Color(color1, color2));\n    clickEmitter.pointAttraction = new Proton.Attraction(target, 20, 600);\n    clickEmitter.addBehaviour(clickEmitter.pointAttraction);\n    clickEmitter.p.x = this.props.mouseObj.x;\n    clickEmitter.p.y = this.props.mouseObj.y;\n    this.proton.addEmitter(clickEmitter);\n    return clickEmitter;\n  }\n\n  componentDidUpdate() {\n    const bodies = this.props.world.bodies;\n    if (this.props.tick > this.tick) {\n      // this.ctx.save();\n      // this.updateWorld();\n      if (this.props.tick%10===0) {\n        this.updateWorld();\n        if (this.props.tick%500===0) {\n          this.coreEmitter.emit(this.coreEmitter.e);\n        }\n      }\n      this.proton.update();\n      if (this.psiLevel < this.props.resources.psi && this.psiEmitter) {\n        this.psiLevel++;\n        this.psiEmitter.rate = this.psiLevel < 9 ?\n        new Proton.Rate(new Proton.Span(20+this.psiLevel*5, 25+this.psiLevel*8), this.psiLevel*0.25) :\n        new Proton.Rate(new Proton.Span(150, 180), 4)\n        this.psiEmission();\n      }\n      this.drawStructures();\n      for (let planet of bodies) {\n        if (planet) {\n          this.drawConnect(planet, this.props.ball);\n          this.drawPlanet(planet);\n        }\n      }\n      this.drawBall();\n      this.drawScore();\n      // this.ctx.restore();\n      this.mouseInput()\n      this.tick = this.props.tick;\n    }\n  }\n\n  mouseInput() {\n    if (this.props.mousedown === true) {\n      //while mouse held down\n      if (this.props.mouseTick % 10 === 0) {\n        for (let a of this.emitterList) {\n          if (a&&a.mouseAttract) {\n            a.mouseAttract.reset(this.props.mouseObj, 25, 600);\n          }\n        }\n      }\n      this.clickEmission();\n    } else {\n      if (this.mouseReleased === true) {\n        //when mouse released\n        for (let a of this.emitterList) {\n          if (a&&a.mouseAttract) {\n            a.mouseAttract.reset(this.props.mouseObj, 5, 200);\n          }\n        }\n      }\n    }\n  }\n\n  clickEmission() {\n    this.clickEmitter.p.x = this.props.mouseObj.x;\n    this.clickEmitter.p.y = this.props.mouseObj.y;\n    this.clickEmitter.pointAttraction.reset(this.props.ball, 20, 600)\n    // let emitDirection = Victor(-this.props.mouseObj.x+this.props.ball.x, -this.props.mouseObj.y+this.props.ball.y).verticalAngleDeg();\n    // console.log(emitDirection)\n    // this.clickEmitter.currVelocity.reset(4, new Proton.Span((emitDirection+180)%360-60, (emitDirection+180)%360+60), 'polar');\n    this.clickEmitter.emit('once');\n  }\n\n  psiEmission() {\n    this.psiEmitter.p.x = this.props.ball.x;\n    this.psiEmitter.p.y = this.props.ball.y;\n    // this.psiEmitter.planetAttraction.reset(this.props.world.bodies[0], 25, 700);\n    let emitDirection = Victor(this.props.ball.x-this.protonCanvas.width/2, this.props.ball.y-this.protonCanvas.height/2).verticalAngleDeg();\n    this.psiEmitter.currVelocity.reset(new Proton.Span(2,3), new Proton.Span((emitDirection+180)%360-15, (emitDirection+180)%360+15), 'polar');\n    this.psiEmitter.emit('once');\n  }\n\n  updateWorld() {\n    this.updateEmitters();\n  }\n\n  updateEmitters(x) {\n    const bodies = this.props.world.bodies;\n    for (let body of bodies) {\n      if (body&&!this.emitterList[body.index]&&body.emitter) {\n        this.emitterList[body.index] = body.emitter;\n        this.proton.addEmitter(this.emitterList[body.index]);\n        this.emitterList[body.index].emit(this.emitterList[body.index].e);\n      }\n    }\n\n    //rewrite this garbage to get triggered by actual events and not check every damn time\n    for (let em of this.emitterList) {\n      if (em&&em.target&&!bodies[em.target]) {\n        this.proton.removeEmitter(em);\n        this.emitterList[em.target] = null;\n      }\n      else if (em&&em.target&&bodies[em.target]) {\n        em.p.x = bodies[em.target].x;\n        em.p.y = bodies[em.target].y;\n        if (bodies[em.target].coll%6===2) {\n          em.emit(em.e);\n        }\n        if (em.planetAttraction) {\n          // em.planetAttraction.reset(bodies[em.target], 15, 500);\n          em.planetAttraction.reset(bodies[em.target], em.planetAttraction.force/100, em.planetAttraction.radius);\n        }\n      }\n    }\n    if (!this.psiEmitter&&this.props.proton.psiEmitter) {\n      this.psiEmitter = this.props.proton.psiEmitter;\n      this.proton.addEmitter(this.psiEmitter);\n    }\n    if (!this.coreEmitter&&this.props.proton.coreEmitter) {\n      this.coreEmitter = this.props.proton.coreEmitter;\n      this.proton.addEmitter(this.coreEmitter);\n    }\n  }\n\n  drawConnect(origin, target) {\n    this.ctx.beginPath();\n    this.ctx.globalAlpha = 0.5\n    this.ctx.strokeStyle = '#4397DC';\n    this.ctx.lineWidth = 1;\n    this.ctx.setLineDash([40, 15]);\n    this.ctx.lineDashOffset = 20\n    this.ctx.moveTo(origin.x, origin.y);\n    this.ctx.lineTo(target.x, target.y);\n    this.ctx.closePath();\n    this.ctx.stroke();\n    this.ctx.shadowBlur = 0;\n    this.ctx.shadowColor = 0;\n    this.ctx.setLineDash([])\n    this.ctx.globalAlpha = 1\n  }\n\n  drawScore() {\n    const score = this.props.currentScore;\n    this.ctx.fillStyle = \"#F5F5F5\";\n    this.ctx.font = \"22px Arial\";\n    this.ctx.fillText(\"x\" + score, 10, 25);\n  }\n\n  drawBall(blur=1.5) {\n    const ball = this.props.ball;\n    const {x, y, vx, vy, size, color, glow} = ball;\n    if (glow) {\n      this.ctx.shadowBlur = glow*15;\n      this.ctx.shadowColor = shadeColor(color, 10);\n    }\n    if (blur) {\n      this.ctx.beginPath();\n      this.ctx.globalAlpha = 0.3;\n      this.ctx.arc(x-(vx*blur), y-(vy*blur), size, 0, Math.PI * 2);\n      this.ctx.fillStyle = color;\n      this.ctx.fill();\n      this.ctx.closePath();\n      this.ctx.globalAlpha = 1;\n    }\n    this.ctx.beginPath();\n    this.ctx.arc(x, y, size, 0, Math.PI * 2);\n    this.ctx.fillStyle = color;\n    this.ctx.fill();\n    this.ctx.closePath();\n    this.ctx.shadowBlur = 0;\n    this.ctx.shadowColor = 0;\n  }\n\n  drawPlanet(p) {\n    //outlines the orbit\n    this.ctx.beginPath();\n    p.orbitX!==p.orbitY ?\n    this.ctx.ellipse(p.xPar, p.yPar, p.orbitX, p.orbitY, p.rot/360*(Math.PI*2), 0, Math.PI * 2, true) :\n    this.ctx.arc(p.xPar, p.yPar, p.orbitX, 0, Math.PI * 2, false);\n    this.ctx.lineWidth = 2;\n    this.ctx.globalAlpha = 0.4;\n    this.ctx.strokeStyle = \"#E0E0E0\";\n    this.ctx.closePath();\n    this.ctx.stroke();\n    this.ctx.globalAlpha = 1;\n    //the planet itself\n    this.ctx.beginPath();\n    if (p.glow) {\n      this.ctx.shadowBlur = p.glow*10;\n      this.ctx.shadowColor = shadeColor(p.hue, 20);\n    }\n    this.ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);\n    this.ctx.fillStyle = p.hue;\n    this.ctx.fill();\n    this.ctx.closePath();\n    this.ctx.shadowBlur = 0;\n    this.ctx.shadowColor = 0;\n  };\n\n  drawStructures() {\n    const structures = this.props.world.structures;\n    for (let layer of structures) {\n      if (layer) {\n        for (let seg of layer.segments) {\n          if (seg.health>0) {\n          this.drawSegment(seg);\n          }\n        }\n      }\n    }\n  }\n\n  drawSegment(seg) {\n    this.ctx.beginPath();\n    if (seg.glow) {\n      this.ctx.shadowBlur = seg.glow*3;\n      this.ctx.shadowColor = shadeColor(seg.hue, 30);\n    }\n    this.ctx.globalAlpha = seg.health*0.33;\n    this.ctx.arc(seg.origin.x, seg.origin.y, seg.r, seg.a, seg.b, false);\n    this.ctx.lineWidth = seg.width;\n    this.ctx.strokeStyle = seg.hue;\n    this.ctx.stroke();\n    this.ctx.closePath();\n    this.ctx.globalAlpha = 1;\n    this.ctx.shadowBlur = 0;\n    this.ctx.shadowColor = 0;\n  }\n\n  //to try later\n  // setZones(img) {\n  //   let zones = this.state.zones;\n  //   for (let i of img) {\n  //     let imagedata = Proton.Util.getImageData(this.ctx, i, rect)\n  //     zones.push(new Proton.ImageZone(imagedata, rect.x, rect.y))\n  //     }\n  //   this.setState((prevState) => {\n  //     return {\n  //       zones: zones,\n  //     }\n  //   });\n  // }\n\n  // customToZoneBehaviour(zone1, zone2, zone3) {\n  //   return {\n  //     initialize: function(particle) {\n  //       particle.R = Math.random() * 10;\n  //       particle.Angle = Math.random() * Math.PI * 2;\n  //       particle.speed = Math.random() * (-1.5) + 0.75;\n  //       particle.zones = [zone1.getPosition().clone(), zone2.getPosition().clone(), zone3.getPosition().clone()];\n  //     },\n  //\n  //     applyBehaviour: function(particle) {\n  //       if (mouseTick % 2 != 0) {\n  //         particle.v.clear();\n  //         particle.Angle += particle.speed;\n  //         let index = (mouseTick % 6 + 1) / 2 - 1;\n  //         let x = particle.zones[index].x + particle.R * Math.cos(particle.Angle);\n  //         let y = particle.zones[index].y + particle.R * Math.sin(particle.Angle);\n  //         particle.p.x += (x - particle.p.x) * 0.05;\n  //         particle.p.y += (y - particle.p.y) * 0.05;\n  //       }\n  //     }\n  //   }\n  // }\n\n  render() {\n    return (\n      <PureCanvas width={this.props.screen.width} height={this.props.screen.height} contextRef={this.saveContext} onMouseDown={this.props.onMouseDown} onMouseUp={this.props.onMouseUp} onMouseMove={this.props.onMouseMove} style={this.props.style}/>\n    )\n  }\n}\n\nclass PureCanvas extends React.Component {\n  shouldComponentUpdate() {\n    return false;\n  }\n  render() {\n    return (\n      <canvas id=\"myCanvas\"\n      width={this.props.width}\n      height={this.props.height}\n      ref={node =>\n        node ? this.props.contextRef(node) : null\n      } onMouseDown={this.props.onMouseDown} onMouseUp={this.props.onMouseUp} onMouseMove={this.props.onMouseMove} style={this.props.style}\n      />\n    );\n  }\n}\n\nclass ErrorBoundary extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, info) {\n    // You can also log the error to an error reporting service\n    console.log(error, info);\n    this.setState({\n      error: error,\n      info: info\n    });\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div>\n        <h1>Something went wrong.</h1>\n        <details style={{ whiteSpace: 'pre-wrap' }}>\n        {this.state.error && this.state.error.toString()}\n        <br />\n        {this.state.info.componentStack}\n        </details>\n        </div>\n      )\n    }\n    return this.props.children\n  }\n}\n\nclass App extends Component {\n  render() {\n    return (\n      <ErrorBoundary>\n      <div className=\"App\">\n      <header className=\"header\">\n      <h1 className=\"header-name\">\n      Orbit game title\n      </h1>\n      </header>\n      <OrbitGame width=\"700\" height=\"700\"/>\n      </div>\n      </ErrorBoundary>\n    );\n  }\n}\n\nexport default App;\n// <header className=\"App-header\">\n// <img src={logo} className=\"App-logo\" alt=\"logo\" />\n// <p style={{ color: `${shadeColor('#CC44EE', 20, 0, -30)}` }}>\n// Edit <code>src/App.js</code> and save to reload.\n// </p>\n// <a\n// className=\"App-link\"\n// href=\"https://reactjs.org\"\n// target=\"_blank\"\n// rel=\"noopener noreferrer\"\n// >\n// Learn React\n// </a>\n// </header>\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}