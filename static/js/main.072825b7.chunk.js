(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAJkSURBVHjaxJeJbusgEEW94S1L//83X18M2MSuLd2pbqc4wZGqRLrKBsyZhQHny7Jk73xVL8xpVhWrcmiB5lX+6GJ5YgQ2owbAm8oIwH1VgKZUmGcRqKGGPgtEQQAzGR8hQ59fAmhJHSAagigJ4E7GPWRXOYC6owAd1JM6wDQPADyMWUqZRMqmAojHp1Vn6EQQEgUNMJLnUjMyJsM49wygBkAPw9dVFwXRkncCIIW3GRgoTQUZn6HxCMAFEFd8TwEQ78X4rHbILoAUmeT+RFG4UhQ6MiIAE4W/UsYFjuVjAIa2nIY4q1R0GFtQWG3E84lqw2GO2QOoCKBVu0BAPgDSU0eUDjjQenNkV/AW/pWChhpMTelo1a64AOKM30vk18GzTHXCNtI/Knz3DFBgsUqBGIjTInXRY1yA9xkVoqW5tVq3pDR9A0hfF5BSARmVnh7RMDCaIdcNgbPBkgzn1Bu+SfIEFSpSBmkxyrMicb0fAEuCZrWnN89veA/4XcakrPcjBWzkTuLjlbfTQPOlBhz+HwkqqPXmPQDdrQItxE1moGof1S74j/8txk8EHhTQrAE8qlwfqS5yukm1x/rAJ9Jiaa6nyATqD78aUVBhFo8b1V4DdTXdCW+IxA1zB4JhiOhZMEWO1HqnvdoHZ4FAMIhV9REF8FiUm0jsYPEJx/Fm/N8OhH90HI9YRHesWbXXZwAShU8qThe7H8YAuJmw5yOd989uRINKRTJAhoF8jbqrHKfeCYdIISZfSq26bk/K+yO3YvfKrVgiwQBHnwt8ynPB25+M8hceTt/ybPhnryJ78+tLgAEAuCFyiQgQB30AAAAASUVORK5CYII="},28:function(t,e,a){t.exports=a(55)},33:function(t,e,a){},53:function(t,e){},54:function(t,e,a){},55:function(t,e,a){"use strict";a.r(e);var i=a(0),r=a.n(i),s=a(18),n=a.n(s),o=(a(33),a(27)),l=a(6),h=a.n(l),u=a(12),c=a(2),d=a(4),p=a(9),m=a(10),v=a(17),b=a(15),y=a(16),g=a(3),f=a(21),w=a.n(f),x=a(13),k=a.n(x),S=a(5),E=a.n(S),O=a(1),C=a.n(O),M=a(8),j=a.n(M),P=(a(54),a(19)),A=a.n(P);w.a.setAppElement("#root");var B=37,I=39,F=38,D=40,z=65,L=68,R=87,q=83,T=32;function X(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},a=new j.a(t.x,t.y),i=new j.a(e.x,e.y);return a.distance(i)}function G(t,e){if(t&&e)return{x:(t.x-e.x)/X(t,e),y:(t.y-e.y)/X(t,e)}}function W(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=parseInt(t.substring(1,3),16),s=parseInt(t.substring(3,5),16),n=parseInt(t.substring(5,7),16);return r=parseInt(r*(100+e)/100),s=(s=parseInt(s*(100+a)/100))<255?s:255,n=(n=parseInt(n*(100+i)/100))<255?n:255,"#"+(1===(r=r<255?r:255).toString(16).length?"0"+r.toString(16):r.toString(16))+(1===s.toString(16).length?"0"+s.toString(16):s.toString(16))+(1===n.toString(16).length?"0"+n.toString(16):n.toString(16))}var H=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(v.a)(this,Object(b.a)(e).call(this,t))).state={screen:{width:a.props.width,height:a.props.height,ratio:window.devicePixelRatio||1},starList:[{name:"Lalande",num:5},{name:"Tau Ceti",num:4},{name:"Groombridge",num:2},{name:"Alpha Centauri",num:4},{name:"Epsilon Eriadni",num:7},{name:"Procyon A",num:0},{name:"Procyon B",num:1},{name:"Ross 154",num:3},{name:"Barnard's Star",num:8}],world:{stage:"Sol",bodies:[],pendingBodies:[],bDatabase:{Sol:[{data:it,parent:0,index:0,active:!0,status:{shield:0,uplink:0,buildings:[]}},{data:_,parent:0,index:1,active:!0,status:{shield:Math.floor(70*E()("m1".toString()).quick()+30),uplink:Math.floor(70*E()("m2".toString()).quick()+30),buildings:[]}},{data:et,parent:0,index:2,active:!0,status:{shield:Math.floor(70*E()("v1".toString()).quick()+30),uplink:Math.floor(70*E()("v2".toString()).quick()+30),buildings:[]}},{data:tt,parent:1,index:3,active:!0,status:{}},{data:at,parent:0,index:4,active:!0,status:{shield:Math.floor(70*E()("e1".toString()).quick()+30),uplink:Math.floor(70*E()("e2".toString()).quick()+30),buildings:[]}},{data:rt,parent:0,index:5,active:!1,status:{shield:Math.floor(70*E()("s1".toString()).quick()+30),uplink:Math.floor(70*E()("s2".toString()).quick()+30),buildings:[]}}]},structures:[],pendingStructures:[],sDatabase:{Sol:[{data:ot,openings:1,index:0,active:!0,status:{}},{data:lt,openings:4,index:1,active:!0,status:{}},{data:ht,openings:0,index:2,active:!0,status:{}},{data:ut,openings:8,index:3,active:!1,status:{}}]}},params:{gravFalloff:.9,bounceDampening:.9},ball:{x:190,y:210,vx:.5,vy:.5,size:6,mass:3,speed:0,thrustAcc:.1,thrustLevel:0,heading:0,power:0,coll:!1,ct:0,color:"#E0EDFF",glow:1},resources:{matter:100,mInc:0,energy:1500,eInc:0,psi:100,psiInc:0,psiFlux:0,psiChoir:0,hm:0},keys:{left:0,right:0,up:0,down:0,space:0,released:{left:!1,right:!1,up:!1,down:!1,space:!1}},mousedown:!1,mouseTick:0,mouseReleased:!1,mouseObj:{x:350,y:350,init:!1},proton:{},selectedObj:null,tick:0,ts:0,randomHash:0,currentScore:0,inGame:!0,showModal:!1},a.sharedEB=[],a.animationID=null,a.timerID=null,a.handlePowerChange=a.handlePowerChange.bind(Object(g.a)(Object(g.a)(a))),a.handleChargePsi=a.handleChargePsi.bind(Object(g.a)(Object(g.a)(a))),a.psiBlast=0,a.beamBlast=0,a.beamPhase=0,a.handlePlanetBuild=a.handlePlanetBuild.bind(Object(g.a)(Object(g.a)(a))),a.handleSystemChange=a.handleSystemChange.bind(Object(g.a)(Object(g.a)(a))),a.handlePlanetToggle=a.handlePlanetToggle.bind(Object(g.a)(Object(g.a)(a))),a.handleStructureToggle=a.handleStructureToggle.bind(Object(g.a)(Object(g.a)(a))),a.handlePauseStart=a.handlePauseStart.bind(Object(g.a)(Object(g.a)(a))),a.handleKeys=a.handleKeys.bind(Object(g.a)(Object(g.a)(a))),a.mouseupHandler=a.mouseupHandler.bind(Object(g.a)(Object(g.a)(a))),a.mousedownHandler=a.mousedownHandler.bind(Object(g.a)(Object(g.a)(a))),a.mousemoveHandler=a.mousemoveHandler.bind(Object(g.a)(Object(g.a)(a))),a.handleOpenModal=a.handleOpenModal.bind(Object(g.a)(Object(g.a)(a))),a.handleCloseModal=a.handleCloseModal.bind(Object(g.a)(Object(g.a)(a))),a}return Object(y.a)(e,t),Object(m.a)(e,[{key:"makeMapInterface",value:function(t){var e=this,a=Object(d.a)(this.state.starList);return a.push({name:"Sol",num:6}),a.map(function(a){return r.a.createElement(J,{onClick:e.handleSystemChange,star:a.name,ui:t,key:a.name})})}},{key:"makeControlButtons",value:function(){return[this.state.inGame?r.a.createElement(Q,{onClick:this.handlePauseStart,style:{backgroundColor:"red"},text:"Pause",key:"Pause"}):r.a.createElement(Q,{onClick:this.handlePauseStart,text:"Continue",key:"Pause"}),r.a.createElement(Q,{onClick:this.handleChargePsi,style:{backgroundColor:"#4666FF"},text:"Psi blasts: ".concat(this.state.resources.psi),key:"Psi"}),r.a.createElement(Q,{onClick:this.handlePowerChange,style:{backgroundColor:"#E0115F"},text:"Energy: ".concat(this.state.resources.energy," (click to charge)"),key:"Energy"})]}},{key:"selectOnCanvas",value:function(t){var e=this,a=Object(d.a)(this.state.world.bodies),i=!0,r=!1,s=void 0;try{for(var n,o=function(){var a=n.value;if(X(t,a)<1.5*a.size)return{v:e.setState(function(t){return{selectedObj:a}})}},l=a[Symbol.iterator]();!(i=(n=l.next()).done);i=!0){var h=o();if("object"===typeof h)return h.v}}catch(u){r=!0,s=u}finally{try{i||null==l.return||l.return()}finally{if(r)throw s}}}},{key:"handlePowerChange",value:function(){this.setState(function(t){return{currentScore:0,resources:Object(c.a)({},t.resources,{energy:t.resources.energy+10*t.currentScore})}})}},{key:"handleChargePsi",value:function(){var t=this.state.resources.psi;return this.psiBlast+=2,this.setState({resources:Object(c.a)({},this.state.resources,{psi:t-1})})}},{key:"handlePlanetBuild",value:function(t,e){var a=this.state.world.bodies,i=e.target.id,r=a.find(function(t){return t.name===i});switch(t){case 0:r.status.shield++;break;case 1:this.state.resources.matter>5&&(r.status.buildings[t]?r.status.buildings[t].lvl++:r.status.buildings[t]={name:"Power grid",lvl:1},this.setState({resources:Object(c.a)({},this.state.resources,{eInc:this.state.resources.eInc+1,matter:this.state.resources.matter-5})}));break;case 2:this.state.resources.matter>10&&(r.status.buildings[t]?r.status.buildings[t].lvl++:r.status.buildings[t]={name:"Ansible",lvl:1},this.setState({resources:Object(c.a)({},this.state.resources,{psiInc:this.state.resources.psiInc+1,matter:this.state.resources.matter-10})}));break;case 3:this.state.resources.matter>5&&(r.status.buildings[t]?r.status.buildings[t].lvl++:r.status.buildings[t]={name:"Choir relay",lvl:1},this.setState({resources:Object(c.a)({},this.state.resources,{psiChoir:this.state.resources.psiChoir+1,matter:this.state.resources.matter-5})}));break;default:console.log("No such building: "+t)}}},{key:"handleKeys",value:function(t,e){var a=Object(c.a)({},this.state.keys),i=!1;e.keyCode!==B&&e.keyCode!==z||(a.released.left=!t&&a.left,a.left=t?a.left+1:0,i=i||a.left||a.released.left),e.keyCode!==D&&e.keyCode!==q||(a.released.down=!t&&a.down,a.down=t?a.down+1:0,i=i||a.down||a.released.down),e.keyCode!==I&&e.keyCode!==L||(a.released.right=!t&&a.right,a.right=t?a.right+1:0,i=i||a.right||a.released.right),e.keyCode!==F&&e.keyCode!==R||(a.released.up=!t&&a.up,a.up=t?a.up+1:0,i=i||a.up||a.released.up),e.keyCode===T&&(a.released.space=!t&&a.space,a.space=t?a.space+1:0,i=i||a.space||a.released.space),i&&this.setState({keys:a})}},{key:"mousedownHandler",value:function(t){var e=t.nativeEvent.layerX,a=t.nativeEvent.layerY;this.setState(function(t){return{mousedown:!0,mouseObj:{x:e,y:a}}}),this.selectOnCanvas({x:e,y:a})}},{key:"beamBlastPower",value:function(){var t=this.state.beamBlast;return t?t>0?this.state.mouseReleased?(console.log("switch to blast mode"),this.setState({beamBlast:-1*t,beamPhase:3})):t<50&&this.state.mouseTick%4===0?this.setState({beamBlast:t+1,beamPhase:2}):void 0:this.setState({beamBlast:t+1}):this.state.mousedown&&1===this.state.mouseTick?(console.log("start charge mode"),this.setState(function(t){return{beamBlast:1,beamPhase:1}})):this.state.beamPhase?this.setState({beamPhase:0}):void 0}},{key:"mouseupHandler",value:function(t){return this.setState({mousedown:!1})}},{key:"mousemoveHandler",value:function(t){if(this.state.mousedown&&this.state.mouseTick%4===0){var e=t.nativeEvent.layerX,a=t.nativeEvent.layerY;return this.setState({mouseObj:{x:e,y:a}})}}},{key:"handleOpenModal",value:function(){return this.setState({showModal:!0})}},{key:"handleCloseModal",value:function(){return this.setState({showModal:!1})}},{key:"handleSystemChange",value:function(t){var e=t.target.id;return this.systemChange(e)}},{key:"handlePlanetToggle",value:function(t){var e=t.target.id;return this.planetToggle(e)}},{key:"handleStructureToggle",value:function(t){var e=t.target.id;return this.structureToggle(e)}},{key:"genSysPlanets",value:function(){var t=Object(u.a)(h.a.mark(function t(){var e,a,i,r,s,n,o,l,u,d=arguments;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=d.length>0&&void 0!==d[0]?d[0]:"Alpha Centauri",a=d.length>1&&void 0!==d[1]?d[1]:3,Object(c.a)({},this.state.world.bDatabase)[e]){t.next=12;break}for(i=[],r=st(e,"star"),s={data:Object(c.a)({},r),index:0,parent:0,active:!1,status:{buildings:[]}},i.push(s),n=1;n<a+1;n++)o=Math.floor(E()(n.toString()).quick()*(n/a)*4),l=st(e+" "+n.toString(),"planet",1/(o/2+1)),u={data:Object(c.a)({},l),index:n,parent:o,active:!1,status:{shield:Math.floor(70*E()("s"+n.toString()).quick()+30),uplink:Math.floor(70*E()("u"+n.toString()).quick()+30),buildings:[]}},i.push(u);return t.abrupt("return",i);case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"genSysStructures",value:function(){var t=Object(u.a)(h.a.mark(function t(){var e,a,i,r,s,n,o=arguments;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=o.length>0&&void 0!==o[0]?o[0]:"Alpha Centauri",a=o.length>1&&void 0!==o[1]?o[1]:4,Object(c.a)({},this.state.world.sDatabase)[e]){t.next=9;break}for(i=[],r=0;r<a;r++)s=ct(e+" "+r.toString()),n={data:Object(c.a)({},s),index:r,openings:1,active:!1},i.push(n);return t.abrupt("return",i);case 9:return t.abrupt("return",null);case 10:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"createGalaxy",value:function(){var t=Object(u.a)(h.a.mark(function t(){var e,a,i,r,s,n,o,l,u,d,p,m=arguments;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=m.length>0&&void 0!==m[0]?m[0]:[{name:"Wolf 359",num:6},{name:"Tau Ceti",num:4},{name:"Groombridge",num:1}],a=Object(c.a)({},this.state.world.bDatabase),i=Object(c.a)({},this.state.world.sDatabase),r=!0,s=!1,n=void 0,t.prev=6,o=e[Symbol.iterator]();case 8:if(r=(l=o.next()).done){t.next=21;break}return u=l.value,t.next=12,this.genSysPlanets(u.name,u.num);case 12:return d=t.sent,t.next=15,this.genSysStructures(u.name,3);case 15:p=t.sent,a[u.name]=d,i[u.name]=p;case 18:r=!0,t.next=8;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(6),s=!0,n=t.t0;case 27:t.prev=27,t.prev=28,r||null==o.return||o.return();case 30:if(t.prev=30,!s){t.next=33;break}throw n;case 33:return t.finish(30);case 34:return t.finish(27);case 35:return t.abrupt("return",this.setState(function(t){return{world:Object(c.a)({},t.world,{bDatabase:a,sDatabase:i})}}));case 36:case"end":return t.stop()}},t,this,[[6,23,27,35],[28,,30,34]])}));return function(){return t.apply(this,arguments)}}()},{key:"loadStagePlanets",value:function(t){var e=[],a=Object(c.a)({},this.state.world.bDatabase)[t],i=a.slice(1);if(i){var r=!0,s=!1,n=void 0;try{for(var o,l=i[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=o.value;h.active&&a[h.parent].active&&e.push(h)}}catch(u){s=!0,n=u}finally{try{r||null==l.return||l.return()}finally{if(s)throw n}}}this.setState(function(a){return{world:Object(c.a)({},a.world,{pendingBodies:e,stage:t})}})}},{key:"loadStageStructures",value:function(t){var e=[],a=Object(c.a)({},this.state.world.sDatabase)[t];if(a){var i=!0,r=!1,s=void 0;try{for(var n,o=a[Symbol.iterator]();!(i=(n=o.next()).done);i=!0){var l=n.value;l.active&&e.push(l)}}catch(h){r=!0,s=h}finally{try{i||null==o.return||o.return()}finally{if(r)throw s}}}this.setState(function(t){return{world:Object(c.a)({},t.world,{structures:[],pendingStructures:e})}})}},{key:"loadStage",value:function(){var t=Object(u.a)(h.a.mark(function t(){var e,a=arguments;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:"Sol",t.next=3,this.createPrimary(this.state.world.bDatabase[e][0].data);case 3:return this.loadStagePlanets(e),this.loadStageStructures(e),this.addCoreEmitter(),t.abrupt("return",this.continueGame());case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"systemChange",value:function(t){var e=this.state.world.stage,a=Object(c.a)({},this.state.world.bDatabase),i=Object(c.a)({},this.state.world.sDatabase),r=a[e],s=i[e],n=a[t],o=i[t],l=!0,h=!1,u=void 0;try{for(var d,p=r[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){d.value.active=!1}}catch(P){h=!0,u=P}finally{try{l||null==p.return||p.return()}finally{if(h)throw u}}if(s){var m=!0,v=!1,b=void 0;try{for(var y,g=s[Symbol.iterator]();!(m=(y=g.next()).done);m=!0){y.value.active=!1}}catch(P){v=!0,b=P}finally{try{m||null==g.return||g.return()}finally{if(v)throw b}}}var f=!0,w=!1,x=void 0;try{for(var k,S=n[Symbol.iterator]();!(f=(k=S.next()).done);f=!0){k.value.active=!0}}catch(P){w=!0,x=P}finally{try{f||null==S.return||S.return()}finally{if(w)throw x}}if(o){var E=!0,O=!1,C=void 0;try{for(var M,j=o[Symbol.iterator]();!(E=(M=j.next()).done);E=!0){M.value.active=!0}}catch(P){O=!0,C=P}finally{try{E||null==j.return||j.return()}finally{if(O)throw C}}}this.setState(function(t){return{world:Object(c.a)({},t.world,{bDatabase:a,sDatabase:i}),ball:Object(c.a)({},t.ball,{x:t.screen.width/4,y:t.screen.height/3})}}),this.loadStage(t)}},{key:"createPrimary",value:function(){var t=Object(u.a)(h.a.mark(function t(e){var a,i;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new nt(e)).index=0,a.status={shield:0,uplink:0,buildings:[]},(i=[]).push(a),t.abrupt("return",this.setState(function(t){return{world:Object(c.a)({},t.world,{bodies:i,stage:e.name})}}));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"createPlanet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.world.bodies.length,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=Object(d.a)(this.state.world.bodies);s[a]=new nt(t,s[e]),s[a].index=a,s[a].emitter=this.createNewEmitter(i),s[a].status=r||{shield:5,uplink:100,buildings:[]},this.setState(function(t){return{world:Object(c.a)({},t.world,{bodies:s})}})}},{key:"updatePlanets",value:function(){for(var t=Object(d.a)(this.state.world.pendingBodies),e=0;e<t.length;e++){var a=t.splice(0,1)[0];a.em||(a.em={target:a.index,e:600,color1:W(a.data.hue,80),rate1:6,rate2:1.5,velocity:1.5,damp:.007,life:7,mass:5}),this.createPlanet(a.data,a.parent,a.index,a.em||null,a.status||null)}this.setState(function(e){return{world:Object(c.a)({},e.world,{pendingBodies:t})}})}},{key:"planetToggle",value:function(t){var e=Object(d.a)(this.state.world.bodies),a=e.slice(1),i=this.state.world.stage,r=Object(c.a)({},this.state.world.bDatabase),s=r[i],n=s.find(function(e){return e.data.name===t});if(!n.active&&e[n.parent]){s[n.index].active=!0;var o=Object(d.a)(this.state.world.pendingBodies);o.push(n),this.setState(function(t){return{world:Object(c.a)({},t.world,{pendingBodies:o,bDatabase:r})}})}else if(n.active){var l=!0,h=!1,u=void 0;try{for(var p,m=a[Symbol.iterator]();!(l=(p=m.next()).done);l=!0){var v=p.value;if(v&&v.parent===e[n.index]){var b=v.index;s[b].active=!1,e[b]=null}}}catch(y){h=!0,u=y}finally{try{l||null==m.return||m.return()}finally{if(h)throw u}}s[n.index].active=!1,e[n.index]=null,this.setState(function(t){return{world:Object(c.a)({},t.world,{bodies:e,bDatabase:r})}})}}},{key:"createStructure",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.world.structures.length,i=Object(d.a)(this.state.world.structures);i[a]=new dt(t),i[a].addSegments(e),i[a].index=a,this.setState(function(t){return{world:Object(c.a)({},t.world,{structures:i})}})}},{key:"updateStructures",value:function(){for(var t=Object(d.a)(this.state.world.pendingStructures),e=Object(d.a)(this.state.world.structures),a=0;a<t.length;a++){var i=t.pop();e[i.index]=new dt(i.data),e[i.index].addSegments(i.openings),e[i.index].index=i.index}this.setState(function(a){return{world:Object(c.a)({},a.world,{structures:e,pendingStructures:t})}})}},{key:"structureToggle",value:function(t){var e=Object(d.a)(this.state.world.structures),a=this.state.world.stage,i=Object(c.a)({},this.state.world.sDatabase),r=i[a],s=r.find(function(e){return e.data.name===t});if(s.active)s.active&&(r[s.index].active=!1,e[s.index]=null,this.setState(function(t){return{world:Object(c.a)({},t.world,{structures:e,sDatabase:i})}}));else{r[s.index].active=!0;var n=Object(d.a)(this.state.world.pendingStructures);n.push(s),this.setState(function(t){return{world:Object(c.a)({},t.world,{pendingStructures:n,sDatabase:i})}})}}},{key:"defineEB",value:function(){this.sharedEB.borderZoneBehaviour=new C.a.CrossZone(new C.a.RectZone(0,0,this.state.screen.width,this.state.screen.height),"bound"),this.sharedEB.randomBehaviour=new C.a.RandomDrift(5,5,.05);var t=this.state.world.bodies[0]?{x:this.state.world.bodies[0].x,y:this.state.world.bodies[0].y}:{x:350,y:350};return this.sharedEB.centerBehaviour=new C.a.Repulsion(t,30,this.state.world.bodies[0]?2*this.state.world.bodies[0].size:30),this.sharedEB}},{key:"createNewEmitter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,a=void 0===e?null:e,i=t.color1,r=void 0===i?null:i,s=t.color2,n=void 0===s?null:s,o=t.mass,l=void 0===o?5:o,h=t.radius,u=void 0===h?1:h,c=t.velocity,d=void 0===c?2.5:c,p=t.rate1,m=void 0===p?20:p,v=t.rate2,b=void 0===v?.5:v,y=t.damp,g=void 0===y?.005:y,f=t.e,w=void 0===f?"once":f,x=t.life,k=void 0===x?5:x,S=t.planetAttraction,E=void 0===S||S,O=t.x,M=void 0===O?350:O,j=t.y,P=void 0===j?350:j,A=t.a,B=void 0===A?0:A,I=t.b,F=void 0===I?360:I,D=arguments.length>1&&void 0!==arguments[1]&&arguments[1],z=new C.a.Emitter;z.e=w,z.damping=g,z.rate=new C.a.Rate(m,b),z.addInitialize(z.rate),z.addInitialize(new C.a.Mass(l)),z.addInitialize(new C.a.Radius(u)),k&&z.addInitialize(new C.a.Life(k)),z.currVelocity=new C.a.Velocity(1.5*d,new C.a.Span(B,F),"polar"),z.addInitialize(z.currVelocity);var L=r?new C.a.Color(r,n||r):new C.a.Color("random");return z.addBehaviour(L),this.sharedEB.borderZoneBehaviour&&z.addBehaviour(this.sharedEB.borderZoneBehaviour),this.sharedEB.randomBehaviour&&z.addBehaviour(this.sharedEB.randomBehaviour),this.sharedEB.centerBehaviour&&z.addBehaviour(this.sharedEB.centerBehaviour),"core"===D?(z.coreAttraction=new C.a.Attraction(this.state.world.bodies[0],10,500),z.addBehaviour(z.coreAttraction)):"psi"===D?(z.planetAttraction=new C.a.Attraction(this.state.world.bDatabase[this.state.world.stage][a].data,10,500),z.addBehaviour(z.planetAttraction)):E&&null!==a&&(z.planetAttraction=new C.a.Attraction(this.state.world.bDatabase[this.state.world.stage][a].data,10,500),z.addBehaviour(z.planetAttraction)),z.target=a||0,a&&(z.mouseAttract=new C.a.Attraction(this.state.mouseObj,5,200),z.addBehaviour(z.mouseAttract),z.p.x=M,z.p.y=P),a||(z.mouseAttract=new C.a.Attraction(this.state.mouseObj,5,200),z.addBehaviour(z.mouseAttract),z.p.x=M,z.p.y=P),z}},{key:"makePsiEmitter",value:function(){var t=this;this.setState(function(e){return{proton:Object(c.a)({},e.proton,{psiEmitter:t.createNewEmitter({e:"once",color1:"#6699FF",color2:"#FFDDFF",rate1:50,rate2:.01,velocity:1,mass:8,radius:1,damp:.009,life:5,special:"psi"})})}})}},{key:"addCoreEmitter",value:function(){var t=this;this.setState(function(e){return{proton:Object(c.a)({},e.proton,{coreEmitter:t.createNewEmitter({target:0,special:"core",e:2,color1:W(t.state.world.bodies[0].hue,40,-10,-10),rate1:6,rate2:.6,velocity:1.8,damp:.014,life:20,mass:15,radius:4,planetAttraction:!0,a:k.a.random(-330,-30)+30,b:k.a.random(30,330)-30})})}})}},{key:"emitterParticleCheck",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.proton.psiEmitter,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.world.bodies[0],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=t.particles.length,r=new C.a.Repulsion(this.state.world.bodies[0],60,15*this.state.world.bodies[0].size);if(i>a)for(var s=0;s<i/a-1;s++){var n=t.particles[i-(s*a+1)];!n.dead&&X(n.p,e)<5*e.size&&(n.addBehaviour(new C.a.Color("#59FF98","#49FF88")),n.mass*=2,n.energy*=2,n.addBehaviour(r),this.setState({resources:Object(c.a)({},this.state.resources,{matter:this.state.resources.matter+1})}))}}},{key:"thrustInput",value:function(){var t=0,e=0;return this.state.keys.up&&(e-=this.state.ball.thrustAcc*Math.pow(this.state.keys.up,.3)*1.5),this.state.keys.down&&(e+=this.state.ball.thrustAcc*Math.pow(this.state.keys.down,.3)*1.5),this.state.keys.left&&(t-=this.state.ball.thrustAcc*Math.pow(this.state.keys.left,.3)*1.5),this.state.keys.right&&(t+=this.state.ball.thrustAcc*Math.pow(this.state.keys.right,.3)*1.5),[t,e]}},{key:"borderCollision",value:function(t){this.state.params.bounceDampening;var e=this.state.screen.width,a=this.state.screen.height;return t.x+t.vx>e-t.size||t.x+t.vx<t.size?[-1,1]:t.y+t.vy>a-t.size||t.y+t.vy<t.size?[1,-1]:[1,1]}},{key:"ballGravPull",value:function(t,e){var a=0,i=0,r=!0,s=!1,n=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=o.value;if(h){var u=X(t,h);a+=h.mass*G(t,h).x/Math.pow(u*this.state.params.gravFalloff,2),i+=h.mass*G(t,h).y/Math.pow(u*this.state.params.gravFalloff,2)}}}catch(c){s=!0,n=c}finally{try{r||null==l.return||l.return()}finally{if(s)throw n}}return[-a,-i]}},{key:"structCollisionCheck",value:function(){var t=this.state.ball,e=(j()(t.x-this.props.width/2,t.y-this.props.height/2).horizontalAngle()+2*Math.PI)%(2*Math.PI),a=(Object(d.a)(this.state.world.structures),!0),i=!1,r=void 0;try{for(var s,n=this.state.world.structures[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;if(o&&X(t,o.origin)>o.radius-o.width/2-t.size&&X(t,o.origin)<o.radius+o.width/2+t.size){var l=o.arcLength,h=!0,u=!1,c=void 0;try{for(var p,m=o.segments[Symbol.iterator]();!(h=(p=m.next()).done);h=!0){var v=p.value,b=o.speed>0?(e-v.ac+3*Math.PI)%(2*Math.PI)-Math.PI:(-(e+v.bc)+3*Math.PI)%(2*Math.PI)-Math.PI;if(v.health>0&&(b>0&&b<l||b<0&&b>Math.PI-l))return v.health--,0===v.health&&(v.health=-6,console.log("segment disabled!")),this.structCollState(o.index)}}catch(y){u=!0,c=y}finally{try{h||null==m.return||m.return()}finally{if(u)throw c}}}}}catch(y){i=!0,r=y}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return this.structCollState(!1)}},{key:"structCollState",value:function(t){var e=.8*this.state.params.bounceDampening;return!1!==t?!1!==this.state.ball.coll?this.state.tick%3===0?(this.setState(function(t){return{ball:Object(c.a)({},t.ball,{ct:t.ball.ct+1})}}),[1*(1+this.state.ball.ct/10)*e,1*(1+this.state.ball.ct/10)*e]):[1,1]:(this.setState(function(e){return{ball:Object(c.a)({},e.ball,{coll:t,ct:1})}}),[-1*e,-1*e]):(!1!==this.state.ball.coll&&this.setState(function(t){return{ball:Object(c.a)({},t.ball,{coll:!1,ct:0})}}),[1,1])}},{key:"planetMotion",value:function(){var t=this,e=Object(d.a)(this.state.world.bodies);if(this.state.mousedown&&this.state.resources.energy>0&&this.state.mouseTick%2===0){var a=!0,i=!1,r=void 0;try{for(var s,n=e[Symbol.iterator]();!(a=(s=n.next()).done);a=!0)s.value}catch(v){i=!0,r=v}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}this.setState({resources:Object(c.a)({},this.state.resources,{energy:this.state.resources.energy-1})})}var o=!0,l=!1,h=void 0;try{for(var u,p=function(){var a=u.value;if(a){0!==a.speed&&"star"!==a.type&&a.movePlanet();var i=e.filter(function(t){return t!==a}),r=!0,s=!1,n=void 0;try{for(var o,l=i[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var h=o.value;h&&.95*X(a,h)<h.size+a.size&&t.planetCollision(a,h,2)}}catch(v){s=!0,n=v}finally{try{r||null==l.return||l.return()}finally{if(s)throw n}}}},m=e[Symbol.iterator]();!(o=(u=m.next()).done);o=!0)p()}catch(v){l=!0,h=v}finally{try{o||null==m.return||m.return()}finally{if(l)throw h}}}},{key:"planetCollision",value:function(t,e,a){if(1===a){var i=this.state.params.bounceDampening;return.95*X(t,e)<e.size+t.size?(this.setState(function(t){return{currentScore:t.currentScore+1,resources:Object(c.a)({},t.resources,{matter:t.resources.matter+1})}}),[-1*i,-1*i]):[1,1]}if(2===a&&.96*X(t,e)<e.size+t.size)return this.setState(function(a){var i=Object(d.a)(a.world.bodies),r=i[i.indexOf(e)],s=i[i.indexOf(t)];return s.speed&&(s.dx+=G(t,e).x*(s.coll*s.size/8)*(r.mass/s.mass),s.dy+=G(t,e).y*(s.coll*s.size/8)*(r.mass/s.mass),s.coll+=2),{resources:Object(c.a)({},a.resources,{matter:a.resources.matter+1}),bodies:i}})}},{key:"ballCheckPlanets",value:function(){var t=this.state.world.bodies,e=this.state.ball,a=0,i=0,r=!0,s=!1,n=void 0;try{for(var l,h=t[Symbol.iterator]();!(r=(l=h.next()).done);r=!0){var u=l.value;if(u){var c=this.planetCollision(e,u,1),d=Object(o.a)(c,2),p=d[0],m=d[1];1===p&&1===m||(a+=p,i+=m)}}}catch(v){s=!0,n=v}finally{try{r||null==h.return||h.return()}finally{if(s)throw n}}return a||i?[a,i]:[1,1]}},{key:"moveBall",value:function(){var t=this.state.ball,e=this.state.world.bodies,a=this.state.params.bounceDampening,i=this.ballGravPull(t,e),r=this.thrustInput(),s=r[0]||r[1]?Math.sqrt(Math.pow(Math.abs(r[0]),2)+Math.pow(Math.abs(r[1]),2)):0,n=this.state.ball.vx+i[0]+r[0],o=this.state.ball.vy+i[1]+r[1],l=this.borderCollision(t);if(1!==l[0]||1!==l[1]){var h=X(t,{x:n*=-1*a*.5,y:o*=-1*a*.5});return this.setState(function(t){return{ball:Object(c.a)({},t.ball,{x:k.a.clamp(t.ball.x,0,t.screen.width)+n,y:k.a.clamp(t.ball.y,0,t.screen.height)+o,vx:n,vy:o,speed:h,thrustLevel:s||(t.ball.thrustLevel?Math.floor(100*t.ball.thrustLevel)/101:0)})}})}var u=this.structCollisionCheck(),d=1===u[0]?0:u[0],p=1===u[1]?0:u[1],m=this.ballCheckPlanets(),v=1===m[0]?0:m[0],b=1===m[1]?0:m[1];d&&v?(n*=-u[0]*m[0],o*=-u[1]*m[1]):(n*=u[0]*m[0],o*=u[1]*m[1]);var y=X(t,{x:n,y:o});return this.setState(function(t){return{ball:Object(c.a)({},t.ball,{x:t.ball.x+n+t.ball.vx/4*d+t.ball.vx/4*v,y:t.ball.y+o+t.ball.vy/4*p+t.ball.vy/4*b,vx:n,vy:o,speed:y,thrustLevel:s||(t.ball.thrustLevel?Math.floor(100*t.ball.thrustLevel)/101:0)})}})}},{key:"economyUpdate",value:function(){var t=Object(c.a)({},this.state.resources);this.state.tick%20===0&&(t.matter+=t.mInc,t.energy+=t.eInc,t.psi+=t.psiInc,t.psiFlux+=t.psiChoir,this.setState({resources:t}))}},{key:"handlePauseStart",value:function(){!1===this.state.inGame?(this.continueGame(),console.log("continue")):!0===this.state.inGame&&(this.stopGame(),console.log("pause"))}},{key:"continueGame",value:function(){var t=this;requestAnimationFrame(function(e){t.update(e)}),this.setState(function(){return{inGame:!0}})}},{key:"stopGame",value:function(){clearInterval(this.timerID),cancelAnimationFrame(this.animationID),this.setState(function(){return{inGame:!1}})}},{key:"componentDidMount",value:function(){window.addEventListener("keyup",this.handleKeys.bind(this,!1)),window.addEventListener("keydown",this.handleKeys.bind(this,!0)),this.setState(function(){return{inGame:"loading"}}),this.defineEB(),this.createGalaxy(this.state.starList),this.loadStage("Sol"),this.makePsiEmitter()}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.animationID)}},{key:"update",value:function(){var t=Object(u.a)(h.a.mark(function t(e){var a,i,r,s,n,o,l,u=this;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!((a=e-this.state.ts)>1e3/60)){t.next=32;break}for(this.setState(function(t){return{ts:e-a%(1e3/60),tick:t.tick+1,mouseTick:t.mousedown?t.mouseTick+1:0,mouseReleased:!t.mousedown&&t.mouseTick>0}}),this.state.world.pendingBodies.length>0&&this.updatePlanets(),this.state.world.pendingStructures.length>0&&this.updateStructures(),this.planetMotion(),i=!0,r=!1,s=void 0,t.prev=11,n=this.state.world.structures[Symbol.iterator]();!(i=(o=n.next()).done);i=!0)(l=o.value)&&l.moveSegments();t.next=19;break;case 15:t.prev=15,t.t0=t.catch(11),r=!0,s=t.t0;case 19:t.prev=19,t.prev=20,i||null==n.return||n.return();case 22:if(t.prev=22,!r){t.next=25;break}throw s;case 25:return t.finish(22);case 26:return t.finish(19);case 27:this.moveBall(),this.state.tick%50===0&&this.state.proton.psiEmitter.particles.length>8&&this.emitterParticleCheck(this.state.proton.psiEmitter,this.state.world.bodies[0],4),this.psiBlast>0&&this.psiBlast--,(this.state.mousedown||this.state.beamPhase)&&this.beamBlastPower(),this.economyUpdate();case 32:if("loading"===this.state.inGame&&console.log("loading"),!0!==this.state.inGame){t.next=35;break}return t.abrupt("return",this.animationID=requestAnimationFrame(function(t){u.update(t)}));case 35:case"end":return t.stop()}},t,this,[[11,15,19,27],[20,,22,26]])}));return function(e){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e={tick:this.state.tick,ts:this.state.ts,inGame:this.state.inGame,currentScore:this.state.currentScore,stage:this.state.world.stage,ball:this.state.ball,resources:this.state.resources,mousedown:this.mousedown},a=this.state.world.stage,i=this.makeMapInterface(e),s=Object(c.a)({},this.state.world.bDatabase),n=s[a]&&s[a].length>0?s[a].slice(1).map(function(e){return r.a.createElement(K,{onClick:t.handlePlanetToggle,body:e,key:e.data.name})}):null,o=Object(c.a)({},this.state.world.sDatabase),l=o[a]?o[a].map(function(e){return r.a.createElement($,{onClick:t.handleStructureToggle,struct:e,key:e.data.name})}):null,h=this.state.selectedObj?r.a.createElement(V,{style:{color:"#05051A",backgroundColor:"#DACFDA",textAlign:"left",listStyle:"none",padding:"0.4em 0.6em",margin:"0.5em auto",minWidth:"30%",minHeight:"6em"},obj:this.state.selectedObj,fBuild:this.handlePlanetBuild}):r.a.createElement("span",{style:{minWidth:"30%",minHeight:"6em",margin:"0.5em auto"}},"Click on an in-system body for an info box"),u=this.makeControlButtons(),d=this.state.world.bodies[0]?r.a.createElement(pt,Object.assign({onMouseDown:this.mousedownHandler,onMouseUp:this.mouseupHandler,onMouseMove:this.mousemoveHandler,style:{background:"#36454F"},psiBlast:this.psiBlast},this.state)):null;return r.a.createElement("div",{className:"showcase"},d,r.a.createElement(U,{ui:e},r.a.createElement(w.a,{isOpen:this.state.showModal,contentLabel:"onRequestClose Example",onRequestClose:this.handleCloseModal,shouldCloseOnOverlayClick:!0,style:{content:{backgroundColor:"#30405E",maxWidth:"30%"}},ui:e},r.a.createElement("h2",{style:{fontColor:"#C0C0EE",margin:"0.5em",textAlign:"center"}},"Galaxy map"),r.a.createElement(Z,{ui:e},i),r.a.createElement("button",{style:{backgroundColor:"#30405E",padding:"0.2em",margin:"2em 0.5em 0.5em"},onClick:this.handleCloseModal},"Close")),r.a.createElement(Y,{ui:e}),r.a.createElement("p",null,"WASD to accelerate. Click, hold and release for a homing beam blast."),r.a.createElement(N,{ui:e},r.a.createElement(Z,{ui:e},u),r.a.createElement(Z,{ui:e},l),r.a.createElement(Z,{ui:e},n)),r.a.createElement("button",{onClick:this.handleOpenModal,style:{fontSize:"1.3em",alignSelf:"center",backgroundColor:"#30405E",padding:"0.5em",margin:"0.6em auto",borderRadius:"1px"}},"GALAXY MAP"),r.a.createElement("img",{src:A.a,alt:"",width:"32",height:"32"}),h))}}]),e}(i.Component),U=function(t){t.ui;var e=t.children;return r.a.createElement("div",{className:"game-interface"},e)},Y=function(t){var e=t.ui;return r.a.createElement("div",{className:"interface-element",style:{fontSize:"1.1em",margin:"0.2em auto 0.2em 2em",width:"100%",padding:"0.1em",transitionDuration:"0",display:"block"}},r.a.createElement("p",{style:{textAlign:"left"}},"Stage: ".concat(e.stage)),r.a.createElement("p",{style:{textAlign:"left"}},"Stable matter: ".concat(e.resources.matter," (+").concat(e.resources.mInc,") || Stable energy: ").concat(e.resources.energy," (+").concat(e.resources.eInc,") || Dark matter: 0 || Dark energy: 0")),r.a.createElement("p",{style:{textAlign:"left"}},"Concentration: ".concat(e.resources.psi," (+").concat(e.resources.psiInc,") || Flux: ").concat(e.resources.psiFlux," || Choir: ").concat(e.resources.psiChoir," || Communion: ").concat(e.currentScore)))},V=function(t){var e=t.style,a=t.obj,i=t.fBuild;return r.a.createElement("section",{style:e},r.a.createElement("ul",{style:{minWidth:"15em"}},r.a.createElement("li",null,"Name: ".concat(a.name)),r.a.createElement("li",null,"Mass: ".concat(a.mass)),r.a.createElement("li",null,"Coordinates: X ".concat(a.x.toFixed(0),"|| Y ").concat(a.y.toFixed(0))),r.a.createElement("li",null,"Type: ".concat(a.type)),r.a.createElement("li",null,"Shield power: ".concat(a&&a.status&&a.status.shield?a.status.shield:0)),r.a.createElement("li",null,"Psychic uplink: ".concat(a&&a.status&&a.status.uplink?a.status.uplink:0))),r.a.createElement("span",null,"Buildings:"),function(){var t=a.status.buildings.map(function(t){return r.a.createElement("li",null,"".concat(t.name,": lvl ").concat(t.lvl))});return r.a.createElement("ul",{style:{minWidth:"5em"}},t)}(),r.a.createElement("button",{style:{fontSize:"0.8em",padding:"0.1em",margin:"0.2em"},onClick:i.bind(void 0,0),id:"".concat(a.name)},"CHARGE SHIELD"),r.a.createElement("button",{style:{fontSize:"0.8em",padding:"0.1em",margin:"0.2em"},onClick:i.bind(void 0,1),id:"".concat(a.name)},"Power grid"),r.a.createElement("button",{style:{fontSize:"0.8em",padding:"0.1em",margin:"0.2em"},onClick:i.bind(void 0,2),id:"".concat(a.name)},"Ansible"),r.a.createElement("button",{style:{fontSize:"0.8em",padding:"0.1em",margin:"0.2em"},onClick:i.bind(void 0,3),id:"".concat(a.name)},"Choir relay"))},N=function(t){var e=t.children;return r.a.createElement("div",{className:"game-controls",style:{padding:"0.1em",margin:"0.1em"}},e)},Z=function(t){t.ui;var e=t.children;return r.a.createElement("div",{className:"interface-element"},e)},Q=function(t){var e=t.onClick,a=t.text,i=t.style,s=t.id;return r.a.createElement("button",{onClick:e,type:"button",style:i,id:s},a)},J=function(t){var e=t.onClick,a=t.star,i=t.ui;return r.a.createElement("button",{onClick:e,type:"button",style:i.stage===a?{backgroundColor:"#DD1133"}:{backgroundColor:"#4422EE"},id:a},"Load system: ",a)},K=function(t){var e=t.onClick,a=t.body;return r.a.createElement("button",{onClick:e,style:{backgroundColor:"".concat(W(a.data.hue,-20))},id:a.data.name},"Toggle planet: ",a.data.name)},$=function(t){var e=t.onClick,a=t.struct;return r.a.createElement("button",{onClick:e,style:{backgroundColor:"".concat(W(a.data.hue,-40))},id:a.data.name},"Toggle structure: ",a.data.name)},_={size:9,orbitX:200,orbitY:160,rot:200,speed:-1.5,mass:100,hue:"#ff4336",glow:.8,angle:0,name:"Mars"},tt={size:6,orbitX:35,orbitY:32,rot:100,speed:1.5,mass:50,hue:"#EE1111",glow:.6,angle:40,name:"Phobos"},et={size:12,orbitX:105,orbitY:90,rot:205,speed:1,mass:165,hue:"#00A86B",glow:.8,angle:10,name:"Venus"},at={size:11,orbitX:155,orbitY:140,rot:20,speed:1,mass:150,hue:"#007FFF",glow:1.2,angle:20,name:"Earth"},it={size:19,orbitX:0,speed:0,mass:220,hue:"#FFCC33",glow:2.5,angle:0,name:"Sol"},rt={size:14,orbitX:310,speed:.5,mass:190,hue:"#d9b47d",glow:1,angle:210,name:"Saturn"};function st(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"planet",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=E()(t,{state:i});if("star"===e)return{orbitX:0,speed:0,size:Math.floor((17*r.quick()+10)*a),mass:Math.floor((200*r.quick()+60)*a),hue:"#"+r.int32().toString(16).slice(-6),glow:1.5,name:t+" Primary",rngstate:i?r.state:null};var s=Math.floor(300*r.quick()*Math.pow(a,.5));return{orbitX:s,orbitY:s-Math.floor(3+15*r.quick()*Math.pow(a,2.5)),rot:Math.floor(330*r.quick()),angle:Math.floor(330*r.quick()),speed:+((1.5*r.quick()+.3)/a).toFixed(1),size:Math.floor((12*r.quick()+4)*Math.pow(a,1.25)),mass:Math.floor((150*r.quick()+40)*a),hue:W("#"+r.int32().toString(16).slice(-6),20),glow:Math.floor(20*r.quick())/20,name:t,rngstate:i?r.state:null}}var nt=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(p.a)(this,t),this.data=e,this.parent=a,this.xPar=this.parent?this.parent.x:e.xPar||350,this.yPar=this.parent?this.parent.y:e.yPar||350,this.size=e.size||15,this.orbitX=e.orbitX||0,this.orbitY=e.orbitY||this.orbitX,this.type=e.orbitX>0?"planet":"star",this.rot=e.rot||0,this.orbitX!==this.orbitY&&(this.e=Math.sqrt(1-Math.pow(this.orbitY,2)/Math.pow(this.orbitX,2)),this.pfdist=new j.a(this.orbitX*this.e,0),this.pfdist.rotateDeg(this.rot),this.pf={x:this.xPar+this.pfdist.x,y:this.yPar+this.pfdist.y},this.per=this.orbitX-this.orbitX*this.e,this.aph=this.orbitX+this.orbitX*this.e),this.speed=e.speed||0,this.speedWarp=0,this.mass=e.mass||0,this.hue=e.hue||"#FFFF00",this.glow=e.glow||0,this.name=e.name||"Unknown",this.angle=e.angle||0,this.dir=this.speed>0?1:-1,this.x=this.xPar+this.orbitX,this.y=this.yPar+this.orbitY,this.dx=0,this.dy=0,this.coll=0,this.pullTick=0,console.log("creating body: "+this.name),this.rngstate=e.rngstate||0}return Object(m.a)(t,[{key:"getsPulled",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=X(this,e),r=1+.05*a;this.speedWarp=200*t/this.mass/(Math.pow(.5*i,1.1)*r),i>this.size*r&&(this.pullTick=10*a,this.dx-=t*G(this,e).x/(Math.pow(.04*i,1.1)*r),this.dy-=t*G(this,e).y/(Math.pow(.04*i,1.1)*r))}},{key:"movePlanet",value:function(){if(this.angle+=this.orbitX===this.orbitY?Math.acos(1-Math.pow(this.speed/(1+this.speedWarp)/this.orbitX,2)/2)%Math.PI*2*this.dir:Math.acos(1-Math.pow(this.speed*(1+this.e*Math.cos(this.angle))/(1+this.speedWarp)/this.orbitX,2)/2)%Math.PI*2*this.dir,this.parent&&(this.xPar=this.parent.x,this.yPar=this.parent.y,this.orbitX!==this.orbitY&&(this.xPar-=this.pfdist.x,this.yPar-=this.pfdist.y)),this.orbitX===this.orbitY)this.x=this.xPar+this.orbitX*Math.cos(this.angle)+this.dx,this.y=this.yPar+this.orbitY*Math.sin(this.angle)+this.dy;else{var t=new j.a(this.orbitX*Math.cos(this.angle),this.orbitY*Math.sin(this.angle));t.rotateDeg(this.rot),this.x=this.xPar+t.x+this.dx,this.y=this.yPar+t.y+this.dy}this.dx&&(this.dx=Math.abs(this.dx)>1?.99*this.dx:0),this.dy&&(this.dy=Math.abs(this.dy)>1?.99*this.dy:0),this.speedWarp&&(this.speedWarp=this.speedWarp>.1?.8*this.speedWarp:0),this.coll&&this.coll--,this.pullTick&&this.pullTick--}}]),t}(),ot={numSeg:5,gap:.35,radius:190,speed:-1.4,origin:{x:350,y:350},width:16,hue:"#DF70FF",name:"S1"},lt={numSeg:12,gap:.4,radius:320,speed:.7,origin:{x:350,y:350},width:12,hue:"#FFD5D0",name:"S2"},ht={numSeg:2,gap:.2,radius:50,speed:.5,origin:{x:350,y:350},width:10,hue:"#86CFEF",name:"S3"},ut={numSeg:18,gap:.1,radius:250,speed:.4,origin:{x:350,y:350},width:12,hue:"#FF6655",name:"S4"};function ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=E()(t,{state:a});return{numSeg:1*Math.floor(1+12*i.quick()),arg:0,gap:Math.floor(50*i.quick())/100,speed:(1.5*i.quick()/e).toFixed(1)-1,width:Math.floor(1*(15*i.quick()+4)),radius:Math.floor(280*i.quick()+30),hue:W("#"+i.int32().toString(16).slice(-6),30),glow:Math.floor(20*i.quick())/15,name:t,rngstate:a?i.state:null,origin:{x:350,y:350}}}var dt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.numSeg,i=void 0===a?5:a,r=e.gap,s=void 0===r?.4:r,n=e.radius,o=void 0===n?240:n,l=e.speed,h=void 0===l?5:l,u=e.origin,c=void 0===u?{x:350,y:350}:u,d=e.width,m=void 0===d?10:d,v=e.hue,b=void 0===v?"#E0E0E0":v,y=(e.glow,e.name),g=void 0===y?"(Unknown)":y,f=e.arg,w=void 0===f?0:f;Object(p.a)(this,t),this.numSeg=i,this.arg=w,this.gap=s,this.radius=o,this.speed=h,this.dir=h<0?-1:1,this.origin=c,this.width=m,this.hue=b,this.glow=.5,this.regen=3,this.segments=[],this.vulnSeg=[],this.name=g,this.arcLength=2*Math.PI*(1-s)/i}return Object(m.a)(t,[{key:"addSegments",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=1===this.dir?this.arg:this.arg-2*Math.PI,a=(this.gap,this.numSeg),i=this.radius,r=this.origin,s=this.width,n=this.hue,o=this.glow,l=this.dir,h=this.arcLength,u=0;u<a;u++){var c={a:e,b:e+h,arcLength:h,randArc:k.a.random(.4*h,!0),r:i,ac:e%(2*Math.PI),bc:(e+h)%(2*Math.PI),dir:l,origin:r,width:s,hue:0===u?"#4DEEE4":n,glow:0===u?5*o:o,health:4,phase:0,index:u,x:null,y:null};this.segments.push(c),e+=2*Math.PI/a}for(var d=0;d<t;d++)this.destroyRandom()}},{key:"destroySegment",value:function(t){var e=this.segments.filter(function(e){return e!==t});this.segments=e}},{key:"destroyRandom",value:function(){var t=this.segments[k.a.random(this.segments.length)-1];this.destroySegment(t)}},{key:"moveSegments",value:function(){var t=Math.floor(Math.abs(1e4*Math.sin((this.segments[0].a+2*Math.PI)%(2*Math.PI)))),e=t%150,a=!0,i=!1,r=void 0;try{for(var s,n=this.segments[Symbol.iterator]();!(a=(s=n.next()).done);a=!0){var o=s.value;if(this.speed>0?(o.a+=2*Math.PI*.001*this.speed,o.ac=(Math.abs(o.a)+2*Math.PI)%(2*Math.PI),o.b+=2*Math.PI*.001*this.speed,o.bc=(Math.abs(o.b)+2*Math.PI)%(2*Math.PI)):this.speed<0&&(o.a+=2*Math.PI*.001*this.speed,o.b+=2*Math.PI*.001*this.speed,o.ac=Math.abs(o.a-2*Math.PI)%(2*Math.PI),o.bc=Math.abs(o.b-2*Math.PI)%(2*Math.PI)),o.glow=this.glow+t/300*this.glow,o.health<4&&e<this.regen){o.health+=o.health<0?.5:e<this.regen/2?1:0;var l=j()(o.r,0);o.dir>0?l.rotate(o.a+4*o.arcLength/5):l.rotate(o.b-4*o.arcLength/5),o.x=o.origin.x+.97*l.x,o.y=o.origin.y+.97*l.y}o.health<3&&!this.vulnSeg[o.index]?(this.vulnSeg[o.index]=o,o.hue="#EE444D"):o.health>3&&this.vulnSeg[o.index]===o&&(this.vulnSeg[o.index]=null,o.hue=this.hue)}}catch(h){i=!0,r=h}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}}}]),t}(),pt=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(v.a)(this,Object(b.a)(e).call(this,t))).state={zones:[]},a.saveContext=a.saveContext.bind(Object(g.a)(Object(g.a)(a))),a.saveOverlay=a.saveOverlay.bind(Object(g.a)(Object(g.a)(a))),a.tick=1,a.psiLevel=0,a.emitterList=[],a}return Object(y.a)(e,t),Object(m.a)(e,[{key:"saveContext",value:function(t){this.protonCanvas=t,this.ctx=t.getContext("2d"),this.width=this.ctx.canvas.width,this.height=this.ctx.canvas.height}},{key:"saveOverlay",value:function(t){this.protonCanvas2=t,this.ctx2=t.getContext("experimental-webgl")}},{key:"componentDidMount",value:function(){this.createProton()}},{key:"createProton",value:function(){var t=this;this.proton=new C.a,this.clickEmitter=this.createClickEmitter("#F8F8FF","#F8F8FF",this.props.ball),this.renderer=new C.a.CanvasRenderer(this.protonCanvas),this.renderer.onParticleUpdate=function(e){t.ctx.globalAlpha=.9,t.ctx.beginPath(),t.ctx.strokeStyle=e.color,t.ctx.lineWidth=2*e.energy+e.radius/4,t.ctx.moveTo(e.old.p.x-20*e.old.a.x,e.old.p.y-20*e.old.a.y),t.ctx.lineTo(e.p.x,e.p.y),t.ctx.closePath(),t.ctx.stroke(),t.ctx.globalAlpha=1},this.proton.addRenderer(this.renderer),this.proton2=new C.a,this.proton2.emitterList=[],this.proton2.blastEmitters=[];var e=new C.a.WebGLRenderer(this.protonCanvas2);e.blendFunc("SRC_ALPHA","ONE"),this.proton2.addRenderer(e)}},{key:"createClickEmitter",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new C.a.Emitter,r={x:this.props.world.bodies[0].x||this.width/2,y:this.props.world.bodies[0].y||this.height/2},s=new C.a.Repulsion(r,10,2*this.props.world.bodies[0].size||30),n=new C.a.CrossZone(new C.a.RectZone(0,0,this.protonCanvas.width,this.protonCanvas.height),"bound"),o=new C.a.RandomDrift(5,5,.05);return i.addBehaviour(o),i.addBehaviour(n),i.addBehaviour(s),i.target=a,i.damping=.012,i.addInitialize(new C.a.Rate(40,.025)),i.addInitialize(new C.a.Mass(8)),i.addInitialize(new C.a.Life(3)),i.addInitialize(new C.a.Radius(1)),i.currVelocity=new C.a.Velocity(2,new C.a.Span(0,360),"polar"),i.addInitialize(i.currVelocity),i.addBehaviour(new C.a.Color(t,e)),i.pointAttraction=new C.a.Attraction(a,20,600),i.addBehaviour(i.pointAttraction),i.p.x=this.props.mouseObj.x,i.p.y=this.props.mouseObj.y,this.proton.addEmitter(i),i}},{key:"componentDidUpdate",value:function(){var t=this.props.world.bodies;if(this.props.tick>this.tick){this.props.tick%10===0&&(this.updateWorld(),this.psiEmitter&&this.props.psiBlast&&(this.psiLevel++,this.psiEmitter.rate=this.psiLevel<9?new C.a.Rate(new C.a.Span(20+5*this.psiLevel,25+8*this.psiLevel),.25*this.psiLevel):new C.a.Rate(150,4),this.psiEmission())),this.proton2.update(),this.proton.update(),this.drawStructures();var e=!0,a=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value;n&&(n.status&&n.status.uplink&&this.drawConnect(n,this.props.ball),this.drawPlanet(n))}}catch(o){a=!0,i=o}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}if(this.drawBall(),this.drawScore(),this.props.beamPhase)switch(this.props.beamPhase){case 1:this.drawBeamPower(1);break;case 2:this.drawBeamPower(2);break;case 3:this.drawBeamPower(3)}this.mouseInput(),this.tick=this.props.tick}}},{key:"mouseInput",value:function(){var t=this.props.mouseTick;if(!0===this.props.mousedown){if(t%2===0&&t%20===0){var e=!0,a=!1,i=void 0;try{for(var r,s=this.emitterList[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value;n&&n.mouseAttract&&n.mouseAttract.reset(this.props.mouseObj,25,600)}}catch(p){a=!0,i=p}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}this.clickEmission()}}else if(!0===this.mouseReleased){var o=!0,l=!1,h=void 0;try{for(var u,c=this.emitterList[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;d&&d.mouseAttract&&d.mouseAttract.reset(this.props.mouseObj,5,300)}}catch(p){l=!0,h=p}finally{try{o||null==c.return||c.return()}finally{if(l)throw h}}}}},{key:"clickEmission",value:function(){this.clickEmitter.p.x=this.props.mouseObj.x,this.clickEmitter.p.y=this.props.mouseObj.y,this.clickEmitter.pointAttraction.reset(this.props.ball,20,600),this.clickEmitter.emit("once")}},{key:"psiEmission",value:function(){console.log("psi emit"),this.psiEmitter.p.x=this.props.ball.x,this.psiEmitter.p.y=this.props.ball.y;var t=j()(this.props.ball.x-this.protonCanvas.width/2,this.props.ball.y-this.protonCanvas.height/2).verticalAngleDeg();this.psiEmitter.currVelocity.reset(4,new C.a.Span((t+180)%360-15,(t+180)%360+15),"polar"),this.psiEmitter.emit("once")}},{key:"updateWorld",value:function(){this.props.mouseTick%5===0&&this.updateEmitters()}},{key:"updateEmitters",value:function(){var t=this.props.world.bodies,e=!0,a=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value;n&&!this.emitterList[n.index]&&n.emitter&&(this.emitterList[n.index]=n.emitter,this.proton.addEmitter(this.emitterList[n.index]),this.emitterList[n.index].emit(this.emitterList[n.index].e))}}catch(O){a=!0,i=O}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}var o=!0,l=!1,h=void 0;try{for(var u,c=this.emitterList[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;d&&d.target&&!t[d.target]?(this.proton.removeEmitter(d),this.emitterList[d.target]=null):d&&d.target&&t[d.target]&&(d.p.x=t[d.target].x,d.p.y=t[d.target].y,t[d.target].coll%6===2&&d.emit(d.e),d.mouseAttract&&d.mouseAttract.reset(this.props.mouseObj,5,300),d.planetAttraction&&d.planetAttraction.reset(t[d.target],d.planetAttraction.force/100,d.planetAttraction.radius))}}catch(O){l=!0,h=O}finally{try{o||null==c.return||c.return()}finally{if(l)throw h}}var p=!0,m=!1,v=void 0;try{for(var b,y=t.slice(1)[Symbol.iterator]();!(p=(b=y.next()).done);p=!0){var g=b.value;g&&!this.proton2.emitterList[g.index]?(this.proton2.emitterList[g.index]=this.createOverlayEmitter(0,g.size,1,.1,g,this.props.mouseObj),this.proton2.addEmitter(this.proton2.emitterList[g.index])):g&&this.proton2.emitterList[g.index].origin.parent!==g.parent&&(this.proton2.emitterList[g.index].destroy(),this.proton2.removeEmitter(this.proton2.emitterList[g.index]),this.proton2.emitterList[g.index]=this.createOverlayEmitter(0,g.size,1,.1,g,this.props.mouseObj),this.proton2.addEmitter(this.proton2.emitterList[g.index]))}}catch(O){m=!0,v=O}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}if(this.proton2.blastEmitters.length>0&&this.props.tick%60===0){var f=!0,w=!1,x=void 0;try{for(var k,S=this.proton2.blastEmitters[Symbol.iterator]();!(f=(k=S.next()).done);f=!0){var E=k.value;E.particles.length>0&&E.blastAttract.reset(E.target,35,600)}}catch(O){w=!0,x=O}finally{try{f||null==S.return||S.return()}finally{if(w)throw x}}}!this.psiEmitter&&this.props.proton.psiEmitter&&(this.psiEmitter=this.props.proton.psiEmitter,this.proton.addEmitter(this.psiEmitter)),!this.coreEmitter&&this.props.proton.coreEmitter&&(this.coreEmitter=this.props.proton.coreEmitter,this.proton.addEmitter(this.coreEmitter)),this.props.tick%500===0&&this.coreEmitter.emit(this.coreEmitter.e)}},{key:"drawConnect",value:function(t,e){this.ctx.beginPath(),this.ctx.globalAlpha=t.status.uplink?t.status.uplink/100:0,this.ctx.strokeStyle="#4397DC",this.ctx.lineWidth=1,this.ctx.setLineDash([40,15]),this.ctx.lineDashOffset=20,this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.closePath(),this.ctx.stroke(),this.ctx.shadowBlur=0,this.ctx.shadowColor=0,this.ctx.setLineDash([]),this.ctx.globalAlpha=1}},{key:"drawScore",value:function(){var t=this.props.currentScore;this.ctx.fillStyle="#F5F5F5",this.ctx.font="22px Arial",this.ctx.fillText("x"+t,10,25)}},{key:"drawBall",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5,e=this.props.ball,a=e.x,i=e.y,r=e.vx,s=e.vy,n=e.size,o=e.color,l=e.glow,h=Math.floor(10*e.thrustLevel),u=h?W(o,6*h,-10*h,-15*h):o;l&&(this.ctx.shadowBlur=h?10*l+Math.pow(90*h,.3):8*l,this.ctx.shadowColor=u),t&&(this.ctx.beginPath(),this.ctx.globalAlpha=.25,this.ctx.arc(a-r*t,i-s*t,n,0,2*Math.PI),this.ctx.fillStyle=u,this.ctx.fill(),this.ctx.closePath(),this.ctx.globalAlpha=1),this.ctx.beginPath(),this.ctx.arc(a,i,n,0,2*Math.PI),this.ctx.fillStyle=o,this.ctx.fill(),this.ctx.closePath(),this.ctx.shadowBlur=0,this.ctx.shadowColor=0}},{key:"drawPlanet",value:function(t){if(this.ctx.beginPath(),t.orbitX!==t.orbitY?this.ctx.ellipse(t.xPar,t.yPar,t.orbitX,t.orbitY,t.rot/360*(2*Math.PI),0,2*Math.PI,!0):this.ctx.arc(t.xPar,t.yPar,t.orbitX,0,2*Math.PI,!1),this.ctx.lineWidth=2,this.ctx.globalAlpha=.4,this.ctx.strokeStyle="#E0E0E0",this.ctx.closePath(),this.ctx.stroke(),this.ctx.beginPath(),t.glow&&(this.ctx.shadowBlur=10*t.glow,this.ctx.shadowColor=W(t.hue,20)),this.ctx.globalAlpha=1,this.ctx.arc(t.x,t.y,t.size,0,2*Math.PI),this.ctx.fillStyle=t.hue,this.ctx.fill(),this.ctx.closePath(),t.status&&t.status.shield){this.ctx.shadowBlur=t.status.shield/50,this.ctx.shadowColor="#2045FF",this.ctx.globalAlpha=.75;var e=this.ctx.createLinearGradient(t.x-t.size,t.y-t.size,t.x+t.size,t.y+t.size);e.addColorStop(0,"#FFFFFF"),e.addColorStop(t.status.shield/100,t.hue),e.addColorStop(1,t.hue),this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,2*Math.PI),this.ctx.fillStyle=e,this.ctx.fill(),this.ctx.closePath()}this.ctx.shadowBlur=0,this.ctx.shadowColor=0}},{key:"drawStructures",value:function(){var t=this.props.world.structures,e=(this.props.world.bodies,!0),a=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value;if(n){var o=!0,l=!1,h=void 0;try{for(var u,c=n.segments[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;d.health>0&&this.drawSegment(d)}}catch(p){l=!0,h=p}finally{try{o||null==c.return||c.return()}finally{if(l)throw h}}}}}catch(p){a=!0,i=p}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}}},{key:"drawSegment",value:function(t){this.ctx.beginPath(),t.glow&&(this.ctx.shadowBlur=1*t.glow,this.ctx.shadowColor=W(t.hue,20)),this.ctx.globalAlpha=.25*t.health,this.ctx.arc(t.origin.x,t.origin.y,t.r,t.a,t.b,!1),this.ctx.lineWidth=t.width,this.ctx.strokeStyle=t.hue,this.ctx.stroke(),this.ctx.closePath(),this.ctx.globalAlpha=1,this.ctx.shadowBlur=0,this.ctx.shadowColor=0}},{key:"drawBeamPower",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(1===t){this.props.world.bodies;this.startBeamCharge()}else if(2===t)this.feedBeamCharge();else if(3===t){var e=!0,a=!1,i=void 0;try{for(var r,s=this.proton2.emitterList[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value;n&&(n.mouseAttract.reset(this.props.mouseObj,20,600),n.p.x=n.origin.x,n.p.y=n.origin.y,n.stop())}}catch(o){a=!0,i=o}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}this.drawBeamBlast(this.props.mouseObj)}}},{key:"startBeamCharge",value:function(){var t=this.props.world.bodies.slice(1);if(this.proton2.blastEmitters.length>0){var e=!0,a=!1,i=void 0;try{for(var r,s=this.proton2.blastEmitters[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var n=r.value;n.destroy(),this.proton2.removeEmitter(n)}}catch(p){a=!0,i=p}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}this.proton2.blastEmitters=[]}var o=!0,l=!1,h=void 0;try{for(var u,c=t[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;d&&X(d,this.props.mouseObj)<300&&(this.proton2.emitterList[d.index].mouseAttract.reset(this.props.mouseObj,20,600),this.proton2.emitterList[d.index].p.x=d.x,this.proton2.emitterList[d.index].p.y=d.y,this.proton2.emitterList[d.index].emit())}}catch(p){l=!0,h=p}finally{try{o||null==c.return||c.return()}finally{if(l)throw h}}}},{key:"feedBeamCharge",value:function(){var t=!0,e=!1,a=void 0;try{for(var i,r=this.proton2.emitterList[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;s&&(s.mouseAttract.reset(this.props.mouseObj,20,600),s.p.x=s.origin.x,s.p.y=s.origin.y)}}catch(n){e=!0,a=n}finally{try{t||null==r.return||r.return()}finally{if(e)throw a}}}},{key:"drawBeamBlast",value:function(t){var e=this.props.world.structures;if(this.proton2.blastEmitters.length<3){var a=0,i=!0,r=!1,s=void 0;try{for(var n,o=e[Symbol.iterator]();!(i=(n=o.next()).done);i=!0){var l=n.value;if(l){var h=!0,u=!1,c=void 0;try{for(var d,p=l.vulnSeg[Symbol.iterator]();!(h=(d=p.next()).done);h=!0){var m=d.value;if(m&&m.health>0&&(a++,this.proton2.blastEmitters.length<a)){this.proton2.blastEmitters[a-1]=this.createBlastEmitter(0,40,.2,1,t,m,50/this.props.beamBlast);var v=this.proton2.blastEmitters[a-1];this.proton2.addEmitter(v),v.emit(Math.abs(this.props.beamBlast/10))}}}catch(b){u=!0,c=b}finally{try{h||null==p.return||p.return()}finally{if(u)throw c}}}}}catch(b){r=!0,s=b}finally{try{i||null==o.return||o.return()}finally{if(r)throw s}}}}},{key:"createOverlayEmitter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:350,y:350},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,n=new C.a.Emitter;return n.rate=new C.a.Rate(4,.03),n.origin=r,n.target=s,n.addInitialize(new C.a.Mass(4)),n.addInitialize(new C.a.Life(1,2)),n.addInitialize(new C.a.Body([A.a],32)),n.addInitialize(new C.a.Radius(e)),n.addInitialize(new C.a.V(.5,t,"polar")),n.addBehaviour(new C.a.Alpha(.5,.75)),n.addBehaviour(new C.a.Color("#0029FF","#AA9AFF")),n.addBehaviour(new C.a.Scale(a,i)),n.addBehaviour(new C.a.CrossZone(new C.a.RectZone(0,0,700,700),"dead")),n.mouseAttract=new C.a.Attraction(s,15,600),n.addBehaviour(n.mouseAttract),r?(n.p.x=r.x,n.p.y=r.y):(n.p.x=350,n.p.y=350),n}},{key:"createBlastEmitter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:350,y:350},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.02,o=new C.a.Emitter;return o.rate=new C.a.Rate(5,new C.a.Span(.01,n)),o.target=s,o.addInitialize(new C.a.Mass(6)),o.addInitialize(new C.a.Life(1,2)),o.addInitialize(new C.a.Body([A.a],32)),o.addInitialize(new C.a.Radius(e)),o.addInitialize(new C.a.V(.5,t,"polar")),o.addBehaviour(new C.a.Alpha(.5,.75)),o.addBehaviour(new C.a.Color("#8F1580","#FEAEFF")),o.addBehaviour(new C.a.Scale(a,i)),o.addBehaviour(new C.a.CrossZone(new C.a.RectZone(0,0,700,700),"bounce")),o.blastAttract=new C.a.Attraction(s,35,600),o.addBehaviour(o.blastAttract),r?(o.p.x=r.x,o.p.y=r.y):(o.p.x=350,o.p.y=350),console.log(o),o}},{key:"render",value:function(){return r.a.createElement(mt,{width:this.props.screen.width,height:this.props.screen.height,contextRef:this.saveContext,contextRef2:this.saveOverlay,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,style:this.props.style})}}]),e}(r.a.Component),mt=function(t){function e(){return Object(p.a)(this,e),Object(v.a)(this,Object(b.a)(e).apply(this,arguments))}return Object(y.a)(e,t),Object(m.a)(e,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var t=this;return r.a.createElement("div",null,r.a.createElement("canvas",{id:"canvas-overlay",width:this.props.width,height:this.props.height,ref:function(e){return e?t.props.contextRef2(e):null},onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove}),r.a.createElement("canvas",{id:"myCanvas",width:this.props.width,height:this.props.height,ref:function(e){return e?t.props.contextRef(e):null},onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,style:this.props.style}))}}]),e}(r.a.Component),vt=function(t){function e(t){var a;return Object(p.a)(this,e),(a=Object(v.a)(this,Object(b.a)(e).call(this,t))).state={hasError:!1},a}return Object(y.a)(e,t),Object(m.a)(e,[{key:"componentDidCatch",value:function(t,e){console.log(t,e),this.setState({error:t,info:e})}},{key:"render",value:function(){return this.state.hasError?r.a.createElement("div",null,r.a.createElement("h1",null,"Something went wrong."),r.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),r.a.createElement("br",null),this.state.info.componentStack)):this.props.children}}],[{key:"getDerivedStateFromError",value:function(t){return{hasError:!0}}}]),e}(i.Component),bt=function(t){function e(){return Object(p.a)(this,e),Object(v.a)(this,Object(b.a)(e).apply(this,arguments))}return Object(y.a)(e,t),Object(m.a)(e,[{key:"render",value:function(){return r.a.createElement(vt,null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"header"},r.a.createElement("h1",{className:"header-name"},"Orbit game title")),r.a.createElement(H,{width:"700",height:"700"}),r.a.createElement("div",{className:"extra"},r.a.createElement("span",null,"v0.1.0 prototype||"),r.a.createElement("a",{href:"https://www.paypal.me/EstherFiddler"},"Donate"))))}}]),e}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(r.a.createElement(bt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[28,1,2]]]);
//# sourceMappingURL=main.072825b7.chunk.js.map